{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/LevelWin.vue?0908","webpack:///./src/components/MapEditor.vue?b943","webpack:///./src/components/Score.vue?554c","webpack:///./src/services/webrtcService.js","webpack:///./src/components/InteractionOverlay.vue?449a","webpack:///./src/components/Controls.vue?0585","webpack:///./src/App.vue?8cc8","webpack:///./src/components/Controls.vue?331b","webpack:///./src/components/Score.vue?da5d","webpack:///./src/components/Score.vue?523a","webpack:///src/components/Controls.vue","webpack:///./src/components/Controls.vue?2fdb","webpack:///./src/components/Controls.vue?8f75","webpack:///./src/components/LevelSelect.vue?4196","webpack:///src/components/LevelSelect.vue","webpack:///./src/components/LevelSelect.vue?a125","webpack:///./src/components/LevelSelect.vue?c0f0","webpack:///./src/components/LevelWin.vue?cc00","webpack:///src/components/LevelWin.vue","webpack:///./src/components/LevelWin.vue?8f71","webpack:///./src/components/LevelWin.vue?ab40","webpack:///./src/components/GameThree.vue?2bb6","webpack:///src/components/GameThree.vue","webpack:///./src/components/GameThree.vue?8267","webpack:///./src/components/GameThree.vue?e1f9","webpack:///./src/components/CharacterSelect.vue?37b6","webpack:///src/components/CharacterSelect.vue","webpack:///./src/components/CharacterSelect.vue?4cca","webpack:///./src/components/CharacterSelect.vue?886e","webpack:///./src/components/MapEditor.vue?c5f0","webpack:///src/components/MapEditor.vue","webpack:///./src/components/MapEditor.vue?d38f","webpack:///./src/components/MapEditor.vue?82d0","webpack:///./src/components/Lobby.vue?36c3","webpack:///src/components/Lobby.vue","webpack:///./src/components/Lobby.vue?04f4","webpack:///./src/components/Lobby.vue?ace9","webpack:///./src/components/InteractionOverlay.vue?7117","webpack:///src/components/InteractionOverlay.vue","webpack:///./src/components/InteractionOverlay.vue?75e8","webpack:///./src/components/InteractionOverlay.vue?c005","webpack:///./src/components/DirectionsHelper.vue?ea0f","webpack:///src/components/DirectionsHelper.vue","webpack:///./src/components/DirectionsHelper.vue?cfcf","webpack:///./src/components/DirectionsHelper.vue?b875","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue?bff9","webpack:///./src/store.js","webpack:///./src/main.js","webpack:///./src/App.vue?506e","webpack:///./src/services/firebase.js","webpack:///./src/services/roomService.js","webpack:///./src/components/GameThree.vue?c648","webpack:///./src/components/LevelSelect.vue?752f","webpack:///./src/components/Lobby.vue?3c0c","webpack:///./src/components/CharacterSelect.vue?175c","webpack:///./src/components/DirectionsHelper.vue?3b20"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","app","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_LevelWin_vue_vue_type_style_index_0_id_f31832a2_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_LevelWin_vue_vue_type_style_index_0_id_f31832a2_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_MapEditor_vue_vue_type_style_index_0_id_e2a5972c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_MapEditor_vue_vue_type_style_index_0_id_e2a5972c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Score_vue_vue_type_style_index_0_id_9b1f1d38_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Score_vue_vue_type_style_index_0_id_9b1f1d38_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","WebRTCService","C_Users_marka_Documents_Tomachi_Programming_projects_halloween_game_master_node_modules_babel_runtime_helpers_builtin_es6_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","this","peer","connected","dataChannel","onMessageCallback","onConnectedCallback","onDisconnectedCallback","instanceId","Math","random","toString","substr","isInitiator","_reconnecting","_reconnectAttempts","_maxReconnectAttempts","_reconnectTimer","console","log","_outQueue","_flushTimer","_flushIntervalMs","_maxBuffered","_latestGameState","_chunkBuffers","_maxFrameSize","SimplePeer","initiator","trickle","channelName","config","iceServers","urls","iceTransportPolicy","iceCandidatePoolSize","bundlePolicy","rtcpMuxPolicy","offerOptions","offerToReceiveAudio","offerToReceiveVideo","setupPeerEvents","answerOptions","_this","on","signal","onSignalCallback","setTimeout","_channel","bufferedAmountLowThreshold","onbufferedamountlow","_flushQueue","e","startKeepAlive","error","_startFlusher","touchKeepAlive","raw","message","JSON","parse","type","send","stringify","id","idx","total","payload","parts","buf","filter","fullStr","join","fullMsg","warn","code","scheduleReconnect","stopKeepAlive","_stopFlusher","signalData","gameState","_enqueue","action","callback","destroy","clearTimeout","_this2","_keepAliveTimer","_lastPongAt","Date","now","setInterval","destroyed","clearInterval","_this3","delayMs","min","pow","reconnect","initAsInitiator","initAsReceiver","obj","hasMarker","some","_this4","ch","readyState","bufferedAmount","findIndex","gs","msg","_sendJson","sent","maxPerTick","next","jsonStr","ceil","unshift","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_InteractionOverlay_vue_vue_type_style_index_0_id_98180e24_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_InteractionOverlay_vue_vue_type_style_index_0_id_98180e24_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Controls_vue_vue_type_style_index_0_id_4cb7a02e_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Controls_vue_vue_type_style_index_0_id_4cb7a02e_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","Appvue_type_template_id_00c69100_render","_vm","_h","$createElement","_c","_self","attrs","_e","staticClass","click","$event","stopPropagation","toggleQRCode","src","baseUrl","alt","_v","staticRenderFns","Controlsvue_type_template_id_4cb7a02e_scoped_true_render","class","playerRole","preventDefault","openMenu","touchstart","viewBox","isMultiplayer","isPlayer","canTrickOrTreat","$store","dispatch","mousedown","_l","$options","item","direction","image","Controlsvue_type_template_id_4cb7a02e_scoped_true_staticRenderFns","Scorevue_type_template_id_9b1f1d38_scoped_true_render","staticStyle","fill","_s","getters","score","Scorevue_type_template_id_9b1f1d38_scoped_true_staticRenderFns","script","component","componentNormalizer","options","__file","Score","keyMap","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","w","a","W","S","A","D","8","2","5","4","6"," ","Controlsvue_type_script_lang_js_","components","methods","event","handleKeydown","computed","objectSpread","vuex_esm","buttons","mounted","document","body","addEventListener","removeEventListener","components_Controlsvue_type_script_lang_js_","Controls_component","Controls","LevelSelectvue_type_template_id_759747e6_scoped_true_render","closeMenu","_m","quitGame","LevelSelectvue_type_template_id_759747e6_scoped_true_staticRenderFns","LevelSelectvue_type_script_lang_js_","modePrevious","components_LevelSelectvue_type_script_lang_js_","LevelSelect_component","LevelSelect","LevelWinvue_type_template_id_f31832a2_scoped_true_render","winTitle","roleMessage","bothPlayersReady","currentLevel","isReady","markReady","LevelWinvue_type_template_id_f31832a2_scoped_true_staticRenderFns","LevelWinvue_type_script_lang_js_","roomData","player1Ready","player2Ready","_markReady","asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","stop","arguments","watch","newVal","components_LevelWinvue_type_script_lang_js_","LevelWin_component","LevelWin","GameThreevue_type_template_id_7999eab7_render","play-mode","character","moves","facing","map","GameThreevue_type_template_id_7999eab7_staticRenderFns","THREE","three_module","gltfLoader","GameThreevue_type_script_lang_js_prepGLTFPlayer","gltf","lastTime","animationNameMap","animations","forEach","animation","update","time","dt","mixer","playAnimationByName","lastAnimation","scene","clip","clipAction","play","gltfAssetMap","unpackedObjectMap","loadGltfAssets","_ref","assetList","promiseList","asset","_resolve","_reject","promise","Promise","resolve","reject","load","concat","children","undefined","all","abrupt","_x","renderer","alpha","antialias","camera","innerWidth","innerHeight","group","add","GameThreevue_type_script_lang_js_directionalLight","position","set","castShadow","GameThreevue_type_script_lang_js_directionalLight2","GameThreevue_type_script_lang_js_ambientLight","GameThreevue_type_script_lang_js_light","fog","deg45","PI","directionMap","X","Z","Q","E","C","┃","━","┓","┛","┗","┏",",","┻","┣","┳","┫","╋","╻","╹","╺","╸","P","up","down","left","right","charModelMap","G","H","GameThreevue_type_script_lang_js_houses","getHouseRandom","index","floor","levelHolder","rotation","x","lastLevel","itemLevelMap","player","playerTweenQueue","rotationTween","facingArrow","playerTweenOnComplete","nextTween","start","GameThreevue_type_script_lang_js_createFacingArrow","remove","arrowGeometry","arrowMaterial","color","transparent","opacity","depthTest","depthWrite","scale","setScalar","renderOrder","y","z","updateFacingArrow","GameThreevue_type_script_lang_js_animatePlayerRotation","targetRotation","currentRotation","twoPi","normalizedCurrent","normalizedTarget","diff","shortestTarget","Tween_default","Tween","to","easing","Easing","Quadratic","Out","characterMountA","characterMountB","width","height","GameThreevue_type_script_lang_js_changeSceneMode","isGuide","controls","ghost_root","alien_root","lookAt","visible","changeCharacter","minPolarAngle","maxPolarAngle","minAzimuthAngle","Infinity","maxAzimuthAngle","minDistance","maxDistance","enableRotate","enableZoom","enablePan","MOUSE","LEFT","MIDDLE","RIGHT","mouseButtons","ORBIT","PAN","ZOOM","playerAvatar","GameThreevue_type_script_lang_js_mapAsciiStateToThree","_ref2","mapRaw","candyHouseIndex","lastItemHolder","itemHolder","xMax","indexOf","yMax","match","xOffset","yOffset","_chars","toConsumableArray","tileIndex","char","stringIndex","charUpper","toLocaleUpperCase","modelName","clone","candy","candy_circle","_item","chars","gStringIndex","tileOffset","tween","onUpdate","onComplete","charAt","shouldHaveCandy","hasCandy","show","shadowMap","enabled","center","deg","resize","clientWidth","domElement","clientHeight","dpr","devicePixelRatio","aspect","desiredMinimumFov","fov","atan","tan","updateProjectionMatrix","setPixelRatio","setSize","go","loop","requestAnimationFrame","GameThreevue_type_script_lang_js_animate","GameThreevue_type_script_lang_js_start","parentNode","appendChild","enableDamping","dampingFactor","screenSpacePanning","render","GameThreevue_type_script_lang_js_","loaded","lastMap","displayCharacter","activePlayerCharacter","$el","startLoad","beforeUpdate","updateState","_startLoad","_callee2","_context2","levels","$nextTick","components_GameThreevue_type_script_lang_js_","GameThree_component","GameThree","CharacterSelectvue_type_template_id_cf5bdaa4_scoped_true_render","CharacterSelectvue_type_template_id_cf5bdaa4_scoped_true_staticRenderFns","CharacterSelectvue_type_script_lang_js_","characters","components_CharacterSelectvue_type_script_lang_js_","CharacterSelect_component","CharacterSelect","MapEditorvue_type_template_id_e2a5972c_scoped_true_render","clearMap","showLoadDialog","testMap","saveMap","mapWidth","mapHeight","resizeMap","getSelectedTileName","directives","rawName","expression","domProps","checked","Array","isArray","showDirectionIndicators","_i","change","$$a","$$el","target","$$c","$$v","$$i","render3DMap","_q","editMode","autoGeneratePaths","placeholder","rows","input","composing","loadMapInput","loadMap","loadError","collapsed","tile","selected","selectedTile","title","pointType","finishPath","clearDraft","ref","MapEditorvue_type_template_id_e2a5972c_scoped_true_staticRenderFns","MapEditorvue_type_script_lang_js_deg45","MapEditorvue_type_script_lang_js_directionMap","!","MapEditorvue_type_script_lang_js_charModelMap","MapEditorvue_type_script_lang_js_","mapData","isDragging","mouseDownPos","mouseMoved","isDraggingPath","dragStartNode","mapGroup","tileObjects","raycaster","mouse","animationId","nodes","edges","overlayGroup","pathDraftNode","specialTiles","roadTiles","houseTiles","sceneryTiles","_mounted","initializeMap","loadAssets","init3D","beforeDestroy","cancelAnimationFrame","dispose","onMapMouseDown","onMapMouseUp","onMapMouseMove","_loadAssets","$refs","map3dContainer","updateCameraPosition","directionalLight","directionalLight2","ambientLight","light","animate","maxDimension","max","distance","centerIndex","deltaWidth","deltaHeight","newWidth","newHeight","newData","oldIndex","newIndex","child","houses","getHouseForPosition","seed","userData","addCompassLabels","renderOverlay","createLabel","text","canvas","createElement","context","getContext","fillStyle","font","textAlign","textBaseline","fillText","texture","material","sprite","north","south","east","west","clientX","clientY","hit","screenToTile","node","find","nodeGeom","nodeMat","edgeMat","from","points","geom","setFromPoints","line","dx","dy","sqrt","_this5","endNode","edgeExists","placeTileAtClick","placeNodeAtClick","deleteAtClick","rect","getBoundingClientRect","top","setFromCamera","intersects","intersectObjects","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","iterator","done","intersect","parent","err","return","$set","nodeIndex","edge","len","projX","projY","dist","_this6","confirm","roadChars","houseFacingMap","isRoad","includes","getTile","getAccessibleHouse","fromDirection","checks","houseDir","_arr","entries","_arr$_i","slicedToArray","checkDir","offset","hx","hy","houseTile","accessDirs","hasHouse","countRoadNeighbors","count","isCorner","horizontal","vertical","isJunctionTile","neighbors","nodeMap","isSpawn","isJunction","houseInfo","nodeType","visited","Set","traceToNextNode","startX","startY","dirX","dirY","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_node","directions","_i2","dir","nextX","nextY","edgeKey","has","junctionCount","houseCount","bothCount","alert","_this7","allTiles","trim","metaSplit","split","mapPart","metaPart","lines","parsed","mapString","convertMapToString","meta","blob","Blob","url","URL","createObjectURL","href","download","revokeObjectURL","components_MapEditorvue_type_script_lang_js_","MapEditor_component","MapEditor","Lobbyvue_type_template_id_538904ea_scoped_true_render","state","showCreateRoom","showJoinRoom","createRoom","backToMenu","maxlength","roomCodeInput","validateRoomCode","disabled","joinRoom","currentRoomCode","players","player1","player2","startGame","leaveRoom","Lobbyvue_type_template_id_538904ea_scoped_true_staticRenderFns","Lobbyvue_type_script_lang_js_","isHost","currentRoomData","webrtcConnected","webrtcInitialized","otherPlayerWasConnected","webrtcConnectedAt","canStartGame","hasPlayer1","hasPlayer2","replace","_createRoom","playerName","roomCode","playerId","roomService","onRoomUpdate","handleRoomUpdate","t0","_joinRoom","_handleRoomUpdate","_callee3","gracePeriodMs","timeSinceConnect","otherPlayerId","otherPlayerConnected","_otherPlayerId","_context3","webrtcService","disconnect","deleteRoom","role","status","initWebRTC","_initWebRTC","_callee6","store","candidateBuffer","candidateTimer","_candidateBuffer","_candidateTimer","_context7","onSignal","_ref3","_callee5","sendWithRetry","_context6","_ref4","_callee4","fn","retries","_loop","_ret","_args5","_context5","_context4","v","delegateYield","es6_typeof","_x4","setRTCOffer","setRTCAnswer","addICECandidate","_x3","roomRef","snapshot","answer","val","candidate","offer","onConnected","myPlayerId","myPlayerData","player1Data","player2Data","commit","multiplayer","default","level","sendGameState","onMessage","onDisconnected","_x2","_startGame","_callee7","_context8","assignRolesAndCharacters","_leaveRoom","_callee8","_context9","handleDisconnection","_handleDisconnection","_callee9","_context10","components_Lobbyvue_type_script_lang_js_","Lobby_component","Lobby","InteractionOverlayvue_type_template_id_98180e24_scoped_true_render","overlayMessage","InteractionOverlayvue_type_template_id_98180e24_scoped_true_staticRenderFns","InteractionOverlayvue_type_script_lang_js_","overlayActive","loadAnimation","cleanup","animationContainer","animationPath","overlayType","lottie_default","container","autoplay","path","components_InteractionOverlayvue_type_script_lang_js_","InteractionOverlay_component","InteractionOverlay","DirectionsHelpervue_type_template_id_06aac514_scoped_true_render","DirectionsHelpervue_type_template_id_06aac514_scoped_true_staticRenderFns","DirectionsHelpervue_type_script_lang_js_","components_DirectionsHelpervue_type_script_lang_js_","DirectionsHelper_component","DirectionsHelper","Appvue_type_script_lang_js_","showQR","startPeriodicCleanup","showQRButton","src_Appvue_type_script_lang_js_","App_component","App","Vue","use","Vuex","spliceSlice","str","uppercaseHousesRegex","FACING","UP","DOWN","turnLeft","currentFacing","_turnMap","turnMap","turnRight","_turnMap2","DIR_VECS","getForwardNeighborIdx","fromIdx","dirVec","cur","pathNodes","pathAdjacency","nextIdx","bestDist","nIdx","sign","abs","hasPerpendicularBranch","atIdx","hasBranch","isBack","toIndex","rowStride","fromIndex","getNextPosition","newX","newY","canMoveInDirection","nextIndex","charAtNext","currentDirection","perpendicular","perpendicularDirs","canCollectFromHouse","houseChar","playerDirection","houseFacings","getAdjacentInteractableHouse","playerFacing","dirs","opposite","nx","ny","nIndex","nChar","houseToPlayer","okByHouseFacing","okByPlayerFacing","houseIndex","changeStateByDirection","mapLast","gIndexLast","_fromIndex","xLast","yLast","gIndex","charAtNewIndex","lastCharAtSpace","canCollect","toLocaleLowerCase","totalWinCount","src_store","Store","lastDirection","levelMeta","pathEdges","currentNodeIdx","lastInteractedHouseIndex","otherPlayerName","otherPlayerRole","_fromIndex2","house","mutations","setLevels","startLevel","levelIndex","providedCandyIndex","keepScore","randomHouseNum","_fromIndex3","coordToIndex","adj","addEdge","b","_fromIndex4","nodeIdx","Number","isInteger","selectCharacter","setMultiplayerInfo","setPlayerRole","setWebRTCConnected","setOtherPlayerConnected","updateMultiplayerRoom","syncGameState","resetMultiplayer","setOverlay","active","move","newMap","newState","require","updateData","turnLeftMutation","turnRightMutation","moveForward","curIdx","movedAny","forwardIdx","nextNode","currentX","currentY","newGIndex","_fromIndex5","shortForward","candyIdx","scanIdx","targetIdx","firstHouseIdx","_neighbors$_i","stepIdx","hasAdjacentHouse","leftOrRight","_i3","_fromIndex6","actions","loadLevels","_loadLevels","levelText","levelSplit","fetch","block","startsWith","metaContent","setMultiplayerMode","_ref5","_ref6","nextLevel","_ref7","_ref8","win","earlyExit","turnLeftAction","_ref9","turnRightAction","_ref10","forward","_ref11","shortForwardAction","_ref12","testCustomMap","_ref13","customLevelIndex","_ref14","_ref15","_ref16","_ref17","otherPlayer","isDisconnected","then","handleMultiplayerMessage","_ref18","success","_ref19","switchRolesAndContinue","_switchRolesAndContinue","_ref20","currentRole","newRole","currentChar","newActiveChar","scoreBeforeStart","_webrtcService3","trickOrTreat","_ref21","interactWithHouse","_interactWithHouse","_ref22","_fromIndex7","_fromIndex8","houseX","houseY","_fromIndex9","candyX","candyY","isCorrectHouse","_webrtcService4","toLowerCase","VueAnalytics","process","VUE_APP_GA","autoTracking","exception","debug","sendHitTask","productionTip","h","$mount","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","firebase","apps","initializeApp","database","RoomService","classCallCheck","ROOM_MAX_AGE_MS","once","exists","roomAge","createdAt","hasConnectedPlayer","attempts","maxAttempts","candidateCode","generateRoomCode","isRoomCodeTaken","isTaken","Error","rtcOffer","rtcAnswer","currentRound","infoConnectedRef","myConnectedRef","onDisconnectRef","onDisconnect","snap","gameStatus","candidatesRef","updates","roles","updateGameState","player1Role","player2Role","off","player2Connected","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_GameThree_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_GameThree_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_LevelSelect_vue_vue_type_style_index_0_id_759747e6_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_LevelSelect_vue_vue_type_style_index_0_id_759747e6_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Lobby_vue_vue_type_style_index_0_id_538904ea_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Lobby_vue_vue_type_style_index_0_id_538904ea_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_CharacterSelect_vue_vue_type_style_index_0_id_cf5bdaa4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_CharacterSelect_vue_vue_type_style_index_0_id_cf5bdaa4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_DirectionsHelper_vue_vue_type_style_index_0_id_06aac514_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_DirectionsHelper_vue_vue_type_style_index_0_id_06aac514_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/app.1e8e0463.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/trickortreat/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LevelWin.vue?vue&type=style&index=0&id=f31832a2&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LevelWin.vue?vue&type=style&index=0&id=f31832a2&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapEditor.vue?vue&type=style&index=0&id=e2a5972c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapEditor.vue?vue&type=style&index=0&id=e2a5972c&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Score.vue?vue&type=style&index=0&id=9b1f1d38&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Score.vue?vue&type=style&index=0&id=9b1f1d38&lang=scss&scoped=true&\"","import SimplePeer from 'simple-peer/simplepeer.min.js'\r\n\r\nclass WebRTCService {\r\n  constructor() {\r\n    this.peer = null\r\n    this.connected = false\r\n    this.dataChannel = null\r\n    this.onMessageCallback = null\r\n    this.onConnectedCallback = null\r\n    this.onDisconnectedCallback = null\r\n    this.instanceId = Math.random().toString(36).substr(2, 9)\r\n    this.isInitiator = null\r\n    this._reconnecting = false\r\n    this._reconnectAttempts = 0\r\n    this._maxReconnectAttempts = 5\r\n    this._reconnectTimer = null\r\n    console.log('🔧 WebRTCService instance created:', this.instanceId)\r\n    // Backpressure-aware send queue and chunking\r\n    this._outQueue = []\r\n    this._flushTimer = null\r\n    this._flushIntervalMs = 50\r\n    this._maxBuffered = 256000 // 256KB\r\n    this._latestGameState = null\r\n    this._chunkBuffers = {}\r\n    this._maxFrameSize = 16000\r\n  }\r\n\r\n  // Initialize as initiator (player who creates the room)\r\n  initAsInitiator() {\r\n    this.isInitiator = true\r\n    console.log('🔧 [' + this.instanceId + '] Initializing as initiator')\r\n    this.peer = new SimplePeer({\r\n      initiator: true,\r\n      trickle: true,\r\n      channelName: 'halloween-game',\r\n      config: {\r\n        iceServers: [\r\n          { urls: 'stun:stun.l.google.com:19302' },\r\n          { urls: 'stun:global.stun.twilio.com:3478' },\r\n          { urls: 'stun:stun1.l.google.com:19302' },\r\n          { urls: 'stun:stun2.l.google.com:19302' },\r\n          { urls: 'stun:stun3.l.google.com:19302' },\r\n          { urls: 'stun:stun4.l.google.com:19302' }\r\n        ],\r\n        iceTransportPolicy: 'all',\r\n        iceCandidatePoolSize: 10,\r\n        bundlePolicy: 'max-bundle',\r\n        rtcpMuxPolicy: 'require'\r\n      },\r\n      offerOptions: {\r\n        offerToReceiveAudio: false,\r\n        offerToReceiveVideo: false\r\n      }\r\n    })\r\n\r\n    this.setupPeerEvents()\r\n    return this.peer\r\n  }\r\n\r\n  // Initialize as receiver (player who joins the room)\r\n  initAsReceiver() {\r\n    this.isInitiator = false\r\n    console.log('🔧 [' + this.instanceId + '] Initializing as receiver')\r\n    this.peer = new SimplePeer({\r\n      initiator: false,\r\n      trickle: true,\r\n      channelName: 'halloween-game',\r\n      config: {\r\n        iceServers: [\r\n          { urls: 'stun:stun.l.google.com:19302' },\r\n          { urls: 'stun:global.stun.twilio.com:3478' },\r\n          { urls: 'stun:stun1.l.google.com:19302' },\r\n          { urls: 'stun:stun2.l.google.com:19302' },\r\n          { urls: 'stun:stun3.l.google.com:19302' },\r\n          { urls: 'stun:stun4.l.google.com:19302' }\r\n        ],\r\n        iceTransportPolicy: 'all',\r\n        iceCandidatePoolSize: 10,\r\n        bundlePolicy: 'max-bundle',\r\n        rtcpMuxPolicy: 'require'\r\n      },\r\n      answerOptions: {\r\n        offerToReceiveAudio: false,\r\n        offerToReceiveVideo: false\r\n      }\r\n    })\r\n\r\n    this.setupPeerEvents()\r\n    return this.peer\r\n  }\r\n\r\n  // Setup peer event handlers\r\n  setupPeerEvents() {\r\n    if (!this.peer) return\r\n\r\n    this.peer.on('signal', (signal) => {\r\n      // Signal data will be sent through Firebase\r\n      if (this.onSignalCallback) {\r\n        this.onSignalCallback(signal)\r\n      }\r\n    })\r\n\r\n    this.peer.on('connect', () => {\r\n      console.log('✅ WebRTC connection established!')\r\n      this.connected = true\r\n      this._reconnectAttempts = 0 // Reset reconnect counter on successful connection\r\n\r\n      // Wait a bit before testing and starting the game\r\n      setTimeout(() => {\r\n        // Configure low buffer threshold if available to help backpressure\r\n        try {\r\n          if (this.peer && this.peer._channel && typeof this.peer._channel.bufferedAmountLowThreshold === 'number') {\r\n            this.peer._channel.bufferedAmountLowThreshold = 65536\r\n            this.peer._channel.onbufferedamountlow = () => this._flushQueue()\r\n          }\r\n        } catch (e) { }\r\n\r\n        // Start keepalive pings to keep NAT bindings open on slow/unreliable links\r\n        try {\r\n          this.startKeepAlive()\r\n        } catch (e) {\r\n          console.error('❌ Keepalive failed to start:', e)\r\n        }\r\n\r\n        if (this.onConnectedCallback) {\r\n          this.onConnectedCallback()\r\n        }\r\n        this._startFlusher()\r\n      }, 500)\r\n    })\r\n\r\n    this.peer.on('data', (data) => {\r\n      // Touch keepalive on any data received\r\n      this.touchKeepAlive()\r\n\r\n      try {\r\n        const raw = data.toString()\r\n        const message = JSON.parse(raw)\r\n\r\n        // Handle ping messages\r\n        if (message.type === 'ping') {\r\n          // Send pong back\r\n          try {\r\n            this.peer.send(JSON.stringify({ type: 'pong' }))\r\n          } catch (e) { }\r\n          return\r\n        }\r\n\r\n        // Handle pong messages\r\n        if (message.type === 'pong') {\r\n          return\r\n        }\r\n\r\n        // Handle chunk frames\r\n        if (message.type === 'chunk') {\r\n          const { id, idx, total, payload } = message\r\n          if (!this._chunkBuffers[id]) this._chunkBuffers[id] = { total, parts: [] }\r\n          this._chunkBuffers[id].parts[idx] = payload\r\n          const buf = this._chunkBuffers[id]\r\n          if (buf.parts.filter(p => typeof p === 'string').length === total) {\r\n            const fullStr = buf.parts.join('')\r\n            delete this._chunkBuffers[id]\r\n            const fullMsg = JSON.parse(fullStr)\r\n            if (this.onMessageCallback) {\r\n              this.onMessageCallback(fullMsg)\r\n            }\r\n          }\r\n          return\r\n        }\r\n\r\n        if (this.onMessageCallback) {\r\n          this.onMessageCallback(message)\r\n        } else {\r\n          console.warn('⚠️ [' + this.instanceId + '] No message callback registered!')\r\n        }\r\n      } catch (error) {\r\n        console.error('[' + this.instanceId + '] Error parsing WebRTC message:', error)\r\n      }\r\n    })\r\n\r\n    console.log('✅ [' + this.instanceId + '] Event listeners attached to peer')\r\n\r\n    this.peer.on('error', (error) => {\r\n      console.error('WebRTC error:', error)\r\n      // Don't disconnect on stream errors, they're often non-fatal\r\n      if (error.code === 'ERR_DATA_CHANNEL' || error.code === 'ERR_CONNECTION_FAILURE') {\r\n        this.connected = false\r\n        if (this.onDisconnectedCallback) {\r\n          this.onDisconnectedCallback()\r\n        }\r\n        this.scheduleReconnect()\r\n      }\r\n    })\r\n\r\n    this.peer.on('close', () => {\r\n      console.log('WebRTC connection closed')\r\n      this.connected = false\r\n      this.stopKeepAlive()\r\n      this._stopFlusher()\r\n      if (this.onDisconnectedCallback) {\r\n        this.onDisconnectedCallback()\r\n      }\r\n      this.scheduleReconnect()\r\n    })\r\n  }\r\n\r\n  // Process signal from the other peer\r\n  signal(signalData) {\r\n    if (this.peer) {\r\n      this.peer.signal(signalData)\r\n    }\r\n  }\r\n\r\n  // Send game state update\r\n  sendGameState(gameState) {\r\n    // Coalesce to latest; flush loop will send when possible\r\n    this._latestGameState = gameState\r\n    this._enqueue({ type: 'coalesced-game-state' })\r\n  }\r\n\r\n  // Send player action\r\n  sendAction(action, payload) {\r\n    this._enqueue({ type: 'action', action, payload })\r\n  }\r\n\r\n  // Send chat message\r\n  sendMessage(message) {\r\n    this._enqueue({ type: 'message', data: message })\r\n  }\r\n\r\n  // Register callback for when signal is generated\r\n  onSignal(callback) {\r\n    this.onSignalCallback = callback\r\n  }\r\n\r\n  // Register callback for incoming messages\r\n  onMessage(callback) {\r\n    console.log('🔧 [' + this.instanceId + '] Registering message callback')\r\n    this.onMessageCallback = callback\r\n  }\r\n\r\n  // Register callback for connection established\r\n  onConnected(callback) {\r\n    this.onConnectedCallback = callback\r\n  }\r\n\r\n  // Register callback for disconnection\r\n  onDisconnected(callback) {\r\n    this.onDisconnectedCallback = callback\r\n  }\r\n\r\n  // Close connection\r\n  destroy() {\r\n    if (this.peer) {\r\n      this.peer.destroy()\r\n      this.peer = null\r\n    }\r\n    this.connected = false\r\n    this.stopKeepAlive()\r\n    this._reconnecting = false\r\n    this._reconnectAttempts = 0\r\n    if (this._reconnectTimer) {\r\n      clearTimeout(this._reconnectTimer)\r\n      this._reconnectTimer = null\r\n    }\r\n    this._stopFlusher()\r\n    this._outQueue = []\r\n    this._latestGameState = null\r\n  }\r\n\r\n  // Check if connected\r\n  isConnected() {\r\n    return this.connected\r\n  }\r\n\r\n  // Keepalive ping/pong for NAT and slow links\r\n  startKeepAlive() {\r\n    if (this._keepAliveTimer) return\r\n    this._lastPongAt = Date.now()\r\n    this._keepAliveTimer = setInterval(() => {\r\n      if (!this.peer || this.peer.destroyed) return\r\n      try {\r\n        this.peer.send(JSON.stringify({ type: 'ping' }))\r\n      } catch (e) {\r\n        console.warn('⚠️ Failed to send keepalive ping:', e)\r\n      }\r\n      // If no pong (any data) observed for 30s on slow connections, consider link flaky\r\n      if (Date.now() - (this._lastPongAt || 0) > 30000) {\r\n        console.warn('⚠️ No keepalive response for 30s, connection may be lost')\r\n        if (this.onDisconnectedCallback) {\r\n          this.onDisconnectedCallback()\r\n        }\r\n      }\r\n    }, 3000) // More frequent pings for slow connections\r\n  }\r\n\r\n  touchKeepAlive() {\r\n    this._lastPongAt = Date.now()\r\n  }\r\n\r\n  stopKeepAlive() {\r\n    if (this._keepAliveTimer) {\r\n      clearInterval(this._keepAliveTimer)\r\n      this._keepAliveTimer = null\r\n    }\r\n  }\r\n\r\n  // Automatic reconnection with exponential backoff\r\n  scheduleReconnect() {\r\n    if (this._reconnecting) return\r\n    if (this._reconnectAttempts >= this._maxReconnectAttempts) return\r\n    this._reconnecting = true\r\n    const delayMs = Math.min(16000, Math.pow(2, this._reconnectAttempts) * 1000) // 1s,2s,4s,8s,16s\r\n    this._reconnectTimer = setTimeout(() => {\r\n      this._reconnecting = false\r\n      this._reconnectAttempts += 1\r\n      this.reconnect()\r\n    }, delayMs)\r\n  }\r\n\r\n  reconnect() {\r\n    if (this.peer) {\r\n      try { this.peer.destroy() } catch (e) { }\r\n      this.peer = null\r\n    }\r\n    this.connected = false\r\n    // Recreate peer in the same role and reattach handlers; external signal callbacks remain the same\r\n    if (this.isInitiator === true) {\r\n      this.initAsInitiator()\r\n    } else if (this.isInitiator === false) {\r\n      this.initAsReceiver()\r\n    } else {\r\n      return\r\n    }\r\n  }\r\n\r\n  // Internal: queue and flush with backpressure and chunking\r\n  _enqueue(obj) {\r\n    if (obj.type === 'coalesced-game-state') {\r\n      const hasMarker = this._outQueue.some(m => m.type === 'coalesced-game-state')\r\n      if (!hasMarker) this._outQueue.push(obj)\r\n    } else {\r\n      this._outQueue.push(obj)\r\n    }\r\n    this._flushQueue()\r\n    this._startFlusher()\r\n  }\r\n\r\n  _startFlusher() {\r\n    if (this._flushTimer) return\r\n    this._flushTimer = setInterval(() => this._flushQueue(), this._flushIntervalMs)\r\n  }\r\n\r\n  _stopFlusher() {\r\n    if (this._flushTimer) {\r\n      clearInterval(this._flushTimer)\r\n      this._flushTimer = null\r\n    }\r\n  }\r\n\r\n  _flushQueue() {\r\n    if (!this.peer || !this.connected) return\r\n    const ch = this.peer._channel\r\n    if (!ch || ch.readyState !== 'open') return\r\n    if (typeof ch.bufferedAmount === 'number' && ch.bufferedAmount > this._maxBuffered) return\r\n\r\n    const idx = this._outQueue.findIndex(m => m.type === 'coalesced-game-state')\r\n    if (idx !== -1) {\r\n      const gs = this._latestGameState\r\n      if (gs) {\r\n        const msg = { type: 'gameState', data: gs }\r\n        this._sendJson(msg)\r\n      }\r\n      this._outQueue.splice(idx, 1)\r\n    }\r\n\r\n    let sent = 0\r\n    const maxPerTick = 5\r\n    while (this._outQueue.length > 0 && sent < maxPerTick) {\r\n      const next = this._outQueue.shift()\r\n      if (next.type !== 'coalesced-game-state') {\r\n        this._sendJson(next)\r\n        sent++\r\n      }\r\n      if (typeof ch.bufferedAmount === 'number' && ch.bufferedAmount > this._maxBuffered) break\r\n    }\r\n  }\r\n\r\n  _sendJson(obj) {\r\n    try {\r\n      const jsonStr = JSON.stringify(obj)\r\n      if (jsonStr.length <= this._maxFrameSize) {\r\n        this.peer.send(jsonStr)\r\n      } else {\r\n        const id = Math.random().toString(36).slice(2)\r\n        const total = Math.ceil(jsonStr.length / this._maxFrameSize)\r\n        for (let i = 0; i < total; i++) {\r\n          const slice = jsonStr.slice(i * this._maxFrameSize, (i + 1) * this._maxFrameSize)\r\n          this.peer.send(JSON.stringify({ type: 'chunk', id, idx: i, total, payload: slice }))\r\n        }\r\n      }\r\n    } catch (e) {\r\n      this._outQueue.unshift(obj)\r\n    }\r\n  }\r\n}\r\n\r\nexport default new WebRTCService()\r\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InteractionOverlay.vue?vue&type=style&index=0&id=98180e24&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InteractionOverlay.vue?vue&type=style&index=0&id=98180e24&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Controls.vue?vue&type=style&index=0&id=4cb7a02e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Controls.vue?vue&type=style&index=0&id=4cb7a02e&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('GameThree'),(_vm.mode === 'lobby')?_c('Lobby'):_vm._e(),(_vm.mode === 'play')?_c('Controls'):_vm._e(),(_vm.mode === 'levelSelect')?_c('LevelSelect'):_vm._e(),(_vm.mode === 'levelWin')?_c('LevelWin'):_vm._e(),(_vm.mode === 'characterSelect')?_c('CharacterSelect'):_vm._e(),(_vm.mode === 'mapEditor')?_c('MapEditor'):_vm._e(),_c('InteractionOverlay'),(_vm.showQRButton)?_c('div',{staticClass:\"qr-code-button\",on:{\"click\":function($event){$event.stopPropagation();return _vm.toggleQRCode($event)}}},[_c('img',{staticClass:\"qr-icon\",attrs:{\"src\":_vm.baseUrl + 'qricon.png',\"alt\":\"QR Code\"}})]):_vm._e(),(_vm.showQR)?_c('div',{staticClass:\"qr-modal\",on:{\"click\":_vm.toggleQRCode}},[_c('div',{staticClass:\"qr-content\",on:{\"click\":function($event){$event.stopPropagation();}}},[_c('div',{staticClass:\"qr-placeholder\"},[_c('img',{attrs:{\"src\":_vm.baseUrl + 'qrcode.png',\"alt\":\"QR Code\"}})]),_c('button',{staticClass:\"close-qr\",on:{\"click\":_vm.toggleQRCode}},[_vm._v(\"Close\")])])]):_vm._e(),(_vm.mode === 'lobby')?_c('DirectionsHelper'):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"controls\"},[_c('div',{staticClass:\"score-holder\"},[_c('score')],1),(_vm.isMultiplayer)?_c('div',{staticClass:\"role-indicator\",class:_vm.playerRole},[(_vm.isPlayer)?_c('span',[_vm._v(\"🎮 Player\")]):_c('span',[_vm._v(\"👁️ Guide\")])]):_vm._e(),_c('div',{staticClass:\"menu-toggle\"},[_c('button',{staticClass:\"control\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.openMenu($event)},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.openMenu($event)}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 32 32\"}},[_c('path',{attrs:{\"d\":\"M23.374,8.626H8.626 c-0.393,0-0.712,0.319-0.712,0.712v1.508c0,0.393,0.319,0.712,0.712,0.712h14.747c0.393,0,0.712-0.319,0.712-0.712V9.338 C24.086,8.945,23.767,8.626,23.374,8.626z M23.374,14.534H8.626c-0.393,0-0.712,0.319-0.712,0.712v1.508 c0,0.393,0.319,0.712,0.712,0.712h14.747c0.393,0,0.712-0.319,0.712-0.712v-1.508C24.086,14.853,23.767,14.534,23.374,14.534z M23.374,20.441H8.626c-0.393,0-0.712,0.319-0.712,0.712v1.508c0,0.393,0.319,0.712,0.712,0.712h14.747 c0.393,0,0.712-0.319,0.712-0.712v-1.508C24.086,20.76,23.767,20.441,23.374,20.441z\"}})])])]),((!_vm.isMultiplayer || _vm.isPlayer) && _vm.canTrickOrTreat)?_c('div',{staticClass:\"trick-or-treat-container\"},[_c('button',{staticClass:\"trick-or-treat-button\",attrs:{\"type\":\"button\"},on:{\"touchstart\":function($event){$event.preventDefault();$event.stopPropagation();_vm.$store.dispatch('trickOrTreat')},\"mousedown\":function($event){_vm.$store.dispatch('trickOrTreat')}}},[_vm._v(\"\\n      🎃 Trick-Or-Treat! 🍬\\n    \")])]):_vm._e(),(!_vm.isMultiplayer || _vm.isPlayer)?_c('div',{staticClass:\"arrows\"},[_c('div',{staticClass:\"relative\"},_vm._l((_vm.$options.buttons),function(item){return _c('div',{key:item.action,staticClass:\"control-spacer\",class:item.direction},[_c('button',{staticClass:\"control\",attrs:{\"type\":\"button\"},on:{\"touchstart\":function($event){$event.preventDefault();$event.stopPropagation();_vm.$store.dispatch(item.action)},\"mousedown\":function($event){_vm.$store.dispatch(item.action)}}},[_c('img',{staticClass:\"control-icon\",attrs:{\"src\":_vm.baseUrl + item.image,\"alt\":item.direction}})])])}))]):(_vm.isGuide)?_c('div',{staticClass:\"guide-info\"},[_c('p',[_vm._v(\"👁️ 上から見て、パートナーをナビゲートするのを手伝ってください！\")])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"score\"},[_c('div',[_c('svg',{staticClass:\"icon\",attrs:{\"viewBox\":\"0 0 32 32\"}},[_c('g',{staticClass:\"candy\"},[_c('path',{staticStyle:{\"fill\":\"#FEEB39\"},attrs:{\"d\":\"M25.308,9.152c-0.04-0.38-0.08-0.759-0.12-1.139c0.073-0.596-0.1-1.094-0.476-1.579 c-0.573-0.74-1.071-1.539-1.606-2.321c0.015-0.008-0.035,0.002-0.057,0.031c-1.005,1.357-2.011,2.712-3.003,4.079 c-0.069,0.095-0.026,0.27-0.035,0.408c0,0-0.001,0-0.001,0.001c-0.377,0.234-0.665,0.52-0.605,1.014l0.009,0.001 c-0.032,0.049-0.064,0.098-0.096,0.146c-0.012,0.255-0.024,0.51-0.035,0.765c-0.124-0.001-0.247-0.001-0.371-0.002l0,0 c-0.056-0.008-0.111-0.016-0.167-0.023c-1.397-0.308-2.789-0.977-4.199-0.046c-0.475,0.191-0.951,0.383-1.426,0.574 c-0.029-0.016-0.053-0.01-0.07,0.019c-0.051,0.039-0.101,0.077-0.152,0.116c0,0,0.007-0.021,0.007-0.021 c-0.232,0.202-0.501,0.375-0.688,0.612c-0.416,0.525-0.771,1.098-1.188,1.621c-0.355,0.445-0.579,0.911-0.512,1.49 c-0.032,0.228-0.093,0.457-0.089,0.685c0.015,0.801-0.391,1.609,0.036,2.412c0.022,0.041-0.225,0.224-0.346,0.34 c-0.171,0.009-0.342,0.019-0.513,0.028C8.997,18.267,8.45,18.408,7.9,18.693c-1.053,0.545-2.147,1.012-3.199,1.558 c-0.461,0.239-0.862,0.593-1.29,0.895c-0.058,0.002-0.116,0.004-0.174,0.005c0.301,0.336,0.602,0.671,0.903,1.007l1.31,1.003 c0.632,0.282,1.27,0.552,1.892,0.854c0.211,0.103,0.458,0.25,0.556,0.444c0.208,0.412,0.329,0.869,0.485,1.307 c0.288,0.606,0.571,1.215,0.869,1.816c0.06,0.122,0.179,0.306,0.271,0.306c0.531-0.001,1.063-0.048,1.594-0.08l0,0 c0.03-0.054,0.059-0.107,0.089-0.161l0.068-0.232c0.086-0.21,0.171-0.42,0.257-0.63c0.254-0.301,0.507-0.601,0.761-0.902 c0.206-0.228,0.412-0.456,0.618-0.684l0.045,0.001L13,25.201c0.478-0.783,1.396-1.319,1.339-2.4 c0.252,0.033,0.504,0.065,0.756,0.098c0.126,0.016,0.252,0.033,0.378,0.049c1.072,0.305,2.062,0.269,3.178-0.114 c1.732-0.594,2.85-1.705,3.703-3.217c0.059-0.104,0.17-0.178,0.257-0.265c0.035-0.341,0.071-0.683,0.106-1.024l0.146-1.131 c-0.034-0.554-0.067-1.108-0.101-1.662c0.903,0.072,1.507-0.506,2.153-0.992l1.019-0.775c0.228-0.121,0.455-0.243,0.683-0.364 c0.069-0.018,0.137-0.036,0.206-0.055c0.054-0.014,0.11-0.024,0.168-0.033c0.229-0.034,0.473-0.038,0.667-0.138 c0.146-0.075,0.263-0.203,0.324-0.439c0.236-0.364,0.473-0.728,0.779-1.201C27.596,10.732,26.452,9.942,25.308,9.152z\"}}),_c('path',{staticStyle:{\"fill\":\"#FB691A\"},attrs:{\"d\":\"M4.14,22.158c-0.301-0.336-0.602-0.671-0.903-1.007c0.058-0.002,0.116-0.004,0.174-0.005 c0.334-0.015,0.677,0.01,1.002-0.053c1.109-0.215,2.147-0.236,2.874,0.839c0.404,0.718,0.808,1.436,1.212,2.155 c0.107,0.252,0.23,0.498,0.318,0.757c0.272,0.796,0.605,1.53,1.543,1.729c0.222,0.359,0.445,0.718,0.667,1.077 c0.03,0.053,0.059,0.107,0.089,0.16c-0.531,0.032-1.063,0.079-1.594,0.08c-0.092,0-0.21-0.184-0.271-0.306 c-0.298-0.601-0.581-1.21-0.869-1.816c-0.157-0.438-0.277-0.895-0.485-1.307c-0.098-0.194-0.345-0.342-0.556-0.444 c-0.622-0.302-1.26-0.572-1.892-0.854C5.013,22.827,4.577,22.493,4.14,22.158z\"}}),_c('path',{staticStyle:{\"fill\":\"#FDA728\"},attrs:{\"d\":\"M23.865,13.082c-0.79-0.322-1.139-1.103-1.338-1.887c-0.398-1.56-0.584-1.663-2.06-0.962 c-0.342,0.162-0.692,0.306-1.039,0.459c-0.002,0.042,0,0.083,0.006,0.125c0.671,0.607,1.441,1.138,1.984,1.844 c0.456,0.593,0.648,1.389,0.957,2.095c0.13,0.259,0.259,0.518,0.389,0.776c0.903,0.072,1.507-0.506,2.153-0.992 C24.919,13.799,24.577,13.373,23.865,13.082z M13.148,21.162c-0.522-0.245-0.979-0.605-0.959-1.209 c0.021-0.644-0.31-0.958-0.797-1.22c-0.407,0.426-0.803,0.864-1.225,1.275c-0.273,0.265-0.351,0.511-0.094,0.826 c0.079,0.097,0.135,0.217,0.18,0.336c0.35,0.929,0.993,1.362,2.005,1.272c0.2-0.018,0.419,0.182,0.629,0.282 c-0.157,0.241-0.314,0.482-0.471,0.722c-0.003,0.127-0.007,0.253-0.01,0.38c0.168,0.459,0.336,0.917,0.504,1.376l0.045,0.001 L13,25.201c0.478-0.783,1.396-1.319,1.339-2.4c-0.214-0.378-0.407-0.77-0.651-1.128C13.551,21.473,13.331,21.33,13.148,21.162z\"}}),_c('path',{staticStyle:{\"fill\":\"#FDDE36\"},attrs:{\"d\":\"M13.712,17.365c-0.084,0.061-0.149,0.148-0.225,0.221c-0.518,0.499-0.722,0.453-0.952-0.228 c-0.06-0.178-0.086-0.367-0.128-0.551c-0.073-0.07-0.197-0.131-0.211-0.211c-0.305-1.724-0.247-3.383,1.227-4.601 c0.344-0.284,0.927-0.278,1.401-0.405c-0.04-0.171-0.079-0.342-0.119-0.513c-0.528-0.005-1.055-0.01-1.583-0.015 c-0.029-0.016-0.053-0.01-0.07,0.019c-0.051,0.039-0.101,0.077-0.152,0.116c0,0,0.007-0.021,0.007-0.021 c-0.217,0.379-0.396,0.787-0.659,1.13c-0.624,0.811-1.279,1.594-1.135,2.722c0.006,0.05-0.051,0.108-0.105,0.214 c-0.173-0.122-0.331-0.232-0.488-0.343c-0.031,0.228-0.093,0.457-0.089,0.685c0.015,0.801-0.391,1.609,0.036,2.412 c0.022,0.041-0.225,0.224-0.346,0.34c-0.332,0.524-0.669,1.045-0.991,1.575c-0.114,0.188-0.192,0.398-0.286,0.599 c0.438-0.486,0.848-1,1.323-1.446c0.271-0.254,0.647-0.397,0.975-0.591c0.085,0.087,0.169,0.173,0.254,0.26 c0.486,0.262,0.817,0.576,0.797,1.22c-0.019,0.604,0.437,0.964,0.959,1.209c0.35-0.345,0.7-0.69,1.05-1.035 c-0.953-0.925-0.925-0.884,0.232-1.672c0.62-0.422,1.127-1.012,1.685-1.527c-0.128-0.337-0.256-0.674-0.384-1.011 C15.058,16.399,14.383,16.879,13.712,17.365z M25.949,11.743c-0.656,0.14-0.908-0.227-1.105-0.668 c-0.236-0.529-0.478-1.084-0.555-1.65c-0.169-1.243-0.551-1.552-1.734-1.349c-0.563,0.096-1.151,0.045-1.727,0.061 c-0.272,0.165-0.543,0.33-0.816,0.495c-0.377,0.234-0.665,0.52-0.605,1.014l0.4,0.023c0.001-0.042,0.001-0.083,0.002-0.125 c0.14-0.494,0.502-0.693,0.979-0.764c0.477-0.071,0.956-0.146,1.424-0.258c1.041-0.248,1.497,0.034,1.526,1.112 c0.018,0.683,0.275,1.215,0.651,1.74c0.303,0.424,0.607,0.755,1.212,0.761c0.437,0.004,0.767,0.313,0.843,0.808 c0.024,0.158,0.115,0.306,0.175,0.459c0.069-0.018,0.137-0.036,0.206-0.055c0.021-0.167,0.044-0.334,0.064-0.501 C26.952,12.313,26.451,11.636,25.949,11.743z M10.19,23.581c-0.714,0.036-1.105-0.301-1.302-0.947 c-0.049-0.161-0.079-0.365-0.192-0.463c-0.515-0.444-0.481-0.906-0.111-1.407c-0.165,0.121-0.417,0.209-0.477,0.369 c-0.115,0.309-0.287,0.811-0.145,0.964c0.585,0.63,0.599,1.741,1.637,1.976c0.101,0.023,0.211,0.006,0.317,0.007 c0.233,0.001,0.466-0.002,0.699,0.001c0.773,0.01,0.844,0.114,0.523,0.8c-0.06,0.128-0.171,0.232-0.259,0.347 c-0.044,0.126-0.088,0.252-0.132,0.378c0.175,0.603,0.349,1.206,0.524,1.809c0.086-0.21,0.171-0.42,0.257-0.63 c-0.414-1.053-0.15-2.072,0.324-3.131C11.191,23.622,10.688,23.556,10.19,23.581z M11.117,27.809 c0.03-0.054,0.059-0.107,0.089-0.161c-0.059,0-0.119,0.001-0.178,0.001C11.058,27.703,11.088,27.756,11.117,27.809z M17.773,11.077 c0.001,0.128,0.001,0.255,0.002,0.383c0.385,0.089,0.858,0.067,1.138,0.288c0.652,0.516,1.232,1.13,1.787,1.754 c0.091,0.103-0.018,0.547-0.169,0.675c-0.62,0.528-1.288,1-1.949,1.478c-0.11,0.08-0.273,0.087-0.411,0.128 c0.164,0.555,0.329,1.11,0.493,1.666c0.249-0.102,0.528-0.162,0.741-0.315c0.629-0.449,1.133-1.1,2.006-1.129 c0.093-0.003,0.272-0.216,0.254-0.294c-0.182-0.753-0.221-1.623-0.642-2.218C20.227,12.37,19.356,11.203,17.773,11.077z\"}}),_c('path',{staticStyle:{\"fill\":\"#FEFE91\"},attrs:{\"d\":\"M15.214,13.926c-0.044-0.057-0.088-0.114-0.132-0.171c-0.093-0.599-0.185-1.197-0.278-1.796 c0.016-0.034,0.03-0.069,0.041-0.105c0.937-0.446,1.894-0.666,2.906-0.253c0.004,0.163,0.009,0.326,0.013,0.489 c-0.478,0.298-0.972,0.575-1.43,0.902C15.94,13.273,15.586,13.612,15.214,13.926z\"}}),_c('path',{staticStyle:{\"fill\":\"#FEC32F\"},attrs:{\"d\":\"M24.529,12.42c-0.078,0.003-0.189-0.105-0.235-0.188c-0.402-0.733-0.969-1.362-1.086-2.263 c-0.132-1.02-0.455-1.14-1.42-0.861c-0.647,0.187-1.318,0.293-1.978,0.435c-0.001,0.042-0.002,0.083-0.002,0.125 c-0.133,0.306-0.266,0.612-0.399,0.918c0.005,0.035,0.011,0.07,0.019,0.105c0.346-0.152,0.697-0.296,1.039-0.459 c1.476-0.702,1.662-0.599,2.06,0.962c0.2,0.784,0.549,1.565,1.338,1.887c0.712,0.291,1.054,0.717,1.052,1.459 c0.34-0.258,0.68-0.516,1.019-0.775C25.686,13.09,25.465,12.388,24.529,12.42z M11.965,24.923c0.08,0.328,0.216,0.641,0.327,0.961 c0.206-0.228,0.412-0.456,0.618-0.684c-0.168-0.459-0.336-0.917-0.503-1.376C11.849,24.025,11.853,24.466,11.965,24.923z M15.981,21.27c0.128-0.132,0.352-0.253,0.368-0.397c0.075-0.669,0.093-1.344,0.131-2.016c-0.719,0.425-1.439,0.85-2.158,1.275 C14.875,20.511,15.428,20.89,15.981,21.27z M12.887,22.723c-0.21-0.099-0.429-0.299-0.629-0.282 c-1.013,0.09-1.655-0.344-2.005-1.272c-0.045-0.118-0.101-0.239-0.18-0.336c-0.257-0.314-0.178-0.561,0.094-0.826 c0.423-0.41,0.818-0.848,1.225-1.275c-0.085-0.087-0.169-0.173-0.254-0.26c-0.387,0.408-0.782,0.809-1.16,1.226 c-0.355,0.391-0.904,0.763-0.976,1.207c-0.068,0.415,0.422,0.899,0.587,1.379c0.255,0.741,0.811,0.876,1.49,0.915 c0.449,0.026,0.892,0.16,1.337,0.245C12.573,23.204,12.73,22.964,12.887,22.723z\"}}),_c('path',{staticStyle:{\"fill\":\"#FECF32\"},attrs:{\"d\":\"M26.444,12.943c-0.075-0.495-0.406-0.804-0.843-0.808c-0.605-0.006-0.908-0.337-1.212-0.761 c-0.375-0.524-0.632-1.057-0.651-1.74c-0.029-1.078-0.485-1.36-1.526-1.112c-0.469,0.112-0.947,0.187-1.424,0.258 c-0.477,0.071-0.839,0.27-0.979,0.764c0.66-0.142,1.331-0.248,1.978-0.435c0.965-0.279,1.288-0.159,1.42,0.861 c0.117,0.9,0.684,1.53,1.086,2.263c0.046,0.084,0.157,0.191,0.235,0.188c0.936-0.032,1.157,0.67,1.407,1.346 c0.228-0.121,0.455-0.243,0.683-0.364C26.559,13.249,26.468,13.101,26.444,12.943z M19.407,9.646l0.009,0.001 c0.001-0.001,0.001-0.002,0.002-0.003L19.407,9.646z M19.807,9.669l-0.391-0.022c-0.032,0.049-0.064,0.098-0.096,0.146 c-0.012,0.255-0.024,0.51-0.035,0.765c0.042,0.01,0.083,0.019,0.124,0.029C19.542,10.281,19.675,9.975,19.807,9.669z M9.589,22.285 c-0.166-0.48-0.655-0.964-0.587-1.379c0.073-0.444,0.621-0.816,0.976-1.207c0.378-0.416,0.773-0.818,1.16-1.226 c-0.329,0.193-0.704,0.336-0.975,0.591c-0.475,0.446-0.886,0.96-1.323,1.446c-0.085,0.085-0.17,0.17-0.255,0.256 c-0.37,0.501-0.404,0.963,0.111,1.407c0.113,0.098,0.143,0.302,0.192,0.463c0.197,0.645,0.587,0.983,1.302,0.947 c0.498-0.026,1.002,0.041,1.666,0.074c-0.474,1.059-0.738,2.078-0.324,3.131c0.254-0.301,0.507-0.601,0.761-0.902 c-0.111-0.32-0.247-0.634-0.327-0.961c-0.111-0.457-0.116-0.898,0.441-1.099c0.003-0.127,0.007-0.253,0.01-0.38 c-0.445-0.086-0.888-0.219-1.337-0.245C10.4,23.161,9.844,23.026,9.589,22.285z M18.913,11.748c-0.28-0.222-0.753-0.2-1.138-0.288 c-0.008,0.047-0.015,0.094-0.023,0.141c0.004,0.163,0.009,0.326,0.013,0.489c0.135,1.231,0.27,2.462,0.405,3.693 c0.138-0.041,0.301-0.048,0.411-0.128c0.661-0.478,1.329-0.951,1.949-1.478c0.151-0.128,0.261-0.572,0.169-0.675 C20.145,12.878,19.565,12.264,18.913,11.748z M14.43,18.455c-1.157,0.788-1.185,0.748-0.232,1.672 c0.041,0.002,0.083,0.003,0.124,0.004c0.719-0.425,1.439-0.85,2.158-1.275c-0.122-0.643-0.244-1.285-0.365-1.928 C15.557,17.443,15.05,18.032,14.43,18.455z M12.407,16.807c0.002-0.168,0.005-0.337,0.007-0.505 c-0.148-1.598,0.613-2.833,1.617-3.952c0.18-0.2,0.512-0.264,0.774-0.39c0.016-0.034,0.029-0.069,0.041-0.105 c-0.008-0.088-0.015-0.176-0.023-0.264c-0.473,0.127-1.057,0.121-1.401,0.405c-1.473,1.219-1.532,2.877-1.227,4.601 C12.21,16.676,12.334,16.737,12.407,16.807z\"}}),_c('path',{staticStyle:{\"fill\":\"#FDFD3E\"},attrs:{\"d\":\"M22.375,14.756c-0.047,0.158-0.165,0.336-0.129,0.472c0.288,1.088-0.555,1.738-0.964,2.553 c-0.051,0.101-0.233,0.248-0.277,0.225c-0.751-0.396-1.259,0.286-1.888,0.406c-0.059,0.011-0.123,0.002-0.275,0.002 c-0.059-0.321-0.118-0.644-0.177-0.966c-0.164-0.555-0.329-1.11-0.493-1.666c-0.135-1.231-0.27-2.462-0.405-3.693 c-0.478,0.298-0.972,0.575-1.43,0.902c-0.395,0.282-0.749,0.621-1.121,0.935c0.172,0.664,0.344,1.327,0.517,1.991 c0.128,0.337,0.256,0.674,0.384,1.011c0.122,0.643,0.243,1.286,0.365,1.928c-0.038,0.673-0.056,1.348-0.131,2.016 c-0.016,0.144-0.24,0.266-0.368,0.397c-0.098,0.194-0.145,0.474-0.303,0.567c-0.528,0.312-0.642,0.646-0.205,1.11 c1.072,0.305,2.062,0.269,3.178-0.114c1.732-0.594,2.85-1.705,3.703-3.217c0.059-0.104,0.17-0.178,0.257-0.265 c0.035-0.341,0.071-0.683,0.106-1.024l0.146-1.131l-0.101-1.662C22.634,15.274,22.504,15.015,22.375,14.756z M7.9,18.693 c-1.053,0.545-2.147,1.012-3.199,1.558c-0.461,0.239-0.862,0.593-1.29,0.895c0.334-0.015,0.677,0.01,1.002-0.053 c1.109-0.215,2.147-0.236,2.874,0.839l2.318-3.569C8.997,18.267,8.45,18.408,7.9,18.693z M23.107,4.113 c0.015-0.008-0.035,0.002-0.057,0.031c-1.005,1.357-2.011,2.712-3.003,4.079c-0.069,0.095-0.026,0.27-0.035,0.409 c0.272-0.165,0.543-0.33,0.815-0.495c0.343-0.253,0.653-0.601,1.038-0.735c0.546-0.191,1.155-0.195,1.722-0.336 c0.523-0.13,0.902-0.061,1.156,0.465c0.091,0.189,0.293,0.323,0.445,0.483c0.073-0.596-0.1-1.094-0.476-1.579 C24.14,5.694,23.642,4.895,23.107,4.113z M14.823,11.59c0.008,0.088,0.015,0.176,0.023,0.264c0.937-0.446,1.894-0.666,2.906-0.253 c0.008-0.047,0.015-0.094,0.023-0.141c-0.001-0.128-0.002-0.255-0.002-0.383c-0.019-0.355,0.089-0.549,0.501-0.468 c0.147,0.029,0.315-0.048,0.473-0.076c-1.397-0.308-2.789-0.977-4.199-0.046c0.052,0.196,0.104,0.393,0.157,0.589 C14.744,11.247,14.783,11.418,14.823,11.59z M25.308,9.152c0.103,0.516,0.167,1.044,0.321,1.544 c0.13,0.422,0.459,0.603,0.907,0.407c0.52-0.227,0.888-0.014,1.094,0.444c0.168,0.374,0.239,0.792,0.353,1.191 c0.236-0.364,0.473-0.728,0.779-1.201C27.596,10.732,26.452,9.942,25.308,9.152z M19.428,10.692 c-0.008-0.035-0.014-0.07-0.019-0.105c-0.041-0.01-0.083-0.019-0.124-0.029c-0.124-0.001-0.247-0.001-0.371-0.002 c0.173,0.087,0.347,0.174,0.52,0.261C19.428,10.776,19.426,10.734,19.428,10.692z M10.565,24.465 c-0.693-0.1-1.378-0.25-2.066-0.378c0.107,0.252,0.23,0.498,0.318,0.757c0.272,0.796,0.605,1.53,1.543,1.729 c0.13-0.322,0.26-0.643,0.389-0.965c0.044-0.126,0.088-0.252,0.132-0.378C10.866,24.939,11.147,24.549,10.565,24.465z M14.031,12.349c-1.004,1.119-1.766,2.354-1.617,3.952c0.249-0.286,0.545-0.545,0.739-0.865c0.469-0.773,1.098-1.338,1.93-1.682 c-0.093-0.599-0.185-1.197-0.278-1.796C14.543,12.085,14.211,12.149,14.031,12.349z\"}})])]),_c('span',[_vm._v(\": \"+_vm._s(_vm.$store.getters.score))])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./Score.vue?vue&type=template&id=9b1f1d38&scoped=true&\"\nvar script = {}\nimport style0 from \"./Score.vue?vue&type=style&index=0&id=9b1f1d38&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9b1f1d38\",\n  null\n  \n)\n\ncomponent.options.__file = \"Score.vue\"\nexport default component.exports","<template>\r\n  <div class=\"controls\">\r\n    <div class=\"score-holder\">\r\n      <score />\r\n    </div>\r\n\r\n    <!-- Role indicator for multiplayer -->\r\n    <div v-if=\"isMultiplayer\" class=\"role-indicator\" :class=\"playerRole\">\r\n      <span v-if=\"isPlayer\">🎮 Player</span>\r\n      <span v-else>👁️ Guide</span>\r\n    </div>\r\n\r\n    <div\r\n      class=\"menu-toggle\"\r\n    >\r\n      <button\r\n        class=\"control\"\r\n        type=\"button\"\r\n        @click.stop.prevent=\"openMenu\"\r\n        @touchstart.stop.prevent=\"openMenu\"\r\n      >\r\n        <svg viewBox=\"0 0 32 32\">\r\n          <path d=\"M23.374,8.626H8.626 c-0.393,0-0.712,0.319-0.712,0.712v1.508c0,0.393,0.319,0.712,0.712,0.712h14.747c0.393,0,0.712-0.319,0.712-0.712V9.338 C24.086,8.945,23.767,8.626,23.374,8.626z M23.374,14.534H8.626c-0.393,0-0.712,0.319-0.712,0.712v1.508 c0,0.393,0.319,0.712,0.712,0.712h14.747c0.393,0,0.712-0.319,0.712-0.712v-1.508C24.086,14.853,23.767,14.534,23.374,14.534z M23.374,20.441H8.626c-0.393,0-0.712,0.319-0.712,0.712v1.508c0,0.393,0.319,0.712,0.712,0.712h14.747 c0.393,0,0.712-0.319,0.712-0.712v-1.508C24.086,20.76,23.767,20.441,23.374,20.441z\" />\r\n        </svg>\r\n      </button>\r\n    </div>\r\n\r\n    <!-- Trick-Or-Treat button (center of screen when facing a house) -->\r\n    <div v-if=\"(!isMultiplayer || isPlayer) && canTrickOrTreat\" class=\"trick-or-treat-container\">\r\n      <button\r\n        class=\"trick-or-treat-button\"\r\n        type=\"button\"\r\n        @touchstart.prevent.stop=\"$store.dispatch('trickOrTreat')\"\r\n        @mousedown=\"$store.dispatch('trickOrTreat')\"\r\n      >\r\n        🎃 Trick-Or-Treat! 🍬\r\n      </button>\r\n    </div>\r\n\r\n    <!-- Show controls only for player role or single player -->\r\n    <div v-if=\"!isMultiplayer || isPlayer\" class=\"arrows\">\r\n      <div class=\"relative\">\r\n        <div\r\n          v-for=\"item in $options.buttons\"\r\n          :key=\"item.action\"\r\n          class=\"control-spacer\"\r\n          :class=\"item.direction\"\r\n        >\r\n          <button\r\n            class=\"control\"\r\n            type=\"button\"\r\n            @touchstart.prevent.stop=\"$store.dispatch(item.action)\"\r\n            @mousedown=\"$store.dispatch(item.action)\"\r\n          >\r\n            <img :src=\"baseUrl + item.image\" :alt=\"item.direction\" class=\"control-icon\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Guide info banner -->\r\n    <div v-else-if=\"isGuide\" class=\"guide-info\">\r\n      <p>👁️ 上から見て、パートナーをナビゲートするのを手伝ってください！</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport Score from './Score'\r\n\r\nconst keyMap = {\r\n  'ArrowUp': 'forward',\r\n  'ArrowDown': 'forward',\r\n  'ArrowLeft': 'turnLeftAction',\r\n  'ArrowRight': 'turnRightAction',\r\n  'w': 'forward',\r\n  's': 'forward',\r\n  'a': 'turnLeftAction',\r\n  'd': 'turnRightAction',\r\n  'W': 'forward',\r\n  'S': 'forward',\r\n  'A': 'turnLeftAction',\r\n  'D': 'turnRightAction',\r\n  '8': 'forward',\r\n  '2': 'forward',\r\n  '5': 'forward',\r\n  '4': 'turnLeftAction',\r\n  '6': 'turnRightAction',\r\n  ' ': 'forward'\r\n}\r\nexport default {\r\n  name: 'Controls',\r\n  components: {\r\n    Score\r\n  },\r\n  methods: {\r\n    openMenu (event) {\r\n      if (event) {\r\n        event.stopPropagation()\r\n        event.preventDefault()\r\n      }\r\n      this.$store.dispatch('mode', 'levelSelect')\r\n    },\r\n    handleKeydown (event) {\r\n      // Only handle keyboard input if player or single player\r\n      if (this.isMultiplayer && !this.isPlayer) {\r\n        return\r\n      }\r\n\r\n      const action = keyMap[event.key]\r\n      if (action) {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n        this.$store.dispatch(action)\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'isMultiplayer',\r\n      'isPlayer',\r\n      'isGuide',\r\n      'playerRole',\r\n      'canTrickOrTreat'\r\n    ]),\r\n    baseUrl () {\r\n      return process.env.BASE_URL\r\n    }\r\n  },\r\n  buttons: [\r\n    {\r\n      direction: 'up',\r\n      action: 'forward',\r\n      image: 'gostraight.png'\r\n    },\r\n    {\r\n      direction: 'left',\r\n      action: 'turnLeftAction',\r\n      image: 'turnleft.png'\r\n    },\r\n    {\r\n      direction: 'right',\r\n      action: 'turnRightAction',\r\n      image: 'turnright.png'\r\n    },\r\n    {\r\n      direction: 'down',\r\n      action: 'shortForwardAction',\r\n      image: 'gostraightlittle.png'\r\n    }\r\n  ],\r\n  mounted () {\r\n    window.document.body.addEventListener('keydown', this.handleKeydown)\r\n  },\r\n  destroyed () {\r\n    window.document.body.removeEventListener('keydown', this.handleKeydown)\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.controls {\r\n  .score-holder {\r\n    position: absolute;\r\n    top: 0.5rem;\r\n    left: 0.5rem;\r\n    border-radius: 1rem;\r\n    background-color: #40408a;\r\n  }\r\n\r\n  .role-indicator {\r\n    position: absolute;\r\n    top: 0.5rem;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    padding: 0.5rem 1rem;\r\n    border-radius: 1rem;\r\n    font-size: 1.25rem;\r\n    font-weight: bold;\r\n\r\n    &.player {\r\n      background-color: #4caf50;\r\n      color: #fff;\r\n    }\r\n\r\n    &.guide {\r\n      background-color: #ff9800;\r\n      color: #fff;\r\n    }\r\n  }\r\n\r\n  .menu-toggle {\r\n    position: absolute;\r\n    top: 0.5rem;\r\n    right: 0.5rem;\r\n  }\r\n\r\n  .trick-or-treat-container {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    z-index: 10;\r\n  }\r\n\r\n  .trick-or-treat-button {\r\n    font-family: 'Underdog', sans-serif;\r\n    font-size: 2rem;\r\n    padding: 1.5rem 3rem;\r\n    background: linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%);\r\n    color: white;\r\n    border: 4px solid #fff;\r\n    border-radius: 2rem;\r\n    cursor: pointer;\r\n    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);\r\n    transition: all 0.2s ease;\r\n    animation: pulse 1.5s ease-in-out infinite;\r\n\r\n    &:hover {\r\n      transform: scale(1.05);\r\n      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4);\r\n    }\r\n\r\n    &:active {\r\n      transform: scale(0.95);\r\n    }\r\n  }\r\n\r\n  @keyframes pulse {\r\n    0%, 100% {\r\n      transform: scale(1);\r\n    }\r\n    50% {\r\n      transform: scale(1.05);\r\n    }\r\n  }\r\n\r\n  .arrows {\r\n    position: absolute;\r\n    bottom: 0.5rem;\r\n    right: 0.5rem;\r\n    overflow: hidden;\r\n    z-index: 2;\r\n    .relative {\r\n      position: relative;\r\n      height: 9.5rem;\r\n      width: 14rem;\r\n      .control-spacer {\r\n        position: absolute;\r\n        display: block;\r\n        width: 5rem;\r\n        height: 5rem;\r\n        padding: 0.5rem;\r\n        margin: auto;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        &.up { bottom: auto; }\r\n        &.down { top: auto; }\r\n        &.left { right: auto;  top: auto;}\r\n        &.right { left: auto;  top: auto;}\r\n      }\r\n    }\r\n  }\r\n\r\n    .guide-info {\r\n      position: absolute;\r\n      bottom: 0.5rem;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n      background-color: rgba(64, 64, 138, 0.95);\r\n      padding: 0.75rem 2.5rem;\r\n      border-radius: 1rem;\r\n      z-index: 2;\r\n      white-space: nowrap;\r\n      min-width: fit-content;\r\n\r\n      p {\r\n        margin: 0;\r\n        font-size: 1.25rem;\r\n        color: #ddd;\r\n        text-align: center;\r\n        font-family: 'Stick', sans-serif;\r\n        white-space: nowrap;\r\n      }\r\n    }\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .controls .guide-info {\r\n    bottom: 0.5rem;\r\n    padding: 0.75rem 1rem;\r\n\r\n    p {\r\n      font-size: 1rem;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Controls.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Controls.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Controls.vue?vue&type=template&id=4cb7a02e&scoped=true&\"\nimport script from \"./Controls.vue?vue&type=script&lang=js&\"\nexport * from \"./Controls.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Controls.vue?vue&type=style&index=0&id=4cb7a02e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4cb7a02e\",\n  null\n  \n)\n\ncomponent.options.__file = \"Controls.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"level-select-overlay\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.closeMenu($event)}}},[_c('div',{staticClass:\"level-select\",on:{\"click\":function($event){$event.stopPropagation();}}},[_c('h1',[_vm._v(\"🎃 Trick or Treat 🍬\")]),_c('div',{staticClass:\"close\"},[_c('button',{staticClass:\"control\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.closeMenu($event)},\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.closeMenu($event)}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 32 32\"}},[_c('path',{attrs:{\"d\":\"M25.749,21.72c-1.507-1.994-3.014-3.988-4.521-5.982 c0.666-0.794,1.331-1.588,1.997-2.382c1.294-1.544,2.674-3.404,2.246-5.372c-0.059-0.272-0.159-0.548-0.359-0.742 c-0.704-0.687-1.457-1.33-2.444-1.6c-0.167-0.046-0.34-0.088-0.511-0.058c-0.21,0.037-0.384,0.179-0.547,0.317 c-1.615,1.374-3.072,2.924-4.396,4.58c-0.967-1.217-1.977-2.4-3.11-3.467c-0.741-0.697-1.936-2.02-2.955-2.275 C9.874,4.419,8.777,5.666,8.209,6.622c-0.866,1.456-1.339,2.4-0.244,3.887c1.41,1.915,2.838,3.824,4.308,5.696 c-2.26,2.054-4.247,4.387-6.227,6.712c-0.101,0.119-0.207,0.25-0.215,0.405c-0.01,0.196,0.138,0.361,0.278,0.5 c1.071,1.065,2.232,2.04,3.466,2.911c0.356,0.251,0.734,0.501,1.165,0.563c1.225,0.178,2.079-1.117,2.759-2.151 c0.577-0.877,1.253-1.684,1.928-2.489c0.386-0.461,0.772-0.921,1.158-1.382c0.795,0.852,1.596,1.698,2.447,2.497 c0.91,0.855,1.865,1.686,2.549,2.731c0.115,0.176,0.23,0.365,0.414,0.468c0.253,0.141,0.569,0.082,0.841-0.017 c1.515-0.552,2.411-2.089,3.1-3.547c0.128-0.27,0.256-0.557,0.228-0.855C26.135,22.239,25.939,21.97,25.749,21.72z\"}})])])]),_c('div',{staticClass:\"controls\"},[_c('div',{staticClass:\"directions-section\"},[_c('h3',[_vm._v(\"方向の伝え方\")]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'gostraight.png',\"alt\":\"Go straight\"}}),_vm._m(0)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'gostraightlittle.png',\"alt\":\"Go straight a little\"}}),_vm._m(1)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'turnright.png',\"alt\":\"Turn right\"}}),_vm._m(2)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'turnleft.png',\"alt\":\"Turn left\"}}),_vm._m(3)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'seeleft.png',\"alt\":\"See left\"}}),_vm._m(4)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'seeright.png',\"alt\":\"See right\"}}),_vm._m(5)])]),_c('button',{staticClass:\"control quit-btn\",attrs:{\"type\":\"button\"},on:{\"mousedown\":_vm.quitGame,\"touchstart\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.quitGame($event)}}},[_vm._v(\"Quit Game\")])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_vm._v(\"Go straight for \"),_c('strong',[_vm._v(\"〇 block(s)\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_vm._v(\"Go straight for \"),_c('strong',[_vm._v(\"a little bit\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_c('strong',[_vm._v(\"Turn right\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_c('strong',[_vm._v(\"Turn left\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_vm._v(\"You can see it on your \"),_c('strong',[_vm._v(\"left\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_vm._v(\"You can see it on your \"),_c('strong',[_vm._v(\"right\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"level-select-overlay\" @click.stop.prevent=\"closeMenu\">\r\n    <div class=\"level-select\" @click.stop>\r\n      <h1>🎃 Trick or Treat 🍬</h1>\r\n      <div class=\"close\">\r\n        <button\r\n          class=\"control\"\r\n          type=\"button\"\r\n          @click.stop.prevent=\"closeMenu\"\r\n          @touchstart.stop.prevent=\"closeMenu\"\r\n        >\r\n          <svg viewBox=\"0 0 32 32\">\r\n            <path d=\"M25.749,21.72c-1.507-1.994-3.014-3.988-4.521-5.982 c0.666-0.794,1.331-1.588,1.997-2.382c1.294-1.544,2.674-3.404,2.246-5.372c-0.059-0.272-0.159-0.548-0.359-0.742 c-0.704-0.687-1.457-1.33-2.444-1.6c-0.167-0.046-0.34-0.088-0.511-0.058c-0.21,0.037-0.384,0.179-0.547,0.317 c-1.615,1.374-3.072,2.924-4.396,4.58c-0.967-1.217-1.977-2.4-3.11-3.467c-0.741-0.697-1.936-2.02-2.955-2.275 C9.874,4.419,8.777,5.666,8.209,6.622c-0.866,1.456-1.339,2.4-0.244,3.887c1.41,1.915,2.838,3.824,4.308,5.696 c-2.26,2.054-4.247,4.387-6.227,6.712c-0.101,0.119-0.207,0.25-0.215,0.405c-0.01,0.196,0.138,0.361,0.278,0.5 c1.071,1.065,2.232,2.04,3.466,2.911c0.356,0.251,0.734,0.501,1.165,0.563c1.225,0.178,2.079-1.117,2.759-2.151 c0.577-0.877,1.253-1.684,1.928-2.489c0.386-0.461,0.772-0.921,1.158-1.382c0.795,0.852,1.596,1.698,2.447,2.497 c0.91,0.855,1.865,1.686,2.549,2.731c0.115,0.176,0.23,0.365,0.414,0.468c0.253,0.141,0.569,0.082,0.841-0.017 c1.515-0.552,2.411-2.089,3.1-3.547c0.128-0.27,0.256-0.557,0.228-0.855C26.135,22.239,25.939,21.97,25.749,21.72z\" />\r\n          </svg>\r\n        </button>\r\n      </div>\r\n      <div class=\"controls\">\r\n      <div class=\"directions-section\">\r\n        <h3>方向の伝え方</h3>\r\n        <div class=\"direction-item\">\r\n          <img :src=\"baseUrl + 'gostraight.png'\" alt=\"Go straight\" class=\"icon\" />\r\n          <span class=\"text\">Go straight for <strong>〇 block(s)</strong></span>\r\n        </div>\r\n        <div class=\"direction-item\">\r\n          <img :src=\"baseUrl + 'gostraightlittle.png'\" alt=\"Go straight a little\" class=\"icon\" />\r\n          <span class=\"text\">Go straight for <strong>a little bit</strong></span>\r\n        </div>\r\n        <div class=\"direction-item\">\r\n          <img :src=\"baseUrl + 'turnright.png'\" alt=\"Turn right\" class=\"icon\" />\r\n          <span class=\"text\"><strong>Turn right</strong></span>\r\n        </div>\r\n        <div class=\"direction-item\">\r\n          <img :src=\"baseUrl + 'turnleft.png'\" alt=\"Turn left\" class=\"icon\" />\r\n          <span class=\"text\"><strong>Turn left</strong></span>\r\n        </div>\r\n        <div class=\"direction-item\">\r\n          <img :src=\"baseUrl + 'seeleft.png'\" alt=\"See left\" class=\"icon\" />\r\n          <span class=\"text\">You can see it on your <strong>left</strong></span>\r\n        </div>\r\n        <div class=\"direction-item\">\r\n          <img :src=\"baseUrl + 'seeright.png'\" alt=\"See right\" class=\"icon\" />\r\n          <span class=\"text\">You can see it on your <strong>right</strong></span>\r\n        </div>\r\n      </div>\r\n      <button\r\n        class=\"control quit-btn\"\r\n        type=\"button\"\r\n        @mousedown=\"quitGame\"\r\n        @touchstart.prevent.stop=\"quitGame\"\r\n      >Quit Game</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  computed: {\r\n    baseUrl () {\r\n      return process.env.BASE_URL\r\n    }\r\n  },\r\n  methods: {\r\n    closeMenu (event) {\r\n      if (event) {\r\n        event.stopPropagation()\r\n        event.preventDefault()\r\n      }\r\n      this.$store.dispatch('mode', this.$store.getters.modePrevious)\r\n    },\r\n    quitGame () {\r\n      // Reset to lobby\r\n      this.$store.dispatch('resetMultiplayer')\r\n      this.$store.dispatch('mode', 'lobby')\r\n      this.$store.dispatch('modePrevious', 'lobby')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.level-select-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  z-index: 1000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.level-select {\r\n  position: relative;\r\n  width: 90%;\r\n  max-width: 30rem;\r\n  padding: 1.5rem;\r\n  box-sizing: border-box;\r\n  background-color: rgba(56, 36, 64, 0.95);\r\n  border-radius: 1rem;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  \r\n  h1{\r\n    text-align: center;\r\n    padding: 0;\r\n    margin: 0 0 1rem 0;\r\n    line-height: 1.5;\r\n    font-size: 1.75rem;\r\n    flex-shrink: 0;\r\n    width: 100%;\r\n  }\r\n  .close {\r\n    position: absolute;\r\n    top: 1rem;\r\n    right: 1rem;\r\n    .control {\r\n      line-height: 2rem;\r\n      font-size: 1.5rem;\r\n      width: 2rem;\r\n      height: 2rem;\r\n      border-radius: 0.25rem;\r\n    }\r\n  }\r\n  .controls {\r\n    position: relative;\r\n    width: 100%;\r\n    margin: 0;\r\n    padding: 0;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n  }\r\n  .directions-section {\r\n    margin-bottom: 1rem;\r\n    padding: 1rem;\r\n    background-color: rgba(64, 64, 138, 0.3);\r\n    border-radius: 0.5rem;\r\n    width: 100%;\r\n\r\n    h3 {\r\n      margin: 0 0 0.75rem 0;\r\n      font-size: 1.4rem;\r\n      color: #fa0;\r\n      font-family: 'Stick', sans-serif;\r\n      text-align: center;\r\n    }\r\n\r\n    .direction-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 0.75rem;\r\n      padding: 0.5rem;\r\n      margin: 0.3rem 0;\r\n      font-size: 1.1rem;\r\n      color: #ddd;\r\n      font-family: 'Underdog', sans-serif;\r\n\r\n      .icon {\r\n        width: 2rem;\r\n        height: 2rem;\r\n        flex-shrink: 0;\r\n        object-fit: contain;\r\n      }\r\n\r\n      .text {\r\n        line-height: 1.3;\r\n\r\n        strong {\r\n          color: #fa0;\r\n          font-weight: normal;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .quit-btn {\r\n    width: 100%;\r\n    max-width: 20rem;\r\n    font-size: 1.5rem;\r\n    background-color: #8b1538;\r\n    color: white;\r\n    margin: 1rem auto 0;\r\n    display: block;\r\n    flex-shrink: 0;\r\n\r\n    &:hover {\r\n      background-color: #a01a42;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LevelSelect.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LevelSelect.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LevelSelect.vue?vue&type=template&id=759747e6&scoped=true&\"\nimport script from \"./LevelSelect.vue?vue&type=script&lang=js&\"\nexport * from \"./LevelSelect.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LevelSelect.vue?vue&type=style&index=0&id=759747e6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"759747e6\",\n  null\n  \n)\n\ncomponent.options.__file = \"LevelSelect.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"level-win\"},[_c('h1',[_vm._v(_vm._s(_vm.winTitle))]),_c('score'),(_vm.isMultiplayer)?_c('div',{staticClass:\"multiplayer-info\"},[_c('p',{staticClass:\"role-message\"},[_vm._v(_vm._s(_vm.roleMessage))]),(!_vm.bothPlayersReady)?_c('p',{staticClass:\"waiting-text\"},[_vm._v(\"Waiting for other player...\")]):_c('p',{staticClass:\"ready-text\"},[_vm._v(\"Both players ready! Switching roles...\")])]):_vm._e(),_c('div',{staticClass:\"controls\"},[(!_vm.isMultiplayer)?_c('button',{staticClass:\"control options\",attrs:{\"type\":\"button\"},on:{\"mousedown\":function($event){_vm.$store.dispatch('startLevel', _vm.$store.getters.currentLevel)},\"touchstart\":function($event){$event.preventDefault();$event.stopPropagation();_vm.$store.dispatch('startLevel', _vm.$store.getters.currentLevel)}}},[_vm._v(\"Replay\")]):_vm._e(),(!_vm.isMultiplayer)?_c('button',{staticClass:\"control options\",attrs:{\"type\":\"button\"},on:{\"mousedown\":function($event){_vm.$store.dispatch('nextLevel')},\"touchstart\":function($event){$event.preventDefault();$event.stopPropagation();_vm.$store.dispatch('nextLevel')}}},[_vm._v(\"Next Level\")]):_vm._e(),(_vm.isMultiplayer && !_vm.isReady)?_c('button',{staticClass:\"control options\",attrs:{\"type\":\"button\"},on:{\"mousedown\":_vm.markReady,\"touchstart\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.markReady($event)}}},[_vm._v(\"Ready for Next Round\")]):_vm._e()])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"level-win\">\n    <h1>{{ winTitle }}</h1>\n    <score />\n\n    <!-- Multiplayer role switch info -->\n    <div v-if=\"isMultiplayer\" class=\"multiplayer-info\">\n      <p class=\"role-message\">{{ roleMessage }}</p>\n      <p v-if=\"!bothPlayersReady\" class=\"waiting-text\">Waiting for other player...</p>\n      <p v-else class=\"ready-text\">Both players ready! Switching roles...</p>\n    </div>\n\n    <div class=\"controls\">\n      <button\n        v-if=\"!isMultiplayer\"\n        class=\"control options\"\n        type=\"button\"\n        @mousedown=\"$store.dispatch('startLevel', $store.getters.currentLevel)\"\n        @touchstart.prevent.stop=\"$store.dispatch('startLevel', $store.getters.currentLevel)\"\n      >Replay</button>\n      <button\n        v-if=\"!isMultiplayer\"\n        class=\"control options\"\n        type=\"button\"\n        @mousedown=\"$store.dispatch('nextLevel')\"\n        @touchstart.prevent.stop=\"$store.dispatch('nextLevel')\"\n      >Next Level</button>\n\n      <!-- Multiplayer ready button -->\n      <button\n        v-if=\"isMultiplayer && !isReady\"\n        class=\"control options\"\n        type=\"button\"\n        @mousedown=\"markReady\"\n        @touchstart.prevent.stop=\"markReady\"\n      >Ready for Next Round</button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport Score from './Score'\n\nexport default {\n  components: {\n    Score\n  },\n  data () {\n    return {\n      isReady: false\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'isMultiplayer',\n      'playerRole',\n      'isPlayer',\n      'isGuide',\n      'roomData'\n    ]),\n    winTitle () {\n      if (this.isMultiplayer) {\n        return this.isPlayer ? 'Level Complete!' : 'Player Won!'\n      }\n      return 'You Win!'\n    },\n    roleMessage () {\n      if (this.isPlayer) {\n        return 'Next round, you will be the Guide'\n      } else {\n        return 'Next round, you will be the Player'\n      }\n    },\n    bothPlayersReady () {\n      if (!this.roomData || !this.roomData.gameState) return false\n      return this.roomData.gameState.player1Ready && this.roomData.gameState.player2Ready\n    }\n  },\n  methods: {\n    async markReady () {\n      this.isReady = true\n      await this.$store.dispatch('switchRolesAndContinue')\n    }\n  },\n  watch: {\n    bothPlayersReady (newVal) {\n      if (newVal) {\n        // Both players are ready, roles will switch automatically\n        setTimeout(() => {\n          this.isReady = false\n        }, 1000)\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.level-win {\n  position: absolute;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 20rem;\n  min-height: 23rem;\n  margin: auto;\n  background-color: #382440;\n  border-radius: 1rem;\n  padding: 1rem;\n\n  h1{\n    padding: 0 1rem;\n    margin: 0;\n    line-height: 4rem;\n    font-size: 2.5rem;\n  }\n\n  .multiplayer-info {\n    padding: 1rem;\n    margin: 1rem 0;\n\n    .role-message {\n      font-size: 1.25rem;\n      color: #fa0;\n      margin: 0.5rem 0;\n    }\n\n    .waiting-text {\n      font-size: 1rem;\n      color: #ccc;\n      margin: 0.5rem 0;\n      animation: pulse 1.5s ease-in-out infinite;\n    }\n\n    .ready-text {\n      font-size: 1rem;\n      color: #4caf50;\n      margin: 0.5rem 0;\n      font-weight: bold;\n    }\n  }\n\n  .close {\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    .control {\n      line-height: 2rem;\n      font-size: 1.5rem;\n      width: 2rem;\n      height: 2rem;\n      border-radius: 0.25rem;\n    }\n  }\n  .controls {\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: 2rem;\n    width: 18rem;\n    margin: auto;\n  }\n  .options {\n    width: 16rem;\n    font-size: 1.5rem;\n    margin: 0.5rem auto;\n  }\n}\n\n@keyframes pulse {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LevelWin.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LevelWin.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LevelWin.vue?vue&type=template&id=f31832a2&scoped=true&\"\nimport script from \"./LevelWin.vue?vue&type=script&lang=js&\"\nexport * from \"./LevelWin.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LevelWin.vue?vue&type=style&index=0&id=f31832a2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f31832a2\",\n  null\n  \n)\n\ncomponent.options.__file = \"LevelWin.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"game-three\",class:{ 'play-mode': _vm.mode === 'play' || _vm.mode === 'characterSelect' }},[_c('div',{staticClass:\"has-to-be-here-for-reactivity\"},[_c('pre',[_vm._v(\"Mode: \"+_vm._s(_vm.mode)+\"\\nCharacter: \"+_vm._s(_vm.character)+\"\\nScore: \"+_vm._s(_vm.score)+\"\\nMoves: \"+_vm._s(_vm.moves)+\"\\nFacing: \"+_vm._s(_vm.facing)+\"\\n\"+_vm._s(_vm.map)+\"\\n      \")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"game-three\" :class=\"{ 'play-mode': mode === 'play' || mode === 'characterSelect' }\">\r\n    <div class=\"has-to-be-here-for-reactivity\">\r\n      <pre>\r\nMode: {{mode}}\r\nCharacter: {{character}}\r\nScore: {{score}}\r\nMoves: {{moves}}\r\nFacing: {{facing}}\r\n{{map}}\r\n      </pre>\r\n</div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport TWEEN from '@tweenjs/tween.js'\r\nimport * as THREE from 'three'\r\nwindow.THREE = THREE\r\nrequire('three/examples/js/loaders/GLTFLoader')\r\nrequire('three/examples/js/controls/OrbitControls')\r\n\r\nconst gltfLoader = new THREE.GLTFLoader()\r\n\r\nconst prepGLTFPlayer = (gltf) => {\r\n  let lastTime = 0\r\n  gltf.animationNameMap = {}\r\n  gltf.animations.forEach((animation) => {\r\n    gltf.animationNameMap[animation.name] = animation\r\n  })\r\n  gltf.update = (time) => {\r\n    const dt = (time - lastTime) / 1000\r\n    gltf.mixer.update(dt)\r\n    lastTime = time\r\n  }\r\n  gltf.playAnimationByName = (name) => {\r\n    if (gltf.lastAnimation !== name) {\r\n      gltf.mixer = new THREE.AnimationMixer(gltf.scene)\r\n      const clip = gltf.animationNameMap[name]\r\n      let action = gltf.mixer.clipAction(clip)\r\n      action.play()\r\n      gltf.lastAnimation = name\r\n    }\r\n  }\r\n}\r\n\r\nlet gltfAssetMap = {}\r\nlet unpackedObjectMap = {}\r\nconst loadGltfAssets = async (assetList) => {\r\n  let promiseList = []\r\n  assetList.forEach((asset) => {\r\n    if (!gltfAssetMap[asset]) {\r\n      let _resolve\r\n      let _reject\r\n      const promise = new Promise((resolve, reject) => {\r\n        _resolve = resolve\r\n        _reject = reject\r\n      })\r\n      gltfLoader.load(\r\n        `models/${asset}.gltf`,\r\n        (gltf) => {\r\n          gltfAssetMap[asset] = gltf\r\n          prepGLTFPlayer(gltf)\r\n          gltf.scene.children.forEach((item) => {\r\n            unpackedObjectMap[item.name] = item\r\n          })\r\n          _resolve(gltf)\r\n        },\r\n        undefined,\r\n        _reject\r\n      )\r\n      promiseList.push(promise)\r\n    }\r\n  })\r\n  await Promise.all(promiseList)\r\n  return gltfAssetMap\r\n}\r\n\r\nconst renderer = new THREE.WebGLRenderer({\r\n  alpha: true,\r\n  antialias: true\r\n})\r\nconst camera = new THREE.PerspectiveCamera(\r\n  45,\r\n  window.innerWidth / window.innerHeight,\r\n  0.1,\r\n  10000\r\n)\r\nconst scene = new THREE.Scene()\r\nconst group = new THREE.Group()\r\nscene.add(group)\r\n\r\nconst directionalLight = new THREE.DirectionalLight(0xffffff, 0.5)\r\ndirectionalLight.position.set(-2, 2, 2)\r\ndirectionalLight.castShadow = true\r\nscene.add(directionalLight)\r\n\r\nconst directionalLight2 = new THREE.DirectionalLight(0xffffff, 1.0)\r\ndirectionalLight2.position.set(1, 2, 1)\r\ndirectionalLight2.castShadow = true\r\nscene.add(directionalLight2)\r\n\r\nconst ambientLight = new THREE.AmbientLight(0xffffff, 2)\r\nscene.add(ambientLight)\r\n\r\nconst light = new THREE.HemisphereLight(0xcefeff, 0xb3eaf0, 0.5)\r\nscene.add(light)\r\n\r\n// Fog will be adjusted based on player role\r\nlet fog = new THREE.Fog('#5d3758', 9, 12)\r\nscene.fog = fog\r\n\r\nconst deg45 = Math.PI / 4\r\nconst directionMap = {\r\n  X: -deg45 * 4,\r\n  Z: -deg45 * 6,\r\n  A: -deg45 * 6,\r\n  Q: 0,\r\n  W: 0,\r\n  E: -deg45 * 2,\r\n  D: -deg45 * 2,\r\n  C: -deg45 * 4,\r\n  'S': 0,\r\n  ' ': 0,\r\n  '┃': 0,\r\n  '━': -deg45 * 2,\r\n  '┓': -deg45 * 4,\r\n  '┛': -deg45 * 6,\r\n  '┗': 0,\r\n  '┏': -deg45 * 2,\r\n  ',': -deg45 * 2,\r\n  '┻': 0,\r\n  '┣': -deg45 * 2,\r\n  '┳': -deg45 * 4,\r\n  '┫': -deg45 * 6,\r\n  '╋': 0,\r\n  '╻': -deg45 * 4,\r\n  '╹': 0,\r\n  '╺': -deg45 * 2,\r\n  '╸': -deg45 * 6,\r\n  'P': 0,\r\n  'up': -deg45 * 2,\r\n  'down': -deg45 * 6,\r\n  'left': 0,\r\n  'right': -deg45 * 4\r\n}\r\nconst charModelMap = {\r\n  'G': 'ghost',\r\n  'Q': 'house_corner',\r\n  'W': 'house',\r\n  'E': 'house_corner',\r\n  'D': 'house',\r\n  'C': 'house_corner',\r\n  'X': 'house',\r\n  'Z': 'house_corner',\r\n  'A': 'house',\r\n  'S': 'road_spawn',\r\n  ' ': 'park',\r\n  '┃': 'road_horizontal',\r\n  '━': 'road_horizontal',\r\n  '┓': 'road_corner',\r\n  '┛': 'road_corner',\r\n  '┗': 'road_corner',\r\n  '┏': 'road_corner',\r\n  ',': 'start',\r\n  '┻': 'road_tee',\r\n  '┣': 'road_tee',\r\n  '┳': 'road_tee',\r\n  '┫': 'road_tee',\r\n  '╋': 'road_plus',\r\n  '╻': 'road_end',\r\n  '╹': 'road_end',\r\n  '╺': 'road_end',\r\n  '╸': 'road_end',\r\n  'P': 'park',\r\n  'H': 'house'\r\n}\r\nconst houses = [\r\n  'house_a',\r\n  'house_b',\r\n  'house_c'\r\n]\r\nconst getHouseRandom = () => {\r\n  const index = Math.floor(houses.length * Math.random())\r\n  return houses[index]\r\n}\r\n\r\nconst levelHolder = new THREE.Object3D()\r\nlevelHolder.rotation.x = -deg45 * 2\r\n\r\nlet lastLevel = null\r\nlet itemLevelMap = {}\r\nlet player = new THREE.Object3D()\r\nlet playerTweenQueue = []\r\nlet rotationTween = null\r\nlet facingArrow = null\r\nconst playerTweenOnComplete = () => {\r\n  playerTweenQueue.shift()\r\n  const nextTween = playerTweenQueue[0]\r\n  if (nextTween) {\r\n    nextTween.start()\r\n  }\r\n}\r\n\r\nconst createFacingArrow = () => {\r\n  if (facingArrow) {\r\n    player.remove(facingArrow)\r\n  }\r\n  \r\n  // Create arrow geometry\r\n  const arrowGeometry = new THREE.ConeGeometry(0.3, 0.8, 8)\r\n  const arrowMaterial = new THREE.MeshBasicMaterial({ \r\n    color: 0x00ff00,  // Bright green\r\n    transparent: true,\r\n    opacity: 0.8,\r\n    depthTest: false,  // Disable depth testing so arrow always renders on top\r\n    depthWrite: false  // Don't write to depth buffer\r\n  })\r\n  \r\n  facingArrow = new THREE.Mesh(arrowGeometry, arrowMaterial)\r\n  \r\n  // Scale arrow down a bit\r\n  facingArrow.scale.setScalar(0.7)\r\n  \r\n  // Set high render order so arrow renders on top of other objects\r\n  facingArrow.renderOrder = 1000\r\n  \r\n  // Default: cone points along +z axis (upward)\r\n  // Since arrow is positioned correctly and is a child of player:\r\n  // - player.rotation.z rotates the arrow position\r\n  // - We need to orient the cone to point forward relative to its position\r\n  // If arrow points left when it should point forward, rotate around z-axis by -90° (or +90°)\r\n  // rotation.y affects pointing at camera (vertical), rotation.z affects left/right alignment\r\n  facingArrow.rotation.x = -Math.PI / 2  // Point along -z (downward) so it's visible from top\r\n  facingArrow.rotation.y = 0\r\n  facingArrow.rotation.z = -Math.PI / 2  // Rotate to point forward instead of left\r\n  \r\n  // Position arrow immediately with default position (same as updateFacingArrow uses)\r\n  // This ensures it appears correctly from the start, not directly under the player\r\n  facingArrow.position.set(1, 0, 0)\r\n  \r\n  player.add(facingArrow)\r\n}\r\n\r\nconst updateFacingArrow = (facing) => {\r\n  if (!facingArrow) {\r\n    createFacingArrow()\r\n  }\r\n  \r\n  // Analysis of coordinate system:\r\n  // When positioned at (-1.2, 0, 0): arrow appears on player's LEFT\r\n  // When positioned at (0, -1.2, 0): arrow appears on player's RIGHT\r\n  // This means:\r\n  //   - Negative x = left side\r\n  //   - Negative y = right side\r\n  //   - Therefore: Positive x or positive y should be FRONT\r\n  // \r\n  // Testing positive x as front:\r\n  //   - If negative x is left, positive x should be right (not front)\r\n  //   - But wait: negative y is right, so that conflicts\r\n  // \r\n  // Actually, if the player model has a built-in 90° rotation:\r\n  //   - The player's local forward might be at a diagonal\r\n  //   - OR the axes might be: x = left/right, y = forward/back, z = up/down\r\n  //   \r\n  // Since (-1.2, 0, 0) = left and (0, -1.2, 0) = right:\r\n  //   - These are 90° apart, suggesting the axes are rotated\r\n  //   - If negative x is left and negative y is right, then they're diagonal\r\n  //   - Front should be positive x (which would be opposite of negative x = left)\r\n  //   - OR front could be positive y (which would be opposite of negative y = right)\r\n  //\r\n  // Based on typical game coordinate systems and the fact that negative x was left:\r\n  // Let's try positive x as front - (1.2, 0, 0)\r\n  facingArrow.position.set(1, 0, 0)\r\n  \r\n  // Rotation should match the createFacingArrow initialization\r\n  // rotation.x = -PI/2 points cone downward (visible from top-down view)\r\n  // rotation.z = -PI/2 rotates it from pointing left to pointing forward\r\n  facingArrow.rotation.x = -Math.PI / 2\r\n  facingArrow.rotation.y = 0\r\n  facingArrow.rotation.z = -Math.PI / 2\r\n}\r\n\r\nconst animatePlayerRotation = (targetRotation) => {\r\n  // Cancel existing rotation tween if any\r\n  if (rotationTween) {\r\n    rotationTween.stop()\r\n  }\r\n\r\n  // Calculate the shortest rotation path\r\n  const currentRotation = player.rotation.z\r\n  const twoPi = Math.PI * 2\r\n\r\n  // Normalize both angles to [0, 2π)\r\n  let normalizedCurrent = ((currentRotation % twoPi) + twoPi) % twoPi\r\n  let normalizedTarget = ((targetRotation % twoPi) + twoPi) % twoPi\r\n\r\n  // Calculate the difference\r\n  let diff = normalizedTarget - normalizedCurrent\r\n\r\n  // Find shortest path\r\n  if (diff > Math.PI) {\r\n    diff -= twoPi\r\n  } else if (diff < -Math.PI) {\r\n    diff += twoPi\r\n  }\r\n\r\n  // Target is current + shortest difference\r\n  const shortestTarget = currentRotation + diff\r\n\r\n  // Create smooth rotation animation\r\n  rotationTween = new TWEEN.Tween(player.rotation)\r\n    .to({ z: shortestTarget }, 200)\r\n    .easing(TWEEN.Easing.Quadratic.Out)\r\n    .start()\r\n}\r\n\r\nlet characterMountA = new THREE.Object3D()\r\nlet characterMountB = new THREE.Object3D()\r\ncharacterMountA.scale.setScalar(2.5)\r\ncharacterMountB.scale.setScalar(2.5)\r\ncharacterMountA.position.set(1, -0.65, 0)\r\ncharacterMountB.position.set(-1, -0.55, 0)\r\ncharacterMountA.rotation.set(Math.PI / 2, Math.PI, -Math.PI / 2)\r\ncharacterMountB.rotation.set(Math.PI / 2, Math.PI, -Math.PI / 2)\r\n\r\nconst changeSceneMode = (mode, character, isGuide = false) => {\r\n  // Guard: assets and controls may not be ready yet\r\n  if (!controls || !camera || !scene || !levelHolder) {\r\n    return\r\n  }\r\n  if (mode === 'characterSelect') {\r\n    scene.remove(levelHolder)\r\n    scene.add(characterMountA)\r\n    scene.add(characterMountB)\r\n    if (unpackedObjectMap.ghost_root && unpackedObjectMap.alien_root) {\r\n      unpackedObjectMap.ghost_root.position.set(0, 0, 0)\r\n      unpackedObjectMap.alien_root.position.set(0, 0, 0)\r\n      characterMountA.add(unpackedObjectMap.ghost_root)\r\n      characterMountB.add(unpackedObjectMap.alien_root)\r\n    }\r\n    camera.position.set(0, 0, -5)\r\n    camera.lookAt(new THREE.Vector3(0, 0, 0))\r\n    if (controls && controls.update) controls.update()\r\n    return\r\n  }\r\n  if (mode === 'lobby' || mode === 'levelSelect' || mode === 'levelWin') {\r\n    // Hide game scene when in menu/lobby modes\r\n    scene.remove(levelHolder)\r\n    scene.remove(characterMountA)\r\n    scene.remove(characterMountB)\r\n    // Hide facing arrow if it exists\r\n    if (facingArrow) {\r\n      facingArrow.visible = false\r\n    }\r\n    return\r\n  }\r\n  if (mode === 'play') {\r\n    scene.add(levelHolder)\r\n    scene.remove(characterMountA)\r\n    scene.remove(characterMountB)\r\n    if (character) {\r\n      changeCharacter(character)\r\n    }\r\n    \r\n    // Show/hide facing arrow based on role\r\n    if (facingArrow) {\r\n      facingArrow.visible = isGuide\r\n    }\r\n\r\n    // Different camera angles for player vs guide\r\n    if (isGuide) {\r\n      // Bird's eye view for guide - pure top-down\r\n      // First, un-rotate the level so it's flat\r\n      levelHolder.rotation.x = 0\r\n      // Position camera directly above\r\n      camera.position.set(0, 18, 0)\r\n      camera.lookAt(new THREE.Vector3(0, 0, 0))\r\n      // Lock camera to top-down view\r\n      controls.minPolarAngle = Math.PI / 2\r\n      controls.maxPolarAngle = Math.PI / 2\r\n      controls.minAzimuthAngle = -Infinity\r\n      controls.maxAzimuthAngle = Infinity\r\n      controls.minDistance = 10\r\n      controls.maxDistance = 30\r\n      // Guide: pan-only, disable rotation\r\n      controls.enableRotate = false\r\n      controls.enableZoom = true\r\n      controls.enablePan = true\r\n      // Prefer pan on left button (support older OrbitControls API)\r\n      const MOUSE = (THREE && THREE.MOUSE) ? THREE.MOUSE : { LEFT: 0, MIDDLE: 1, RIGHT: 2 }\r\n      if (controls.mouseButtons) {\r\n        if ('ORBIT' in controls.mouseButtons && 'PAN' in controls.mouseButtons) {\r\n          controls.mouseButtons.ORBIT = MOUSE.RIGHT\r\n          controls.mouseButtons.PAN = MOUSE.LEFT\r\n          if ('ZOOM' in controls.mouseButtons) controls.mouseButtons.ZOOM = MOUSE.MIDDLE\r\n        }\r\n      }\r\n      // Remove fog for guide so they can see entire map\r\n      scene.fog = null\r\n    } else {\r\n      // Regular player view - restore tilted perspective\r\n      levelHolder.rotation.x = -deg45 * 2\r\n      camera.position.set(-1, 6, -5)\r\n      camera.lookAt(new THREE.Vector3(0, 0, 0))\r\n      controls.minPolarAngle = -Infinity\r\n      controls.maxPolarAngle = Math.PI / 2\r\n      controls.minAzimuthAngle = -Infinity\r\n      controls.maxAzimuthAngle = Infinity\r\n      controls.minDistance = 1\r\n      controls.maxDistance = 10\r\n      controls.enableRotate = true\r\n      controls.enableZoom = true\r\n      controls.enablePan = false\r\n      // Restore fog for player\r\n      scene.fog = new THREE.Fog('#5d3758', 9, 12)\r\n    }\r\n    if (controls && controls.update) controls.update()\r\n  }\r\n}\r\n\r\nconst changeCharacter = (character) => {\r\n  if (player.children[0]) {\r\n    player.remove(player.children[0])\r\n  }\r\n  const playerAvatar = unpackedObjectMap[`${character}_root`]\r\n  if (!playerAvatar) return\r\n  playerAvatar.position.set(0, 0, 0)\r\n  player.add(playerAvatar)\r\n  \r\n  // Create facing arrow for guide view\r\n  createFacingArrow()\r\n}\r\n\r\nconst mapAsciiStateToThree = ({\r\n  map,\r\n  mapRaw,\r\n  currentLevel,\r\n  facing,\r\n  candyHouseIndex,\r\n  isGuide\r\n}) => {\r\n  if (lastLevel !== currentLevel) {\r\n    const lastItemHolder = itemLevelMap[lastLevel]\r\n    if (lastItemHolder) {\r\n      levelHolder.remove(lastItemHolder)\r\n    }\r\n    lastLevel = currentLevel\r\n  }\r\n  let itemHolder = itemLevelMap[currentLevel]\r\n  const xMax = map.indexOf('\\n', 1) - 1\r\n  const yMax = (map.match(/\\n/g) || []).length - 1\r\n  const xOffset = (-xMax / 2) + 0.5\r\n  const yOffset = (-yMax / 2)\r\n  // const largestAxis = Math.max(xMax, yMax)\r\n  // const scale = (1 / largestAxis) * 5\r\n  // levelHolder.scale.setScalar(scale)\r\n  if (!itemHolder) {\r\n    let chars = [...mapRaw]\r\n    itemHolder = itemLevelMap[currentLevel] = new THREE.Object3D()\r\n    let tileIndex = 0 // Track actual tile position (non-newline chars)\r\n    chars.forEach((char, stringIndex) => {\r\n      if (char === '\\n') {\r\n        // Skip newlines, don't create items for them\r\n        const item = new THREE.Object3D()\r\n        itemHolder.add(item)\r\n        return\r\n      }\r\n      const y = Math.floor(tileIndex / xMax)\r\n      const x = tileIndex % xMax\r\n      let item = itemHolder.children[stringIndex]\r\n      if (!item) {\r\n        const charUpper = char.toLocaleUpperCase()\r\n        let modelName = charModelMap[charUpper] || 'road_spawn'\r\n        if (modelName === 'house') {\r\n          modelName = getHouseRandom()\r\n        }\r\n        const rotation = directionMap[charUpper] || 0\r\n        item = unpackedObjectMap[modelName].clone()\r\n        item.name = modelName // Explicitly set the name\r\n        item.position.x = -(x + xOffset)\r\n        item.position.y = (y + yOffset)\r\n        item.rotation.z = rotation\r\n        if (modelName.indexOf('house') === 0) {\r\n          // Only add candy to the ONE selected house\r\n          // candyHouseIndex is the actual index in state.map string (includes newlines)\r\n          if (stringIndex === candyHouseIndex) {\r\n            const candy = unpackedObjectMap.candy_circle.clone()\r\n            // Candy only visible to guide, not player\r\n            candy.visible = isGuide\r\n            candy.name = 'candy_circle'\r\n            item.add(candy)\r\n          }\r\n        }\r\n        itemHolder.add(item)\r\n      }\r\n      tileIndex++\r\n    })\r\n  }\r\n  itemHolder.add(player)\r\n  let chars = [...map]\r\n  if (chars.length && chars[0] === '\\n') {\r\n    // Keep the string indices aligned with placement (which used mapRaw string indices)\r\n    // Do NOT shift here; iterate using actual string indices\r\n  }\r\n  // Compute player position from the actual string index in the map (includes newlines)\r\n  const gStringIndex = map.indexOf('G')\r\n  if (gStringIndex >= 0) {\r\n    const tileOffset = gStringIndex - 1 // subtract leading newline\r\n    const y = Math.floor(tileOffset / (xMax + 1))\r\n    const x = tileOffset - y * (xMax + 1)\r\n    const rotation = directionMap[facing] || 0\r\n    const tween = new TWEEN.Tween(player.position)\r\n      .to(\r\n        {\r\n          x: -(x + xOffset),\r\n          y: y + yOffset\r\n        },\r\n        100\r\n      )\r\n      .easing(TWEEN.Easing.Quadratic.Out)\r\n      .onUpdate(() => {\r\n        // Do not auto-follow for guide\r\n        if (!isGuide) {\r\n          itemHolder.position.x = -player.position.x\r\n          itemHolder.position.y = -player.position.y\r\n        }\r\n      })\r\n      .onComplete(playerTweenOnComplete)\r\n    playerTweenQueue.push(tween)\r\n    if (playerTweenQueue.length < 2) {\r\n      tween.start()\r\n    }\r\n    animatePlayerRotation(rotation)\r\n    \r\n    // Update facing arrow for guide view\r\n    updateFacingArrow(facing)\r\n  }\r\n\r\n  // Update candy visibility and placement\r\n  for (let s = 0; s < map.length; s++) {\r\n    const ch = map.charAt(s)\r\n    if (ch === '\\n') continue\r\n    let item = itemHolder.children[s]\r\n    if (!item) continue\r\n    if (item.name && item.name.indexOf('house') === 0) {\r\n      // Check if this house should have candy\r\n      const shouldHaveCandy = (s === candyHouseIndex)\r\n      const hasCandy = item.children.length > 0 && item.children[0].name === 'candy_circle'\r\n      \r\n      if (shouldHaveCandy && !hasCandy) {\r\n        // Add candy to this house\r\n        console.log('🍭 Adding candy to house at index', s, 'isGuide:', isGuide)\r\n        const candy = unpackedObjectMap.candy_circle.clone()\r\n        candy.visible = isGuide\r\n        candy.name = 'candy_circle'\r\n        item.add(candy)\r\n      } else if (!shouldHaveCandy && hasCandy) {\r\n        // Remove candy from this house\r\n        console.log('🗑️ Removing candy from house at index', s)\r\n        item.remove(item.children[0])\r\n      } else if (hasCandy) {\r\n        // Update visibility based on whether house has been visited\r\n        const show = ch === ch.toLocaleUpperCase()\r\n        item.children[0].visible = show && isGuide\r\n      }\r\n    }\r\n  }\r\n  \r\n  levelHolder.add(itemHolder)\r\n}\r\n\r\nrenderer.shadowMap.enabled = true\r\nrenderer.shadowMap.type = THREE.PCFSoftShadowMap\r\nlet width\r\nlet height\r\n// let square\r\nlet center = new THREE.Vector2()\r\nconst deg = Math.PI / 180\r\nconst resize = () => {\r\n  const clientWidth = renderer.domElement.clientWidth\r\n  const clientHeight = renderer.domElement.clientHeight\r\n  const dpr = window.devicePixelRatio\r\n  width = clientWidth * dpr\r\n  height = clientHeight * dpr\r\n  // square = Math.min(width, height)\r\n  if (\r\n    renderer.domElement.width !== width ||\r\n    renderer.domElement.height !== height\r\n  ) {\r\n    const aspect = width / height\r\n    const desiredMinimumFov = deg45\r\n    // this ensures that I always have a 90deg square in the center of both landscape and portrait viewports\r\n    camera.fov = (\r\n      aspect >= 1 ? desiredMinimumFov : 2 * Math.atan(Math.tan(desiredMinimumFov / 2) / aspect)\r\n    ) / deg\r\n    camera.aspect = aspect\r\n    camera.updateProjectionMatrix()\r\n    renderer.setPixelRatio(dpr)\r\n    renderer.setSize(\r\n      clientWidth,\r\n      clientHeight,\r\n      false\r\n    )\r\n    center.set(width / 2, height / 2)\r\n  }\r\n}\r\nlet controls\r\nlet go = true\r\nconst loop = (time) => {\r\n  if (go) {\r\n    requestAnimationFrame(loop)\r\n    resize()\r\n    animate(time)\r\n  }\r\n}\r\nconst start = (parentNode) => {\r\n  parentNode.appendChild(renderer.domElement)\r\n  controls = new THREE.OrbitControls(camera, renderer.domElement)\r\n  camera.position.set(-1, 6, -5)\r\n  camera.lookAt(new THREE.Vector3(0, 0, 0))\r\n  controls.enableDamping = true // an animation loop is required when either damping or auto-rotation are enabled\r\n  controls.dampingFactor = 0.25\r\n  controls.screenSpacePanning = false\r\n  controls.enablePan = false\r\n  controls.minDistance = 1\r\n  controls.maxDistance = 10\r\n  controls.minPolarAngle = -Infinity // Math.PI / 2\r\n  controls.maxPolarAngle = Math.PI / 2\r\n  requestAnimationFrame(loop)\r\n}\r\n\r\nconst animate = (time) => {\r\n  controls.update()\r\n  TWEEN.update(time)\r\n  renderer.render(scene, camera)\r\n}\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      loaded: false,\r\n      lastMap: null\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'mode',\r\n      'character',\r\n      'currentLevel',\r\n      'lastDirection',\r\n      'facing',\r\n      'levels',\r\n      'score',\r\n      'moves',\r\n      'map',\r\n      'candyHouseIndex',\r\n      'isGuide',\r\n      'isPlayer',\r\n      'isMultiplayer',\r\n      'activePlayerCharacter'\r\n    ]),\r\n    // Use activePlayerCharacter in multiplayer, otherwise use character\r\n    displayCharacter () {\r\n      if (this.isMultiplayer) {\r\n        // In multiplayer, use activePlayerCharacter if set, otherwise fall back to own character\r\n        return this.activePlayerCharacter || this.character\r\n      }\r\n      return this.character\r\n    }\r\n  },\r\n  mounted () {\r\n    start(this.$el)\r\n    this.startLoad()\r\n  },\r\n  destroyed () {\r\n    go = false\r\n  },\r\n  beforeUpdate () {\r\n    this.updateState()\r\n  },\r\n  methods: {\r\n    async startLoad () {\r\n      await loadGltfAssets([\r\n        'city',\r\n        'characters'\r\n      ])\r\n      // TODO: Figure out why these aren't working\r\n      // scene.add(gltfAssetMap.characters.scene)\r\n      // gltfAssetMap.characters.playAnimationByName('alien_idle')\r\n      // gltfAssetMap.characters.playAnimationByName('ghost_idle')\r\n\r\n      console.log('Loaded', unpackedObjectMap)\r\n      this.loaded = true\r\n      this.updateState()\r\n      changeSceneMode(this.mode, this.displayCharacter, this.isGuide)\r\n    },\r\n    updateState () {\r\n      if (\r\n        this.map &&\r\n        this.loaded &&\r\n        this.lastMap !== this.map &&\r\n        this.currentLevel !== null\r\n      ) {\r\n        mapAsciiStateToThree({\r\n          map: this.map,\r\n          mapRaw: this.levels[this.currentLevel],\r\n          currentLevel: this.currentLevel,\r\n          facing: this.facing,\r\n          candyHouseIndex: this.candyHouseIndex,\r\n          isGuide: this.isGuide\r\n        })\r\n        this.lastMap = this.map\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    mode () {\r\n      changeSceneMode(this.mode, this.displayCharacter, this.isGuide)\r\n      // Force state update when mode changes to ensure map renders\r\n      if (this.mode === 'play' && this.loaded) {\r\n        this.$nextTick(() => {\r\n          this.updateState()\r\n        })\r\n      }\r\n    },\r\n    currentLevel () {\r\n      this.updateState()\r\n    },\r\n    facing () {\r\n      // Animate rotation when facing changes (even without moving)\r\n      if (this.loaded && this.mode === 'play') {\r\n        const rotation = directionMap[this.facing] || 0\r\n        animatePlayerRotation(rotation)\r\n        \r\n        // Update facing arrow for guide view\r\n        if (this.isGuide) {\r\n          updateFacingArrow(this.facing)\r\n        }\r\n      }\r\n    },\r\n    isGuide () {\r\n      // Update camera when role changes\r\n      if (this.loaded && this.mode === 'play') {\r\n        changeSceneMode(this.mode, this.displayCharacter, this.isGuide)\r\n        \r\n        // Reset camera position for new role\r\n        if (this.isGuide) {\r\n          // Guide: center on map\r\n          if (levelHolder && levelHolder.children[this.currentLevel]) {\r\n            levelHolder.children[this.currentLevel].position.x = 0\r\n            levelHolder.children[this.currentLevel].position.y = 0\r\n          }\r\n          \r\n          // Create and position facing arrow\r\n          if (!facingArrow) {\r\n            createFacingArrow()\r\n          }\r\n          updateFacingArrow(this.facing)\r\n        }\r\n      }\r\n    },\r\n    displayCharacter () {\r\n      // Update character when activePlayerCharacter changes (role switch)\r\n      if (this.loaded && this.mode === 'play') {\r\n        changeCharacter(this.displayCharacter)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.game-three {\r\n  position: absolute;\r\n  z-index: 0;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .has-to-be-here-for-reactivity {\r\n    display: none;\r\n\r\n    pre {\r\n      font-family: monospace;\r\n      font-size: 1.5rem;\r\n      line-height: 1.25rem;\r\n      letter-spacing: 0.25rem;\r\n      text-align: left;\r\n    }\r\n  }\r\n\r\n  canvas {\r\n    display: block;\r\n    position: absolute;\r\n    z-index: 0;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n  \r\n  // Hide canvas when not in play mode\r\n  &:not(.play-mode) canvas {\r\n    opacity: 0;\r\n    pointer-events: none;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GameThree.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GameThree.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GameThree.vue?vue&type=template&id=7999eab7&\"\nimport script from \"./GameThree.vue?vue&type=script&lang=js&\"\nexport * from \"./GameThree.vue?vue&type=script&lang=js&\"\nimport style0 from \"./GameThree.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"GameThree.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"character-select\"},[_c('h1',[_vm._v(\"Halloween Game!\")]),_c('p',[_vm._v(\"Pick a character\")]),_c('div',{staticClass:\"characters\"},[_c('div',{staticClass:\"characters-square\"},_vm._l((_vm.$options.characters),function(item){return _c('div',{key:item,staticClass:\"character\",class:item,on:{\"touchstart\":function($event){$event.preventDefault();$event.stopPropagation();_vm.$store.dispatch('selectCharacter', item)},\"mousedown\":function($event){_vm.$store.dispatch('selectCharacter', item)}}})}))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"character-select\">\r\n    <h1>Halloween Game!</h1>\r\n    <p>Pick a character</p>\r\n    <div class=\"characters\">\r\n      <div class=\"characters-square\">\r\n        <div\r\n          class=\"character\"\r\n          v-for=\"item in $options.characters\"\r\n          :key=\"item\"\r\n          :class=\"item\"\r\n          @touchstart.prevent.stop=\"$store.dispatch('selectCharacter', item)\"\r\n          @mousedown=\"$store.dispatch('selectCharacter', item)\"\r\n        ></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Score from './Score'\r\n\r\nexport default {\r\n  characters: [\r\n    'ghost',\r\n    'alien'\r\n  ],\r\n  components: {\r\n    Score\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.character-select {\r\n  position: absolute;\r\n  z-index: 1;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 1rem;\r\n  h1 {\r\n    padding: 2rem;\r\n    margin: 0;\r\n    line-height: 3rem;\r\n    font-size: 3rem;\r\n    width: 100%;\r\n    color: #ddd;\r\n  }\r\n  p {\r\n    position: absolute;\r\n    bottom: 4rem;\r\n    padding: 0 1rem;\r\n    margin: 0;\r\n    line-height: 2rem;\r\n    font-size: 1.5rem;\r\n    width: 100%;\r\n    color: #ddd;\r\n  }\r\n  .characters {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    width: 100vmin;\r\n    height: 100vmin;\r\n    margin: auto;\r\n    .characters-square {\r\n      position: relative;\r\n      width: 100%;\r\n      height: 100%;\r\n      .character {\r\n        position: relative;\r\n        display: inline-block;\r\n        cursor: pointer;\r\n        top: 25%;\r\n        width: 48%;\r\n        height: 48%;\r\n        margin: 1%;\r\n        border-radius: 1rem;\r\n        border: 2px solid rgba(0, 0, 0, 0.25);\r\n      }\r\n    }\r\n  }\r\n  .options {\r\n    width: 14rem;\r\n    font-size: 1.75rem;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CharacterSelect.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CharacterSelect.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CharacterSelect.vue?vue&type=template&id=cf5bdaa4&scoped=true&\"\nimport script from \"./CharacterSelect.vue?vue&type=script&lang=js&\"\nexport * from \"./CharacterSelect.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CharacterSelect.vue?vue&type=style&index=0&id=cf5bdaa4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"cf5bdaa4\",\n  null\n  \n)\n\ncomponent.options.__file = \"CharacterSelect.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"map-editor\"},[_c('div',{staticClass:\"editor-header\"},[_c('h2',[_vm._v(\"Map Editor\")]),_c('div',{staticClass:\"editor-controls\"},[_c('button',{staticClass:\"control\",on:{\"click\":_vm.clearMap}},[_vm._v(\"Clear\")]),_c('button',{staticClass:\"control\",on:{\"click\":function($event){_vm.showLoadDialog = true}}},[_vm._v(\"Load\")]),_c('button',{staticClass:\"control\",on:{\"click\":_vm.testMap}},[_vm._v(\"Test\")]),_c('button',{staticClass:\"control\",on:{\"click\":_vm.saveMap}},[_vm._v(\"Save\")]),_c('button',{staticClass:\"control\",on:{\"click\":function($event){_vm.$store.dispatch('mode', 'levelSelect')}}},[_vm._v(\"Back\")])]),_c('div',{staticClass:\"editor-info\"},[_c('span',[_vm._v(_vm._s(_vm.mapWidth)+\"x\"+_vm._s(_vm.mapHeight))]),_c('button',{staticClass:\"control small\",on:{\"click\":function($event){_vm.resizeMap(-1, 0)}}},[_vm._v(\"-W\")]),_c('button',{staticClass:\"control small\",on:{\"click\":function($event){_vm.resizeMap(1, 0)}}},[_vm._v(\"+W\")]),_c('button',{staticClass:\"control small\",on:{\"click\":function($event){_vm.resizeMap(0, -1)}}},[_vm._v(\"-H\")]),_c('button',{staticClass:\"control small\",on:{\"click\":function($event){_vm.resizeMap(0, 1)}}},[_vm._v(\"+H\")]),_c('span',{staticClass:\"divider\"},[_vm._v(\"|\")]),_c('span',[_vm._v(_vm._s(_vm.getSelectedTileName()))]),_c('span',{staticClass:\"controls-hint\"},[_vm._v(\"| Drag/Right-drag/Scroll = Rotate/Pan/Zoom\")]),_c('label',{staticClass:\"direction-toggle\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.showDirectionIndicators),expression:\"showDirectionIndicators\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.showDirectionIndicators)?_vm._i(_vm.showDirectionIndicators,null)>-1:(_vm.showDirectionIndicators)},on:{\"change\":[function($event){var $$a=_vm.showDirectionIndicators,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.showDirectionIndicators=$$a.concat([$$v]))}else{$$i>-1&&(_vm.showDirectionIndicators=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.showDirectionIndicators=$$c}},_vm.render3DMap]}}),_vm._v(\"\\n        Show Directions\\n      \")]),_c('span',{staticClass:\"divider\"},[_vm._v(\"|\")]),_c('label',{staticClass:\"mode-toggle\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.editMode),expression:\"editMode\"}],attrs:{\"type\":\"radio\",\"value\":\"tiles\"},domProps:{\"checked\":_vm._q(_vm.editMode,\"tiles\")},on:{\"change\":function($event){_vm.editMode=\"tiles\"}}}),_c('span',[_vm._v(\"Tiles\")])]),_c('label',{staticClass:\"mode-toggle\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.editMode),expression:\"editMode\"}],attrs:{\"type\":\"radio\",\"value\":\"nodes\"},domProps:{\"checked\":_vm._q(_vm.editMode,\"nodes\")},on:{\"change\":function($event){_vm.editMode=\"nodes\"}}}),_vm._m(0)]),_c('label',{staticClass:\"mode-toggle\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.editMode),expression:\"editMode\"}],attrs:{\"type\":\"radio\",\"value\":\"paths\"},domProps:{\"checked\":_vm._q(_vm.editMode,\"paths\")},on:{\"change\":function($event){_vm.editMode=\"paths\"}}}),_vm._m(1)]),_c('label',{staticClass:\"mode-toggle\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.editMode),expression:\"editMode\"}],attrs:{\"type\":\"radio\",\"value\":\"delete\"},domProps:{\"checked\":_vm._q(_vm.editMode,\"delete\")},on:{\"change\":function($event){_vm.editMode=\"delete\"}}}),_c('span',[_vm._v(\"Delete\")])]),(_vm.editMode === 'paths')?_c('button',{staticClass:\"control small\",on:{\"click\":_vm.autoGeneratePaths}},[_vm._v(\"Auto-Generate Paths\")]):_vm._e()])]),(_vm.showLoadDialog)?_c('div',{staticClass:\"modal-overlay\",on:{\"click\":function($event){_vm.showLoadDialog = false}}},[_c('div',{staticClass:\"modal-content\",on:{\"click\":function($event){$event.stopPropagation();}}},[_c('h3',[_vm._v(\"Load Map\")]),_c('p',[_vm._v(\"Paste your map data below (without the road tiles line):\")]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.loadMapInput),expression:\"loadMapInput\"}],staticClass:\"map-input\",attrs:{\"placeholder\":\"Paste map here...\",\"rows\":\"15\"},domProps:{\"value\":(_vm.loadMapInput)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.loadMapInput=$event.target.value}}}),_c('div',{staticClass:\"modal-buttons\"},[_c('button',{staticClass:\"control\",on:{\"click\":_vm.loadMap}},[_vm._v(\"Load\")]),_c('button',{staticClass:\"control\",on:{\"click\":function($event){_vm.showLoadDialog = false; _vm.loadMapInput = ''}}},[_vm._v(\"Cancel\")])]),(_vm.loadError)?_c('p',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.loadError))]):_vm._e()])]):_vm._e(),_c('div',{staticClass:\"editor-body\"},[_c('div',{staticClass:\"tile-palette\",class:{ collapsed: _vm.editMode !== 'tiles' }},[(_vm.editMode === 'tiles')?[_c('h3',[_vm._v(\"Tiles\")]),_c('div',{staticClass:\"palette-section\"},[_c('h4',[_vm._v(\"Special\")]),_vm._l((_vm.specialTiles),function(tile){return _c('button',{key:tile.char,staticClass:\"palette-tile\",class:{ selected: _vm.selectedTile === tile.char },attrs:{\"title\":tile.name},on:{\"click\":function($event){_vm.selectedTile = tile.char}}},[_c('span',{staticClass:\"tile-char\"},[_vm._v(_vm._s(tile.char))]),_c('span',{staticClass:\"tile-label\"},[_vm._v(_vm._s(tile.name))])])})],2),_c('div',{staticClass:\"palette-section\"},[_c('h4',[_vm._v(\"Roads\")]),_vm._l((_vm.roadTiles),function(tile){return _c('button',{key:tile.char,staticClass:\"palette-tile\",class:{ selected: _vm.selectedTile === tile.char },attrs:{\"title\":tile.name},on:{\"click\":function($event){_vm.selectedTile = tile.char}}},[_c('span',{staticClass:\"tile-char\"},[_vm._v(_vm._s(tile.char))]),_c('span',{staticClass:\"tile-label\"},[_vm._v(_vm._s(tile.name))])])})],2),_c('div',{staticClass:\"palette-section\"},[_c('h4',[_vm._v(\"Houses\")]),_vm._l((_vm.houseTiles),function(tile){return _c('button',{key:tile.char,staticClass:\"palette-tile\",class:{ selected: _vm.selectedTile === tile.char },attrs:{\"title\":tile.name},on:{\"click\":function($event){_vm.selectedTile = tile.char}}},[_c('span',{staticClass:\"tile-char\"},[_vm._v(_vm._s(tile.char))]),_c('span',{staticClass:\"tile-label\"},[_vm._v(_vm._s(tile.name))])])})],2),_c('div',{staticClass:\"palette-section\"},[_c('h4',[_vm._v(\"Scenery\")]),_vm._l((_vm.sceneryTiles),function(tile){return _c('button',{key:tile.char,staticClass:\"palette-tile\",class:{ selected: _vm.selectedTile === tile.char },attrs:{\"title\":tile.name},on:{\"click\":function($event){_vm.selectedTile = tile.char}}},[_c('span',{staticClass:\"tile-char\"},[_vm._v(_vm._s(tile.char))]),_c('span',{staticClass:\"tile-label\"},[_vm._v(_vm._s(tile.name))])])})],2)]:(_vm.editMode === 'nodes')?[_c('h3',[_vm._v(\"Place Nodes\")]),_c('div',{staticClass:\"palette-section\"},[_c('h4',[_vm._v(\"Node Type\")]),_c('button',{staticClass:\"palette-tile wide\",class:{selected: _vm.pointType==='junction'},on:{\"click\":function($event){_vm.pointType='junction'}}},[_vm._m(2)]),_c('button',{staticClass:\"palette-tile wide\",class:{selected: _vm.pointType==='houseStop'},on:{\"click\":function($event){_vm.pointType='houseStop'}}},[_vm._m(3)]),_c('button',{staticClass:\"palette-tile wide\",class:{selected: _vm.pointType==='both'},on:{\"click\":function($event){_vm.pointType='both'}}},[_vm._m(4)])]),_c('p',{staticClass:\"help-text\"},[_vm._v(\"Click on a tile to place a node. Auto-generate will create these automatically.\")])]:(_vm.editMode === 'paths')?[_c('h3',[_vm._v(\"Draw Paths\")]),_c('div',{staticClass:\"palette-section\"},[_c('p',{staticClass:\"help-text\"},[_vm._v(\"Click and drag between tiles to draw paths. Paths connect nodes automatically.\")]),_c('button',{staticClass:\"control\",on:{\"click\":_vm.finishPath}},[_vm._v(\"Finish Path\")]),_c('button',{staticClass:\"control\",on:{\"click\":_vm.clearDraft}},[_vm._v(\"Clear Draft\")])])]:(_vm.editMode === 'delete')?[_c('h3',[_vm._v(\"Delete\")]),_vm._m(5)]:[_c('h3',[_vm._v(\"Navigation\")]),_vm._m(6),(_vm.editMode==='nodes')?_c('div',{staticClass:\"palette-section\"},[_c('h4',[_vm._v(\"Point Type\")]),_c('button',{staticClass:\"palette-tile\",class:{selected: _vm.pointType==='junction'},on:{\"click\":function($event){_vm.pointType='junction'}}},[_c('span',{staticClass:\"tile-label\"},[_vm._v(\"Junction/Turn\")])]),_c('button',{staticClass:\"palette-tile\",class:{selected: _vm.pointType==='houseStop'},on:{\"click\":function($event){_vm.pointType='houseStop'}}},[_c('span',{staticClass:\"tile-label\"},[_vm._v(\"House Stop\")])])]):_vm._e(),(_vm.editMode==='paths')?_c('div',{staticClass:\"palette-section\"},[_c('p',{staticClass:\"hint\"},[_vm._v(\"Click to add segments. Existing points autoconnect.\")])]):_vm._e()]],2),_c('div',{ref:\"map3dContainer\",staticClass:\"map-3d-container\"})])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',[_vm._v(\"Place\"),_c('br'),_vm._v(\"Nodes\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',[_vm._v(\"Draw\"),_c('br'),_vm._v(\"Paths\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"tile-label\"},[_vm._v(\"Junction\"),_c('br'),_vm._v(\"(Turn Point)\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"tile-label\"},[_vm._v(\"House Stop\"),_c('br'),_vm._v(\"(Short Forward)\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"tile-label\"},[_vm._v(\"Junction + House\"),_c('br'),_vm._v(\"(Both Buttons)\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"palette-section\"},[_c('p',{staticClass:\"help-text\"},[_vm._v(\"Click on a node or path to delete it\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"palette-section\"},[_c('p',{staticClass:\"help-text\"},[_vm._v(\"Select a mode from the top toolbar\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"map-editor\">\r\n    <div class=\"editor-header\">\r\n      <h2>Map Editor</h2>\r\n      <div class=\"editor-controls\">\r\n        <button class=\"control\" @click=\"clearMap\">Clear</button>\r\n        <button class=\"control\" @click=\"showLoadDialog = true\">Load</button>\r\n        <button class=\"control\" @click=\"testMap\">Test</button>\r\n        <button class=\"control\" @click=\"saveMap\">Save</button>\r\n        <button class=\"control\" @click=\"$store.dispatch('mode', 'levelSelect')\">Back</button>\r\n      </div>\r\n      <div class=\"editor-info\">\r\n        <span>{{ mapWidth }}x{{ mapHeight }}</span>\r\n        <button class=\"control small\" @click=\"resizeMap(-1, 0)\">-W</button>\r\n        <button class=\"control small\" @click=\"resizeMap(1, 0)\">+W</button>\r\n        <button class=\"control small\" @click=\"resizeMap(0, -1)\">-H</button>\r\n        <button class=\"control small\" @click=\"resizeMap(0, 1)\">+H</button>\r\n        <span class=\"divider\">|</span>\r\n        <span>{{ getSelectedTileName() }}</span>\r\n        <span class=\"controls-hint\">| Drag/Right-drag/Scroll = Rotate/Pan/Zoom</span>\r\n        <label class=\"direction-toggle\">\r\n          <input type=\"checkbox\" v-model=\"showDirectionIndicators\" @change=\"render3DMap\" />\r\n          Show Directions\r\n        </label>\r\n        <span class=\"divider\">|</span>\r\n        <label class=\"mode-toggle\">\r\n          <input type=\"radio\" value=\"tiles\" v-model=\"editMode\" />\r\n          <span>Tiles</span>\r\n        </label>\r\n        <label class=\"mode-toggle\">\r\n          <input type=\"radio\" value=\"nodes\" v-model=\"editMode\" />\r\n          <span>Place<br/>Nodes</span>\r\n        </label>\r\n        <label class=\"mode-toggle\">\r\n          <input type=\"radio\" value=\"paths\" v-model=\"editMode\" />\r\n          <span>Draw<br/>Paths</span>\r\n        </label>\r\n        <label class=\"mode-toggle\">\r\n          <input type=\"radio\" value=\"delete\" v-model=\"editMode\" />\r\n          <span>Delete</span>\r\n        </label>\r\n        <button v-if=\"editMode === 'paths'\" class=\"control small\" @click=\"autoGeneratePaths\">Auto-Generate Paths</button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Load Map Dialog -->\r\n    <div v-if=\"showLoadDialog\" class=\"modal-overlay\" @click=\"showLoadDialog = false\">\r\n      <div class=\"modal-content\" @click.stop>\r\n        <h3>Load Map</h3>\r\n        <p>Paste your map data below (without the road tiles line):</p>\r\n        <textarea\r\n          v-model=\"loadMapInput\"\r\n          placeholder=\"Paste map here...\"\r\n          rows=\"15\"\r\n          class=\"map-input\"\r\n        ></textarea>\r\n        <div class=\"modal-buttons\">\r\n          <button class=\"control\" @click=\"loadMap\">Load</button>\r\n          <button class=\"control\" @click=\"showLoadDialog = false; loadMapInput = ''\">Cancel</button>\r\n        </div>\r\n        <p v-if=\"loadError\" class=\"error\">{{ loadError }}</p>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"editor-body\">\r\n      <div class=\"tile-palette\" :class=\"{ collapsed: editMode !== 'tiles' }\">\r\n        <template v-if=\"editMode === 'tiles'\">\r\n        <h3>Tiles</h3>\r\n        <div class=\"palette-section\">\r\n          <h4>Special</h4>\r\n          <button\r\n            v-for=\"tile in specialTiles\"\r\n            :key=\"tile.char\"\r\n            class=\"palette-tile\"\r\n            :class=\"{ selected: selectedTile === tile.char }\"\r\n            @click=\"selectedTile = tile.char\"\r\n            :title=\"tile.name\"\r\n          >\r\n            <span class=\"tile-char\">{{ tile.char }}</span>\r\n            <span class=\"tile-label\">{{ tile.name }}</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"palette-section\">\r\n          <h4>Roads</h4>\r\n          <button\r\n            v-for=\"tile in roadTiles\"\r\n            :key=\"tile.char\"\r\n            class=\"palette-tile\"\r\n            :class=\"{ selected: selectedTile === tile.char }\"\r\n            @click=\"selectedTile = tile.char\"\r\n            :title=\"tile.name\"\r\n          >\r\n            <span class=\"tile-char\">{{ tile.char }}</span>\r\n            <span class=\"tile-label\">{{ tile.name }}</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"palette-section\">\r\n          <h4>Houses</h4>\r\n          <button\r\n            v-for=\"tile in houseTiles\"\r\n            :key=\"tile.char\"\r\n            class=\"palette-tile\"\r\n            :class=\"{ selected: selectedTile === tile.char }\"\r\n            @click=\"selectedTile = tile.char\"\r\n            :title=\"tile.name\"\r\n          >\r\n            <span class=\"tile-char\">{{ tile.char }}</span>\r\n            <span class=\"tile-label\">{{ tile.name }}</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"palette-section\">\r\n          <h4>Scenery</h4>\r\n          <button\r\n            v-for=\"tile in sceneryTiles\"\r\n            :key=\"tile.char\"\r\n            class=\"palette-tile\"\r\n            :class=\"{ selected: selectedTile === tile.char }\"\r\n            @click=\"selectedTile = tile.char\"\r\n            :title=\"tile.name\"\r\n          >\r\n            <span class=\"tile-char\">{{ tile.char }}</span>\r\n            <span class=\"tile-label\">{{ tile.name }}</span>\r\n          </button>\r\n        </div>\r\n        </template>\r\n        <template v-else-if=\"editMode === 'nodes'\">\r\n          <h3>Place Nodes</h3>\r\n          <div class=\"palette-section\">\r\n            <h4>Node Type</h4>\r\n            <button class=\"palette-tile wide\" :class=\"{selected: pointType==='junction'}\" @click=\"pointType='junction'\">\r\n              <span class=\"tile-label\">Junction<br/>(Turn Point)</span>\r\n            </button>\r\n            <button class=\"palette-tile wide\" :class=\"{selected: pointType==='houseStop'}\" @click=\"pointType='houseStop'\">\r\n              <span class=\"tile-label\">House Stop<br/>(Short Forward)</span>\r\n            </button>\r\n            <button class=\"palette-tile wide\" :class=\"{selected: pointType==='both'}\" @click=\"pointType='both'\">\r\n              <span class=\"tile-label\">Junction + House<br/>(Both Buttons)</span>\r\n            </button>\r\n          </div>\r\n          <p class=\"help-text\">Click on a tile to place a node. Auto-generate will create these automatically.</p>\r\n        </template>\r\n        <template v-else-if=\"editMode === 'paths'\">\r\n          <h3>Draw Paths</h3>\r\n          <div class=\"palette-section\">\r\n            <p class=\"help-text\">Click and drag between tiles to draw paths. Paths connect nodes automatically.</p>\r\n            <button class=\"control\" @click=\"finishPath\">Finish Path</button>\r\n            <button class=\"control\" @click=\"clearDraft\">Clear Draft</button>\r\n          </div>\r\n        </template>\r\n        <template v-else-if=\"editMode === 'delete'\">\r\n          <h3>Delete</h3>\r\n          <div class=\"palette-section\">\r\n            <p class=\"help-text\">Click on a node or path to delete it</p>\r\n          </div>\r\n        </template>\r\n        <template v-else>\r\n          <h3>Navigation</h3>\r\n          <div class=\"palette-section\">\r\n            <p class=\"help-text\">Select a mode from the top toolbar</p>\r\n          </div>\r\n          <div class=\"palette-section\" v-if=\"editMode==='nodes'\">\r\n            <h4>Point Type</h4>\r\n            <button class=\"palette-tile\" :class=\"{selected: pointType==='junction'}\" @click=\"pointType='junction'\">\r\n              <span class=\"tile-label\">Junction/Turn</span>\r\n            </button>\r\n            <button class=\"palette-tile\" :class=\"{selected: pointType==='houseStop'}\" @click=\"pointType='houseStop'\">\r\n              <span class=\"tile-label\">House Stop</span>\r\n            </button>\r\n          </div>\r\n          <div class=\"palette-section\" v-if=\"editMode==='paths'\">\r\n            <p class=\"hint\">Click to add segments. Existing points autoconnect.</p>\r\n          </div>\r\n        </template>\r\n      </div>\r\n\r\n      <div class=\"map-3d-container\" ref=\"map3dContainer\">\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as THREE from 'three'\r\nwindow.THREE = THREE\r\nrequire('three/examples/js/loaders/GLTFLoader')\r\nrequire('three/examples/js/controls/OrbitControls')\r\n\r\nconst deg45 = Math.PI / 4\r\n\r\nconst directionMap = {\r\n  X: -deg45 * 4,\r\n  Z: -deg45 * 6,\r\n  A: -deg45 * 6,\r\n  Q: 0,\r\n  W: 0,\r\n  E: -deg45 * 2,\r\n  D: -deg45 * 2,\r\n  C: -deg45 * 4,\r\n  'S': 0,\r\n  ' ': 0,\r\n  '┃': 0,\r\n  '━': -deg45 * 2,\r\n  '┓': -deg45 * 4,\r\n  '┛': -deg45 * 6,\r\n  '┗': 0,\r\n  '┏': -deg45 * 2,\r\n  ',': -deg45 * 2,\r\n  '┻': 0,\r\n  '┣': -deg45 * 2,\r\n  '┳': -deg45 * 4,\r\n  '┫': -deg45 * 6,\r\n  '╋': 0,\r\n  '╻': -deg45 * 4,\r\n  '╹': 0,\r\n  '╺': -deg45 * 2,\r\n  '╸': -deg45 * 6,\r\n  'P': 0,\r\n  '!': 0,\r\n  'H': 0\r\n}\r\n\r\nconst charModelMap = {\r\n  'Q': 'house_corner',\r\n  'W': 'house',\r\n  'E': 'house_corner',\r\n  'D': 'house',\r\n  'C': 'house_corner',\r\n  'X': 'house',\r\n  'Z': 'house_corner',\r\n  'A': 'house',\r\n  'S': 'road_spawn',\r\n  ' ': 'park',\r\n  '┃': 'road_horizontal',\r\n  '━': 'road_horizontal',\r\n  '┓': 'road_corner',\r\n  '┛': 'road_corner',\r\n  '┗': 'road_corner',\r\n  '┏': 'road_corner',\r\n  ',': 'start',\r\n  '┻': 'road_tee',\r\n  '┣': 'road_tee',\r\n  '┳': 'road_tee',\r\n  '┫': 'road_tee',\r\n  '╋': 'road_plus',\r\n  '╻': 'road_end',\r\n  '╹': 'road_end',\r\n  '╺': 'road_end',\r\n  '╸': 'road_end',\r\n  'P': 'park',\r\n  '!': 'road_spawn',\r\n  'H': 'house'\r\n}\r\n\r\nexport default {\r\n  name: 'MapEditor',\r\n  data () {\r\n    return {\r\n      mapWidth: 10,\r\n      mapHeight: 10,\r\n      mapData: [],\r\n      selectedTile: 'S',\r\n      isDragging: false,\r\n      mouseDownPos: null,\r\n      mouseMoved: false,\r\n      isDraggingPath: false,\r\n      dragStartNode: null,\r\n      gltfLoader: null,\r\n      unpackedObjectMap: {},\r\n      renderer: null,\r\n      camera: null,\r\n      scene: null,\r\n      mapGroup: null,\r\n      tileObjects: [],\r\n      raycaster: null,\r\n      mouse: null,\r\n      loaded: false,\r\n      animationId: null,\r\n      controls: null,\r\n      editMode: 'tiles',\r\n      nodes: [], // {x,y,type}\r\n      edges: [], // {from:{x,y}, to:{x,y}}\r\n      overlayGroup: null,\r\n      pointType: 'junction',\r\n      pathDraftNode: null,\r\n      showLoadDialog: false,\r\n      loadMapInput: '',\r\n      loadError: '',\r\n      showDirectionIndicators: false,\r\n      specialTiles: [\r\n        { char: 'S', name: 'Spawn' },\r\n        { char: '!', name: 'Exit' }\r\n      ],\r\n      roadTiles: [\r\n        { char: '┃', name: 'Road |' },\r\n        { char: '━', name: 'Road -' },\r\n        { char: '┓', name: 'Corner' },\r\n        { char: '┛', name: 'Corner' },\r\n        { char: '┗', name: 'Corner' },\r\n        { char: '┏', name: 'Corner' },\r\n        { char: '┻', name: 'T-Road' },\r\n        { char: '┣', name: 'T-Road' },\r\n        { char: '┳', name: 'T-Road' },\r\n        { char: '┫', name: 'T-Road' },\r\n        { char: '╋', name: 'Cross' },\r\n        { char: '╻', name: 'End' },\r\n        { char: '╹', name: 'End' },\r\n        { char: '╺', name: 'End' },\r\n        { char: '╸', name: 'End' }\r\n      ],\r\n      houseTiles: [\r\n        { char: 'Q', name: 'House' },\r\n        { char: 'W', name: 'House' },\r\n        { char: 'E', name: 'House' },\r\n        { char: 'D', name: 'House' },\r\n        { char: 'C', name: 'House' },\r\n        { char: 'X', name: 'House' },\r\n        { char: 'Z', name: 'House' },\r\n        { char: 'A', name: 'House' }\r\n      ],\r\n      sceneryTiles: [\r\n        { char: 'P', name: 'Park' },\r\n        { char: 'H', name: 'House' }\r\n      ]\r\n    }\r\n  },\r\n  async mounted () {\r\n    this.initializeMap()\r\n    await this.loadAssets()\r\n    this.init3D()\r\n    this.render3DMap()\r\n  },\r\n  beforeDestroy () {\r\n    // Cancel animation loop\r\n    if (this.animationId) {\r\n      cancelAnimationFrame(this.animationId)\r\n      this.animationId = null\r\n    }\r\n\r\n    // Dispose controls\r\n    if (this.controls) {\r\n      this.controls.dispose()\r\n      this.controls = null\r\n    }\r\n\r\n    // Remove event listeners\r\n    if (this.renderer && this.renderer.domElement) {\r\n      this.renderer.domElement.removeEventListener('mousedown', this.onMapMouseDown)\r\n      this.renderer.domElement.removeEventListener('mouseup', this.onMapMouseUp)\r\n      this.renderer.domElement.removeEventListener('mousemove', this.onMapMouseMove)\r\n    }\r\n\r\n    // Clean up renderer\r\n    if (this.renderer) {\r\n      this.renderer.dispose()\r\n      this.renderer = null\r\n    }\r\n\r\n    // Clear references\r\n    this.scene = null\r\n    this.camera = null\r\n    this.mapGroup = null\r\n    this.tileObjects = []\r\n  },\r\n  methods: {\r\n    async loadAssets () {\r\n      this.gltfLoader = new THREE.GLTFLoader()\r\n      const gltf = await new Promise((resolve, reject) => {\r\n        this.gltfLoader.load('models/city.gltf', resolve, undefined, reject)\r\n      })\r\n      gltf.scene.children.forEach((item) => {\r\n        this.unpackedObjectMap[item.name] = item\r\n      })\r\n      this.loaded = true\r\n    },\r\n    init3D () {\r\n      if (!this.$refs.map3dContainer) return\r\n\r\n      // Setup renderer\r\n      this.renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true })\r\n      this.renderer.setSize(this.$refs.map3dContainer.clientWidth, this.$refs.map3dContainer.clientHeight)\r\n      this.$refs.map3dContainer.appendChild(this.renderer.domElement)\r\n\r\n      // Setup camera\r\n      this.camera = new THREE.PerspectiveCamera(45, this.$refs.map3dContainer.clientWidth / this.$refs.map3dContainer.clientHeight, 0.1, 1000)\r\n      this.updateCameraPosition()\r\n      this.camera.lookAt(0, 0, 0)\r\n\r\n      // Setup scene\r\n      this.scene = new THREE.Scene()\r\n      this.scene.fog = new THREE.Fog('#5d3758', 15, 25)\r\n\r\n      // Lighting\r\n      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5)\r\n      directionalLight.position.set(-2, 2, 2)\r\n      this.scene.add(directionalLight)\r\n\r\n      const directionalLight2 = new THREE.DirectionalLight(0xffffff, 1.0)\r\n      directionalLight2.position.set(1, 2, 1)\r\n      this.scene.add(directionalLight2)\r\n\r\n      const ambientLight = new THREE.AmbientLight(0xffffff, 2)\r\n      this.scene.add(ambientLight)\r\n\r\n      const light = new THREE.HemisphereLight(0xcefeff, 0xb3eaf0, 0.5)\r\n      this.scene.add(light)\r\n\r\n      // Map group\r\n      this.mapGroup = new THREE.Group()\r\n      this.mapGroup.rotation.x = -deg45 * 2\r\n      this.scene.add(this.mapGroup)\r\n\r\n      // Overlay group for nodes/edges (child of mapGroup so it inherits rotation)\r\n      this.overlayGroup = new THREE.Group()\r\n      this.mapGroup.add(this.overlayGroup)\r\n\r\n      // Raycaster for clicking\r\n      this.raycaster = new THREE.Raycaster()\r\n      this.mouse = new THREE.Vector2()\r\n\r\n      // OrbitControls for camera movement\r\n      this.controls = new THREE.OrbitControls(this.camera, this.renderer.domElement)\r\n      this.controls.enableDamping = true\r\n      this.controls.dampingFactor = 0.25\r\n      this.controls.screenSpacePanning = false\r\n      this.controls.minDistance = 5\r\n      this.controls.maxDistance = 30\r\n      this.controls.maxPolarAngle = Math.PI / 2\r\n\r\n      // Mouse events\r\n      this.renderer.domElement.addEventListener('mousedown', this.onMapMouseDown)\r\n      this.renderer.domElement.addEventListener('mouseup', this.onMapMouseUp)\r\n      this.renderer.domElement.addEventListener('mousemove', this.onMapMouseMove)\r\n\r\n      // Animation loop\r\n      const animate = () => {\r\n        if (this.renderer && this.scene && this.camera && this.controls) {\r\n          this.animationId = requestAnimationFrame(animate)\r\n          this.controls.update()\r\n          this.renderer.render(this.scene, this.camera)\r\n        }\r\n      }\r\n      animate()\r\n    },\r\n    updateCameraPosition () {\r\n      if (!this.camera) return\r\n      // Adjust camera distance based on map size\r\n      const maxDimension = Math.max(this.mapWidth, this.mapHeight)\r\n      const distance = maxDimension * 1.2 + 5\r\n      this.camera.position.set(0, distance, distance * 0.7)\r\n      this.camera.lookAt(0, 0, 0)\r\n      if (this.controls) {\r\n        this.controls.update()\r\n      }\r\n    },\r\n    initializeMap () {\r\n      this.mapData = new Array(this.mapWidth * this.mapHeight).fill('P')\r\n      const centerIndex = Math.floor((this.mapHeight / 2) * this.mapWidth + this.mapWidth / 2)\r\n      this.mapData[centerIndex] = 'S'\r\n      if (this.loaded) {\r\n        this.updateCameraPosition()\r\n        this.render3DMap()\r\n      }\r\n    },\r\n    resizeMap (deltaWidth, deltaHeight) {\r\n      const newWidth = Math.max(5, Math.min(30, this.mapWidth + deltaWidth))\r\n      const newHeight = Math.max(5, Math.min(30, this.mapHeight + deltaHeight))\r\n      if (newWidth === this.mapWidth && newHeight === this.mapHeight) return\r\n      const newData = new Array(newWidth * newHeight).fill('P')\r\n      for (let y = 0; y < Math.min(this.mapHeight, newHeight); y++) {\r\n        for (let x = 0; x < Math.min(this.mapWidth, newWidth); x++) {\r\n          const oldIndex = y * this.mapWidth + x\r\n          const newIndex = y * newWidth + x\r\n          newData[newIndex] = this.mapData[oldIndex] || 'P'\r\n        }\r\n      }\r\n      this.mapWidth = newWidth\r\n      this.mapHeight = newHeight\r\n      this.mapData = newData\r\n      this.updateCameraPosition()\r\n      this.render3DMap()\r\n    },\r\n    render3DMap () {\r\n      if (!this.mapGroup || !this.loaded) return\r\n\r\n      // Clear existing tiles (but keep overlayGroup)\r\n      const children = [...this.mapGroup.children]\r\n      children.forEach(child => {\r\n        if (child !== this.overlayGroup) {\r\n          this.mapGroup.remove(child)\r\n        }\r\n      })\r\n      this.tileObjects = []\r\n\r\n      const xOffset = (-this.mapWidth / 2) + 0.5\r\n      const yOffset = (-this.mapHeight / 2)\r\n\r\n      const houses = ['house_a', 'house_b', 'house_c']\r\n      const getHouseForPosition = (x, y) => {\r\n        // Use position as seed for consistent house selection\r\n        const seed = (x * 7 + y * 13) % houses.length\r\n        return houses[seed]\r\n      }\r\n\r\n      for (let y = 0; y < this.mapHeight; y++) {\r\n        for (let x = 0; x < this.mapWidth; x++) {\r\n          const index = y * this.mapWidth + x\r\n          const char = this.mapData[index]\r\n          let modelName = charModelMap[char] || 'park'\r\n          const rotation = directionMap[char] || 0\r\n\r\n          // Handle 'house' placeholder - pick consistent house type based on position\r\n          if (modelName === 'house') {\r\n            modelName = getHouseForPosition(x, y)\r\n          }\r\n\r\n          if (this.unpackedObjectMap[modelName]) {\r\n            const tile = this.unpackedObjectMap[modelName].clone()\r\n            tile.position.x = -(x + xOffset)\r\n            tile.position.y = (y + yOffset)\r\n            tile.rotation.z = rotation\r\n            tile.userData = { index, x, y }\r\n            this.mapGroup.add(tile)\r\n            this.tileObjects.push(tile)\r\n          }\r\n        }\r\n      }\r\n\r\n      // Add compass direction labels if enabled\r\n      if (this.showDirectionIndicators) {\r\n        this.addCompassLabels(xOffset, yOffset)\r\n      }\r\n\r\n      // Render overlay (nodes/edges)\r\n      this.renderOverlay()\r\n    },\r\n    addCompassLabels (xOffset, yOffset) {\r\n      const createLabel = (text, color = '#ff0000') => {\r\n        // Create a new canvas for each label\r\n        const canvas = document.createElement('canvas')\r\n        const context = canvas.getContext('2d')\r\n        canvas.width = 256\r\n        canvas.height = 256\r\n\r\n        context.fillStyle = color\r\n        context.font = 'Bold 180px Arial'\r\n        context.textAlign = 'center'\r\n        context.textBaseline = 'middle'\r\n        context.fillText(text, 128, 128)\r\n\r\n        const texture = new THREE.CanvasTexture(canvas)\r\n        const material = new THREE.SpriteMaterial({ map: texture })\r\n        const sprite = new THREE.Sprite(material)\r\n        sprite.scale.set(2, 2, 1)\r\n        return sprite\r\n      }\r\n\r\n      // North (top of map)\r\n      const north = createLabel('N')\r\n      north.position.set(0, -(this.mapHeight / 2) - 1.5, 1)\r\n      this.mapGroup.add(north)\r\n\r\n      // South (bottom of map)\r\n      const south = createLabel('S')\r\n      south.position.set(0, (this.mapHeight / 2) + 1.5, 1)\r\n      this.mapGroup.add(south)\r\n\r\n      // East (right side of map)\r\n      const east = createLabel('E')\r\n      east.position.set(-(this.mapWidth / 2) - 1.5, 0, 1)\r\n      this.mapGroup.add(east)\r\n\r\n      // West (left side of map)\r\n      const west = createLabel('W')\r\n      west.position.set((this.mapWidth / 2) + 1.5, 0, 1)\r\n      this.mapGroup.add(west)\r\n    },\r\n    onMapMouseDown (event) {\r\n      this.mouseDownPos = { x: event.clientX, y: event.clientY }\r\n      this.mouseMoved = false\r\n\r\n      // For path drawing mode, start drag\r\n      if (this.editMode === 'paths') {\r\n        const hit = this.screenToTile(event)\r\n        if (hit) {\r\n          // Find or create node at this position\r\n          let node = this.nodes.find(n => n.x === hit.x && n.y === hit.y)\r\n          if (!node) {\r\n            node = { x: hit.x, y: hit.y, type: 'junction' }\r\n            this.nodes.push(node)\r\n          }\r\n          this.dragStartNode = node\r\n          this.isDraggingPath = true\r\n          // Disable orbit controls during path drag\r\n          if (this.controls) {\r\n            this.controls.enabled = false\r\n          }\r\n        }\r\n      }\r\n    },\r\n    renderOverlay () {\r\n      if (!this.overlayGroup) return\r\n\r\n      // Clear overlay\r\n      while (this.overlayGroup.children.length > 0) {\r\n        this.overlayGroup.remove(this.overlayGroup.children[0])\r\n      }\r\n\r\n      const xOffset = (-this.mapWidth / 2) + 0.5\r\n      const yOffset = (-this.mapHeight / 2)\r\n\r\n      // Draw nodes (snap to tile centers)\r\n      const nodeGeom = new THREE.SphereGeometry(0.12, 10, 10)\r\n      this.nodes.forEach(({ x, y, type }) => {\r\n        // Color based on type: cyan=junction, red=houseStop, purple=both\r\n        let color = 0x00ffff // cyan for junction\r\n        if (type === 'houseStop') color = 0xff4444 // red\r\n        if (type === 'both') color = 0xff00ff // magenta/purple for junction+house\r\n\r\n        const nodeMat = new THREE.MeshBasicMaterial({ color })\r\n        const node = new THREE.Mesh(nodeGeom, nodeMat)\r\n        node.position.x = -(x + xOffset)\r\n        node.position.y = (y + yOffset)\r\n        node.position.z = 0.05 // Just slightly above tile plane\r\n        this.overlayGroup.add(node)\r\n      })\r\n\r\n      // Draw edges\r\n      const edgeMat = new THREE.LineBasicMaterial({ color: 0xffcc00 })\r\n      this.edges.forEach(({ from, to }) => {\r\n        const points = []\r\n        points.push(new THREE.Vector3(-(from.x + xOffset), (from.y + yOffset), 0.05))\r\n        points.push(new THREE.Vector3(-(to.x + xOffset), (to.y + yOffset), 0.05))\r\n        const geom = new THREE.BufferGeometry().setFromPoints(points)\r\n        const line = new THREE.Line(geom, edgeMat)\r\n        this.overlayGroup.add(line)\r\n      })\r\n    },\r\n    onMapMouseMove (event) {\r\n      if (this.mouseDownPos) {\r\n        const dx = event.clientX - this.mouseDownPos.x\r\n        const dy = event.clientY - this.mouseDownPos.y\r\n        const distance = Math.sqrt(dx * dx + dy * dy)\r\n        if (distance > 5) { // 5px threshold for drag detection\r\n          this.mouseMoved = true\r\n        }\r\n      }\r\n\r\n      // Update overlay on mouse move\r\n      this.renderOverlay()\r\n    },\r\n    onMapMouseUp (event) {\r\n      // Handle path drag completion\r\n      if (this.isDraggingPath && this.dragStartNode) {\r\n        const hit = this.screenToTile(event)\r\n        if (hit) {\r\n          // Find or create end node\r\n          let endNode = this.nodes.find(n => n.x === hit.x && n.y === hit.y)\r\n          if (!endNode) {\r\n            endNode = { x: hit.x, y: hit.y, type: 'junction' }\r\n            this.nodes.push(endNode)\r\n          }\r\n          // Create edge if different nodes\r\n          if (!(this.dragStartNode.x === endNode.x && this.dragStartNode.y === endNode.y)) {\r\n            // Check if edge already exists\r\n            const edgeExists = this.edges.some(e =>\r\n              (e.from.x === this.dragStartNode.x && e.from.y === this.dragStartNode.y && e.to.x === endNode.x && e.to.y === endNode.y) ||\r\n              (e.to.x === this.dragStartNode.x && e.to.y === this.dragStartNode.y && e.from.x === endNode.x && e.from.y === endNode.y)\r\n            )\r\n            if (!edgeExists) {\r\n              this.edges.push({\r\n                from: { x: this.dragStartNode.x, y: this.dragStartNode.y },\r\n                to: { x: endNode.x, y: endNode.y }\r\n              })\r\n            }\r\n          }\r\n        }\r\n        this.isDraggingPath = false\r\n        this.dragStartNode = null\r\n        // Re-enable orbit controls\r\n        if (this.controls) {\r\n          this.controls.enabled = true\r\n        }\r\n        this.renderOverlay()\r\n      } else if (!this.mouseMoved && this.mouseDownPos) {\r\n        // Only place tile/node if mouse didn't move (not a drag)\r\n        if (this.editMode === 'tiles') {\r\n          this.placeTileAtClick(event)\r\n        } else if (this.editMode === 'nodes') {\r\n          this.placeNodeAtClick(event)\r\n        } else if (this.editMode === 'delete') {\r\n          this.deleteAtClick(event)\r\n        }\r\n      }\r\n      this.mouseDownPos = null\r\n      this.mouseMoved = false\r\n    },\r\n    screenToTile (event) {\r\n      const rect = this.renderer.domElement.getBoundingClientRect()\r\n      this.mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1\r\n      this.mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1\r\n      this.raycaster.setFromCamera(this.mouse, this.camera)\r\n\r\n      // Raycast directly against tile objects\r\n      const intersects = this.raycaster.intersectObjects(this.tileObjects, true)\r\n      if (intersects.length > 0) {\r\n        // Find the first intersected tile with userData\r\n        for (const intersect of intersects) {\r\n          let obj = intersect.object\r\n          // Walk up the parent chain to find the tile object with userData\r\n          while (obj && !obj.userData.index && obj.parent) {\r\n          obj = obj.parent\r\n            if (obj === this.scene || obj === this.mapGroup) break\r\n          }\r\n          if (obj && obj.userData && obj.userData.index !== undefined) {\r\n            return { index: obj.userData.index, x: obj.userData.x, y: obj.userData.y }\r\n          }\r\n        }\r\n      }\r\n      return null\r\n    },\r\n    placeTileAtClick (event) {\r\n      if (!this.renderer || !this.camera || !this.raycaster || !this.mouse) return\r\n      const hit = this.screenToTile(event)\r\n      if (hit && hit.index !== undefined) {\r\n        this.$set(this.mapData, hit.index, this.selectedTile)\r\n          this.render3DMap()\r\n      }\r\n    },\r\n    placeNodeAtClick (event) {\r\n      const hit = this.screenToTile(event)\r\n      if (!hit) return\r\n      // Snap to tile center\r\n      this.nodes.push({ x: hit.x, y: hit.y, type: this.pointType })\r\n      this.render3DMap()\r\n    },\r\n    deleteAtClick (event) {\r\n      const hit = this.screenToTile(event)\r\n      if (!hit) return\r\n\r\n      // Check if clicking on a node\r\n      const nodeIndex = this.nodes.findIndex(n => n.x === hit.x && n.y === hit.y)\r\n      if (nodeIndex !== -1) {\r\n        const node = this.nodes[nodeIndex]\r\n        // Remove all edges connected to this node\r\n        this.edges = this.edges.filter(e =>\r\n          !(e.from.x === node.x && e.from.y === node.y) &&\r\n          !(e.to.x === node.x && e.to.y === node.y)\r\n        )\r\n        // Remove the node\r\n        this.nodes.splice(nodeIndex, 1)\r\n        this.renderOverlay()\r\n        return\r\n      }\r\n\r\n      // Check if clicking near an edge (within 0.5 units)\r\n      for (let i = 0; i < this.edges.length; i++) {\r\n        const edge = this.edges[i]\r\n        // Simple distance check to edge\r\n        const dx = edge.to.x - edge.from.x\r\n        const dy = edge.to.y - edge.from.y\r\n        const len = Math.sqrt(dx * dx + dy * dy)\r\n        if (len === 0) continue\r\n\r\n        // Project point onto line segment\r\n        const t = Math.max(0, Math.min(1,\r\n          ((hit.x - edge.from.x) * dx + (hit.y - edge.from.y) * dy) / (len * len)\r\n        ))\r\n        const projX = edge.from.x + t * dx\r\n        const projY = edge.from.y + t * dy\r\n        const dist = Math.sqrt((hit.x - projX) ** 2 + (hit.y - projY) ** 2)\r\n\r\n        if (dist < 0.5) {\r\n          this.edges.splice(i, 1)\r\n          this.renderOverlay()\r\n          return\r\n        }\r\n      }\r\n    },\r\n    finishPath () {\r\n      this.pathDraftNode = null\r\n    },\r\n    clearDraft () {\r\n      this.pathDraftNode = null\r\n    },\r\n    autoGeneratePaths () {\r\n      if (!confirm('Auto-generate paths along all roads? This will clear existing paths.')) {\r\n        return\r\n      }\r\n\r\n      this.nodes = []\r\n      this.edges = []\r\n\r\n      // Road tiles that can be walked on\r\n      const roadChars = 'SH┃━┓┛┗┏┻┣┳┫╋╻╹╺╸'\r\n\r\n      // House facing directions (which directions the house can be accessed from)\r\n      const houseFacingMap = {\r\n        'Q': ['up', 'left'], // North-West corner\r\n        'W': ['up'], // North side\r\n        'E': ['up', 'right'], // North-East corner\r\n        'D': ['right'], // East side\r\n        'C': ['down', 'right'], // South-East corner\r\n        'X': ['down'], // South side\r\n        'Z': ['down', 'left'], // South-West corner\r\n        'A': ['left'], // West side\r\n        'H': ['up'] // North-facing house\r\n      }\r\n\r\n      // Helper to check if a tile is a road\r\n      const isRoad = (x, y) => {\r\n        if (x < 0 || x >= this.mapWidth || y < 0 || y >= this.mapHeight) return false\r\n        const index = y * this.mapWidth + x\r\n        return roadChars.includes(this.mapData[index])\r\n      }\r\n\r\n      // Helper to get tile at position\r\n      const getTile = (x, y) => {\r\n        if (x < 0 || x >= this.mapWidth || y < 0 || y >= this.mapHeight) return null\r\n        const index = y * this.mapWidth + x\r\n        return this.mapData[index]\r\n      }\r\n\r\n      // Helper to check if a position has an accessible house\r\n      const getAccessibleHouse = (x, y, fromDirection) => {\r\n        // Check adjacent tiles for houses\r\n        const checks = {\r\n          'up': { dx: 0, dy: -1, houseDir: 'down' },\r\n          'down': { dx: 0, dy: 1, houseDir: 'up' },\r\n          'left': { dx: -1, dy: 0, houseDir: 'right' },\r\n          'right': { dx: 1, dy: 0, houseDir: 'left' }\r\n        }\r\n\r\n        for (const [checkDir, offset] of Object.entries(checks)) {\r\n          const hx = x + offset.dx\r\n          const hy = y + offset.dy\r\n          const houseTile = getTile(hx, hy)\r\n          if (houseTile && houseFacingMap[houseTile]) {\r\n            // Check if this house can be accessed from the road tile's direction\r\n            const accessDirs = houseFacingMap[houseTile]\r\n            if (accessDirs.includes(offset.houseDir)) {\r\n              return { hasHouse: true, direction: checkDir }\r\n            }\r\n          }\r\n        }\r\n        return { hasHouse: false }\r\n      }\r\n\r\n      // Helper to count road neighbors\r\n      const countRoadNeighbors = (x, y) => {\r\n        let count = 0\r\n        if (isRoad(x - 1, y)) count++\r\n        if (isRoad(x + 1, y)) count++\r\n        if (isRoad(x, y - 1)) count++\r\n        if (isRoad(x, y + 1)) count++\r\n        return count\r\n      }\r\n\r\n      // Helper to check if a position is a corner (2 perpendicular roads)\r\n      const isCorner = (x, y) => {\r\n        const left = isRoad(x - 1, y)\r\n        const right = isRoad(x + 1, y)\r\n        const up = isRoad(x, y - 1)\r\n        const down = isRoad(x, y + 1)\r\n\r\n        // A corner has exactly 2 neighbors that are perpendicular\r\n        const horizontal = (left || right) && !(left && right)\r\n        const vertical = (up || down) && !(up && down)\r\n\r\n        return horizontal && vertical\r\n      }\r\n\r\n      // Helper to check if a position is a junction (3+ roads, dead end, or corner)\r\n      const isJunctionTile = (x, y) => {\r\n        const neighbors = countRoadNeighbors(x, y)\r\n        return neighbors === 1 || neighbors >= 3 || isCorner(x, y)\r\n      }\r\n\r\n      // First pass: Create nodes at junctions, dead-ends, house stops, and spawn\r\n      const nodeMap = {} // \"x,y\" -> node\r\n      for (let y = 0; y < this.mapHeight; y++) {\r\n        for (let x = 0; x < this.mapWidth; x++) {\r\n          const index = y * this.mapWidth + x\r\n          const char = this.mapData[index]\r\n          if (!roadChars.includes(char)) continue\r\n\r\n          // Always create a node at spawn point\r\n          const isSpawn = char === 'S'\r\n          const isJunction = isJunctionTile(x, y)\r\n          const houseInfo = getAccessibleHouse(x, y)\r\n\r\n          let nodeType = null\r\n          if (isSpawn) {\r\n            // Spawn point always gets a node (junction type by default)\r\n            nodeType = houseInfo.hasHouse ? 'both' : 'junction'\r\n          } else if (isJunction && houseInfo.hasHouse) {\r\n            nodeType = 'both' // Special type for junction + house\r\n          } else if (isJunction) {\r\n            nodeType = 'junction'\r\n          } else if (houseInfo.hasHouse) {\r\n            nodeType = 'houseStop'\r\n          }\r\n\r\n          if (nodeType) {\r\n            const node = { x, y, type: nodeType }\r\n            this.nodes.push(node)\r\n            nodeMap[`${x},${y}`] = node\r\n          }\r\n        }\r\n      }\r\n\r\n      // Second pass: Connect adjacent nodes with edges\r\n      // For each node, trace along roads to find the next node\r\n      const visited = new Set()\r\n\r\n      const traceToNextNode = (startX, startY, dirX, dirY) => {\r\n        let x = startX + dirX\r\n        let y = startY + dirY\r\n\r\n        // Follow the road until we hit another node or dead end\r\n        while (isRoad(x, y)) {\r\n          const key = `${x},${y}`\r\n          if (nodeMap[key]) {\r\n            // Found another node\r\n            return { x, y }\r\n          }\r\n\r\n          // Find next direction (continue straight or turn)\r\n          const neighbors = []\r\n          if (isRoad(x - 1, y) && !(dirX === 1 && dirY === 0)) neighbors.push({ dx: -1, dy: 0 })\r\n          if (isRoad(x + 1, y) && !(dirX === -1 && dirY === 0)) neighbors.push({ dx: 1, dy: 0 })\r\n          if (isRoad(x, y - 1) && !(dirX === 0 && dirY === 1)) neighbors.push({ dx: 0, dy: -1 })\r\n          if (isRoad(x, y + 1) && !(dirX === 0 && dirY === -1)) neighbors.push({ dx: 0, dy: 1 })\r\n\r\n          if (neighbors.length === 0) break // Dead end\r\n          if (neighbors.length > 1) break // Junction (shouldn't happen if nodes are correct)\r\n\r\n          dirX = neighbors[0].dx\r\n          dirY = neighbors[0].dy\r\n          x += dirX\r\n          y += dirY\r\n        }\r\n\r\n        return null\r\n      }\r\n\r\n      // For each node, check all 4 directions\r\n      for (const node of this.nodes) {\r\n        const directions = [\r\n          { dx: -1, dy: 0 },\r\n          { dx: 1, dy: 0 },\r\n          { dx: 0, dy: -1 },\r\n          { dx: 0, dy: 1 }\r\n        ]\r\n\r\n        for (const dir of directions) {\r\n          const nextX = node.x + dir.dx\r\n          const nextY = node.y + dir.dy\r\n\r\n          if (!isRoad(nextX, nextY)) continue\r\n\r\n          const result = traceToNextNode(node.x, node.y, dir.dx, dir.dy)\r\n          if (result) {\r\n            // Create edge (avoid duplicates by checking if reverse exists)\r\n            const edgeKey = `${Math.min(node.x, result.x)},${Math.min(node.y, result.y)}-${Math.max(node.x, result.x)},${Math.max(node.y, result.y)}`\r\n            if (!visited.has(edgeKey)) {\r\n              visited.add(edgeKey)\r\n              this.edges.push({\r\n                from: { x: node.x, y: node.y },\r\n                to: { x: result.x, y: result.y }\r\n              })\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      this.renderOverlay()\r\n      const junctionCount = this.nodes.filter(n => n.type === 'junction').length\r\n      const houseCount = this.nodes.filter(n => n.type === 'houseStop').length\r\n      const bothCount = this.nodes.filter(n => n.type === 'both').length\r\n      alert(`Generated ${this.nodes.length} nodes (${junctionCount} junctions, ${houseCount} house stops, ${bothCount} junction+house) and ${this.edges.length} edges`)\r\n    },\r\n    getSelectedTileName () {\r\n      const allTiles = [...this.specialTiles, ...this.roadTiles, ...this.houseTiles, ...this.sceneryTiles]\r\n      const tile = allTiles.find(t => t.char === this.selectedTile)\r\n      return tile ? tile.name : ''\r\n    },\r\n    clearMap () {\r\n      if (confirm('Clear the entire map?')) {\r\n        this.initializeMap()\r\n      }\r\n    },\r\n    loadMap () {\r\n      try {\r\n        this.loadError = ''\r\n        const input = this.loadMapInput.trim()\r\n\r\n        if (!input) {\r\n          this.loadError = 'Please paste a map'\r\n          return\r\n        }\r\n\r\n        // Split by lines and remove empty lines\r\n        // Split off meta section if present\r\n        const metaSplit = input.split('\\n---META---\\n')\r\n        const mapPart = metaSplit[0]\r\n        const metaPart = metaSplit[1]\r\n\r\n        const lines = mapPart.split('\\n').filter(line => line.length > 0)\r\n\r\n        if (lines.length === 0) {\r\n          this.loadError = 'Invalid map format'\r\n          return\r\n        }\r\n\r\n        // Calculate dimensions\r\n        const height = lines.length\r\n        const width = lines[0].length\r\n\r\n        // Validate all lines have the same width\r\n        for (let i = 0; i < lines.length; i++) {\r\n          if (lines[i].length !== width) {\r\n            this.loadError = `Line ${i + 1} has incorrect width (expected ${width}, got ${lines[i].length})`\r\n            return\r\n          }\r\n        }\r\n\r\n        // Load the map\r\n        this.mapWidth = width\r\n        this.mapHeight = height\r\n        this.mapData = []\r\n\r\n        for (let y = 0; y < height; y++) {\r\n          for (let x = 0; x < width; x++) {\r\n            this.mapData.push(lines[y][x])\r\n          }\r\n        }\r\n\r\n        // Load meta if present\r\n        this.nodes = []\r\n        this.edges = []\r\n        if (metaPart) {\r\n          try {\r\n            const parsed = JSON.parse(metaPart)\r\n            this.nodes = Array.isArray(parsed.nodes) ? parsed.nodes : []\r\n            this.edges = Array.isArray(parsed.edges) ? parsed.edges : []\r\n          } catch (e) {\r\n            this.loadError = 'Meta section could not be parsed; ignoring.'\r\n          }\r\n        }\r\n\r\n        // Render and close dialog\r\n        this.updateCameraPosition()\r\n        this.render3DMap()\r\n        this.showLoadDialog = false\r\n        this.loadMapInput = ''\r\n      } catch (error) {\r\n        this.loadError = 'Error loading map: ' + error.message\r\n      }\r\n    },\r\n    testMap () {\r\n      // Check for spawn point\r\n      if (!this.mapData.includes('S')) {\r\n        alert('Map must have at least one spawn point (S)!')\r\n        return\r\n      }\r\n\r\n      // Convert map to string format\r\n      const mapString = this.convertMapToString()\r\n\r\n      // Add the map as a custom level\r\n      this.$store.dispatch('testCustomMap', mapString)\r\n    },\r\n    saveMap () {\r\n      // Check for spawn point\r\n      if (!this.mapData.includes('S')) {\r\n        alert('Map must have at least one spawn point (S)!')\r\n        return\r\n      }\r\n\r\n      const mapString = this.convertMapToString()\r\n      const meta = {\r\n        nodes: this.nodes,\r\n        edges: this.edges\r\n      }\r\n\r\n      // Download as text file\r\n      const blob = new Blob([mapString + '\\n---META---\\n' + JSON.stringify(meta, null, 2)], { type: 'text/plain' })\r\n      const url = URL.createObjectURL(blob)\r\n      const a = document.createElement('a')\r\n      a.href = url\r\n      a.download = 'custom-map.txt'\r\n      a.click()\r\n      URL.revokeObjectURL(url)\r\n\r\n      alert('Map saved! You can add it to levels.txt')\r\n    },\r\n    convertMapToString () {\r\n      let mapString = '\\n'\r\n      for (let y = 0; y < this.mapHeight; y++) {\r\n        for (let x = 0; x < this.mapWidth; x++) {\r\n          const index = y * this.mapWidth + x\r\n          mapString += this.mapData[index]\r\n        }\r\n        mapString += '\\n'\r\n      }\r\n      return mapString\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.map-editor {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: #2d1b4e;\r\n  color: #ddd;\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n}\r\n\r\n.editor-header {\r\n  padding: 0.5rem 1rem;\r\n  background-color: #1a0f2e;\r\n  border-bottom: 2px solid #40408a;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1rem;\r\n  flex-wrap: wrap;\r\n\r\n  h2 {\r\n    margin: 0;\r\n    font-size: 1.5rem;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  .editor-controls {\r\n    display: flex;\r\n    gap: 0.3rem;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  .editor-info {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.4rem;\r\n    font-size: 0.85rem;\r\n    flex: 1;\r\n    min-width: 200px;\r\n\r\n    span {\r\n      &.divider {\r\n        opacity: 0.3;\r\n        margin: 0 0.2rem;\r\n      }\r\n    }\r\n\r\n    .controls-hint {\r\n      font-size: 0.7rem;\r\n      opacity: 0.5;\r\n      font-style: italic;\r\n      margin-left: auto;\r\n    }\r\n  }\r\n}\r\n\r\n.editor-body {\r\n  display: flex;\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.tile-palette {\r\n  width: 320px;\r\n  background-color: #1a0f2e;\r\n  border-right: 2px solid #40408a;\r\n  overflow-y: auto;\r\n  padding: 0.75rem;\r\n\r\n  h3 {\r\n    margin: 0 0 0.5rem 0;\r\n    font-size: 1.2rem;\r\n  }\r\n\r\n  h4 {\r\n    margin: 0.75rem 0 0.3rem 0;\r\n    font-size: 0.85rem;\r\n    color: #fa0;\r\n  }\r\n\r\n  .palette-section {\r\n    margin-bottom: 0.75rem;\r\n\r\n    h4 {\r\n      display: block;\r\n      width: 100%;\r\n    }\r\n  }\r\n\r\n  .palette-section > button {\r\n    display: inline-flex;\r\n  }\r\n\r\n  .palette-tile {\r\n    display: inline-flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 52px;\r\n    height: 52px;\r\n    padding: 0.2rem;\r\n    margin: 0.15rem;\r\n    background-color: #2a2040;\r\n    border: 2px solid #5050aa;\r\n    border-radius: 0.25rem;\r\n    cursor: pointer;\r\n    text-align: center;\r\n    transition: all 0.15s;\r\n    font-family: 'Single Day', sans-serif;\r\n    color: #ddd;\r\n\r\n    &.wide {\r\n      width: 100%;\r\n      height: 60px;\r\n      margin: 0.25rem 0;\r\n    }\r\n\r\n    .tile-char {\r\n      font-size: 1.5rem;\r\n      line-height: 1;\r\n      margin-bottom: 0.1rem;\r\n    }\r\n\r\n    .tile-label {\r\n      font-size: 0.5rem;\r\n      line-height: 1.2;\r\n      opacity: 0.7;\r\n      white-space: normal;\r\n      text-align: center;\r\n      max-width: 100%;\r\n    }\r\n\r\n    &:hover {\r\n      background-color: #3a3050;\r\n      border-color: #6060ba;\r\n      transform: scale(1.08);\r\n    }\r\n\r\n    &.selected {\r\n      background-color: #fa0;\r\n      border-color: #fc0;\r\n      color: #1a0f2e;\r\n      border-width: 3px;\r\n      transform: scale(1.08);\r\n\r\n      .tile-label {\r\n        opacity: 1;\r\n        font-weight: bold;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.map-3d-container {\r\n  flex: 1 1 auto;\r\n  overflow: hidden;\r\n  position: relative;\r\n  background: linear-gradient(180deg, #5d3758 0%, #2d1b4e 100%);\r\n\r\n  canvas {\r\n    display: block;\r\n    width: 100% !important;\r\n    height: 100% !important;\r\n  }\r\n}\r\n\r\n.control {\r\n  display: inline-block;\r\n  padding: 0.4rem 0.8rem;\r\n  margin: 0;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  font-size: 0.85rem;\r\n  border-radius: 0.3rem;\r\n  background-color: #40408a;\r\n  color: #ddd;\r\n  border: none;\r\n  outline: none;\r\n  font-family: Knewave, sans-serif;\r\n  transition: all 0.15s;\r\n\r\n  &:hover {\r\n    background-color: #5050aa;\r\n  }\r\n\r\n  &:active {\r\n    background-color: #ddd;\r\n    color: #fa0;\r\n  }\r\n\r\n  &.small {\r\n    padding: 0.3rem 0.5rem;\r\n    font-size: 0.75rem;\r\n  }\r\n}\r\n\r\n.direction-toggle {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 0.3rem;\r\n  cursor: pointer;\r\n  font-size: 0.8rem;\r\n  margin-left: 0.5rem;\r\n\r\n  input[type=\"checkbox\"] {\r\n    cursor: pointer;\r\n  }\r\n}\r\n\r\n.mode-toggle {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 0.3rem;\r\n  cursor: pointer;\r\n  font-size: 0.75rem;\r\n  margin-left: 0.5rem;\r\n  padding: 0.3rem 0.5rem;\r\n  border: 1px solid #5050aa;\r\n  border-radius: 0.25rem;\r\n  background-color: #2a2040;\r\n  transition: all 0.15s;\r\n\r\n  span {\r\n    line-height: 1.1;\r\n    text-align: center;\r\n  }\r\n\r\n  input[type=\"radio\"] {\r\n    cursor: pointer;\r\n  }\r\n\r\n  &:hover {\r\n    background-color: #3a3050;\r\n    border-color: #6060ba;\r\n  }\r\n\r\n  input[type=\"radio\"]:checked + span {\r\n    color: #fa0;\r\n    font-weight: bold;\r\n  }\r\n}\r\n\r\n.help-text {\r\n  font-size: 0.75rem;\r\n  opacity: 0.7;\r\n  line-height: 1.3;\r\n  margin: 0.5rem 0;\r\n}\r\n\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.7);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  background-color: #1a0f2e;\r\n  border: 2px solid #40408a;\r\n  border-radius: 0.5rem;\r\n  padding: 1.5rem;\r\n  max-width: 600px;\r\n  width: 90%;\r\n  max-height: 80vh;\r\n  overflow-y: auto;\r\n\r\n  h3 {\r\n    margin: 0 0 1rem 0;\r\n    font-size: 1.3rem;\r\n    color: #fa0;\r\n  }\r\n\r\n  p {\r\n    margin: 0.5rem 0;\r\n    font-size: 0.9rem;\r\n  }\r\n\r\n  .map-input {\r\n    width: 100%;\r\n    min-height: 200px;\r\n    padding: 0.5rem;\r\n    background-color: #0a0514;\r\n    color: #ddd;\r\n    border: 1px solid #40408a;\r\n    border-radius: 0.3rem;\r\n    font-family: 'Courier New', monospace;\r\n    font-size: 0.9rem;\r\n    resize: vertical;\r\n    margin: 0.5rem 0;\r\n\r\n    &:focus {\r\n      outline: none;\r\n      border-color: #fa0;\r\n    }\r\n  }\r\n\r\n  .modal-buttons {\r\n    display: flex;\r\n    gap: 0.5rem;\r\n    margin-top: 1rem;\r\n    justify-content: flex-end;\r\n  }\r\n\r\n  .error {\r\n    color: #ff4444;\r\n    font-size: 0.85rem;\r\n    margin-top: 0.5rem;\r\n    padding: 0.5rem;\r\n    background-color: rgba(255, 0, 0, 0.1);\r\n    border-radius: 0.3rem;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapEditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapEditor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MapEditor.vue?vue&type=template&id=e2a5972c&scoped=true&\"\nimport script from \"./MapEditor.vue?vue&type=script&lang=js&\"\nexport * from \"./MapEditor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MapEditor.vue?vue&type=style&index=0&id=e2a5972c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e2a5972c\",\n  null\n  \n)\n\ncomponent.options.__file = \"MapEditor.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"lobby\"},[_c('div',{staticClass:\"lobby-container\"},[_c('h1',[_vm._v(\"🎃 Trick or Treat 🍬\")]),(_vm.state === 'menu')?_c('div',{staticClass:\"menu\"},[_c('p',[_vm._v(\"遊び方を選択してください\")]),_c('button',{staticClass:\"control options\",on:{\"click\":_vm.showCreateRoom}},[_vm._v(\"Make Room\")]),_c('button',{staticClass:\"control options\",on:{\"click\":_vm.showJoinRoom}},[_vm._v(\"Join Room\")])]):_vm._e(),(_vm.state === 'create')?_c('div',{staticClass:\"create-room\"},[_c('h2',[_vm._v(\"ルームを作成\")]),_vm._m(0),_c('button',{staticClass:\"control options\",on:{\"click\":_vm.createRoom}},[_vm._v(\"Make Room\")]),_c('button',{staticClass:\"control options back-btn\",on:{\"click\":_vm.backToMenu}},[_vm._v(\"Back\")])]):_vm._e(),(_vm.state === 'join')?_c('div',{staticClass:\"join-room\"},[_c('h2',[_vm._v(\"Join a Room\")]),_vm._m(1),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.roomCodeInput),expression:\"roomCodeInput\"}],staticClass:\"input-field\",attrs:{\"type\":\"text\",\"placeholder\":\"Enter 5-digit room code\",\"maxlength\":\"5\"},domProps:{\"value\":(_vm.roomCodeInput)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.roomCodeInput=$event.target.value},_vm.validateRoomCode]}}),_c('button',{staticClass:\"control options\",attrs:{\"disabled\":_vm.roomCodeInput.length !== 5},on:{\"click\":_vm.joinRoom}},[_vm._v(\"Join Room\")]),_c('button',{staticClass:\"control options back-btn\",on:{\"click\":_vm.backToMenu}},[_vm._v(\"Back\")]),(_vm.error)?_c('p',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.error))]):_vm._e()]):_vm._e(),(_vm.state === 'waiting')?_c('div',{staticClass:\"waiting-room\"},[_c('h2',[_vm._v(\"Room Code: \"+_vm._s(_vm.currentRoomCode))]),_c('p',{staticClass:\"room-code-display\"},[_vm._v(_vm._s(_vm.currentRoomCode))]),(_vm.isHost)?_c('p',[_vm._v(\"もう一人のプレイヤーが参加するのを待っています...\")]):_c('p',[_vm._v(\"接続しました！ホストがゲームを開始するのを待っています...\")]),_c('div',{staticClass:\"players-list\"},[(_vm.roomData && _vm.roomData.players)?_c('div',[(_vm.roomData.players.player1)?_c('div',{staticClass:\"player-item\"},[_c('span',[_vm._v(\"👻 \"+_vm._s(_vm.roomData.players.player1.name))]),(_vm.roomData.players.player1.connected)?_c('span',{staticClass:\"status-connected\"},[_vm._v(\"●\")]):_vm._e()]):_vm._e(),(_vm.roomData.players.player2)?_c('div',{staticClass:\"player-item\"},[_c('span',[_vm._v(\"👻 \"+_vm._s(_vm.roomData.players.player2.name))]),(_vm.roomData.players.player2.connected)?_c('span',{staticClass:\"status-connected\"},[_vm._v(\"●\")]):_vm._e()]):_c('div',{staticClass:\"player-item empty\"},[_c('span',[_vm._v(\"Player 2 を待っています...\")])])]):_vm._e()]),(_vm.canStartGame)?_c('button',{staticClass:\"control options\",on:{\"click\":_vm.startGame}},[_vm._v(\"Start Game\")]):_vm._e(),_c('button',{staticClass:\"control options back-btn\",on:{\"click\":_vm.leaveRoom}},[_vm._v(\"Leave Room\")])]):_vm._e(),(_vm.state === 'connecting')?_c('div',{staticClass:\"connecting\"},[_c('h2',[_vm._v(\"Establishing Connection...\")]),_c('p',[_vm._v(\"Setting up peer-to-peer connection via WebRTC\")]),_c('div',{staticClass:\"spinner\"})]):_vm._e()])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',{staticClass:\"info-text\"},[_vm._v(\"あなたは \"),_c('strong',[_vm._v(\"Player 1\")]),_vm._v(\" (ホスト) になります\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',{staticClass:\"info-text\"},[_vm._v(\"You will be \"),_c('strong',[_vm._v(\"Player 2\")]),_vm._v(\" (Guest)\")])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"lobby\">\r\n    <div class=\"lobby-container\">\r\n      <h1>🎃 Trick or Treat 🍬</h1>\r\n\r\n      <!-- Initial Menu -->\r\n      <div v-if=\"state === 'menu'\" class=\"menu\">\r\n        <p>遊び方を選択してください</p>\r\n        <button\r\n          class=\"control options\"\r\n          @click=\"showCreateRoom\"\r\n        >Make Room</button>\r\n        <button\r\n          class=\"control options\"\r\n          @click=\"showJoinRoom\"\r\n        >Join Room</button>\r\n      </div>\r\n\r\n      <!-- Create Room -->\r\n      <div v-if=\"state === 'create'\" class=\"create-room\">\r\n        <h2>ルームを作成</h2>\r\n        <p class=\"info-text\">あなたは <strong>Player 1</strong> (ホスト) になります</p>\r\n        <button\r\n          class=\"control options\"\r\n          @click=\"createRoom\"\r\n        >Make Room</button>\r\n        <button\r\n          class=\"control options back-btn\"\r\n          @click=\"backToMenu\"\r\n        >Back</button>\r\n      </div>\r\n\r\n      <!-- Join Room -->\r\n      <div v-if=\"state === 'join'\" class=\"join-room\">\r\n        <h2>Join a Room</h2>\r\n        <p class=\"info-text\">You will be <strong>Player 2</strong> (Guest)</p>\r\n        <input\r\n          v-model=\"roomCodeInput\"\r\n          type=\"text\"\r\n          placeholder=\"Enter 5-digit room code\"\r\n          class=\"input-field\"\r\n          maxlength=\"5\"\r\n          @input=\"validateRoomCode\"\r\n        />\r\n        <button\r\n          class=\"control options\"\r\n          @click=\"joinRoom\"\r\n          :disabled=\"roomCodeInput.length !== 5\"\r\n        >Join Room</button>\r\n        <button\r\n          class=\"control options back-btn\"\r\n          @click=\"backToMenu\"\r\n        >Back</button>\r\n        <p v-if=\"error\" class=\"error\">{{ error }}</p>\r\n      </div>\r\n\r\n      <!-- Waiting Room -->\r\n      <div v-if=\"state === 'waiting'\" class=\"waiting-room\">\r\n        <h2>Room Code: {{ currentRoomCode }}</h2>\r\n        <p class=\"room-code-display\">{{ currentRoomCode }}</p>\r\n        <p v-if=\"isHost\">もう一人のプレイヤーが参加するのを待っています...</p>\r\n        <p v-else>接続しました！ホストがゲームを開始するのを待っています...</p>\r\n\r\n        <div class=\"players-list\">\r\n          <div v-if=\"roomData && roomData.players\">\r\n            <div class=\"player-item\" v-if=\"roomData.players.player1\">\r\n              <span>👻 {{ roomData.players.player1.name }}</span>\r\n              <span v-if=\"roomData.players.player1.connected\" class=\"status-connected\">●</span>\r\n            </div>\r\n            <div class=\"player-item\" v-if=\"roomData.players.player2\">\r\n              <span>👻 {{ roomData.players.player2.name }}</span>\r\n              <span v-if=\"roomData.players.player2.connected\" class=\"status-connected\">●</span>\r\n            </div>\r\n            <div v-else class=\"player-item empty\">\r\n              <span>Player 2 を待っています...</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <button\r\n          v-if=\"canStartGame\"\r\n          class=\"control options\"\r\n          @click=\"startGame\"\r\n        >Start Game</button>\r\n\r\n        <button\r\n          class=\"control options back-btn\"\r\n          @click=\"leaveRoom\"\r\n        >Leave Room</button>\r\n      </div>\r\n\r\n      <!-- Connecting -->\r\n      <div v-if=\"state === 'connecting'\" class=\"connecting\">\r\n        <h2>Establishing Connection...</h2>\r\n        <p>Setting up peer-to-peer connection via WebRTC</p>\r\n        <div class=\"spinner\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport roomService from '../services/roomService'\r\nimport webrtcService from '../services/webrtcService'\r\n\r\nexport default {\r\n  name: 'Lobby',\r\n  data () {\r\n    return {\r\n      state: 'menu', // menu, create, join, waiting, connecting\r\n      roomCodeInput: '',\r\n      currentRoomCode: null,\r\n      isHost: false,\r\n      error: null,\r\n      roomData: null,\r\n      currentRoomData: null,\r\n      webrtcConnected: false,\r\n      webrtcInitialized: false,\r\n      otherPlayerWasConnected: false, // Track if other player was previously connected\r\n      webrtcConnectedAt: null // Track when WebRTC connected to add grace period\r\n    }\r\n  },\r\n  computed: {\r\n    canStartGame () {\r\n      if (!this.roomData) return false\r\n      const hasPlayer1 = this.roomData.players && this.roomData.players.player1\r\n      const hasPlayer2 = this.roomData.players && this.roomData.players.player2\r\n      return this.isHost && hasPlayer1 && hasPlayer2\r\n    }\r\n  },\r\n  methods: {\r\n    showCreateRoom () {\r\n      this.state = 'create'\r\n      this.error = null\r\n    },\r\n    showJoinRoom () {\r\n      this.state = 'join'\r\n      this.error = null\r\n    },\r\n    backToMenu () {\r\n      this.state = 'menu'\r\n      this.error = null\r\n      this.roomCodeInput = ''\r\n    },\r\n    validateRoomCode () {\r\n      this.roomCodeInput = this.roomCodeInput.replace(/\\D/g, '').slice(0, 5)\r\n    },\r\n    async createRoom () {\r\n      try {\r\n        this.error = null\r\n        const playerName = 'Player 1'\r\n        const { roomCode, playerId } = await roomService.createRoom(playerName)\r\n        this.currentRoomCode = roomCode\r\n        this.isHost = true\r\n        this.state = 'waiting'\r\n\r\n        // Listen for room updates\r\n        roomService.onRoomUpdate(this.handleRoomUpdate)\r\n\r\n        // Store multiplayer info in Vuex\r\n        this.$store.dispatch('setMultiplayerInfo', {\r\n          isMultiplayer: true,\r\n          isHost: true,\r\n          playerId,\r\n          roomCode,\r\n          playerName\r\n        })\r\n      } catch (error) {\r\n        this.error = error.message\r\n        console.error('Error creating room:', error)\r\n      }\r\n    },\r\n    async joinRoom () {\r\n      try {\r\n        this.error = null\r\n        const playerName = 'Player 2'\r\n        const { roomCode, playerId } = await roomService.joinRoom(\r\n          this.roomCodeInput,\r\n          playerName\r\n        )\r\n        this.currentRoomCode = roomCode\r\n        this.isHost = false\r\n        this.state = 'waiting'\r\n\r\n        // Listen for room updates\r\n        roomService.onRoomUpdate(this.handleRoomUpdate)\r\n\r\n        // Store multiplayer info in Vuex\r\n        this.$store.dispatch('setMultiplayerInfo', {\r\n          isMultiplayer: true,\r\n          isHost: false,\r\n          playerId,\r\n          roomCode,\r\n          playerName\r\n        })\r\n      } catch (error) {\r\n        this.error = error.message\r\n        console.error('Error joining room:', error)\r\n      }\r\n    },\r\n    async handleRoomUpdate (data) {\r\n      this.roomData = data\r\n\r\n      // Only check for disconnection if:\r\n      // 1. We're not actively connecting\r\n      // 2. We have a WebRTC connection established\r\n      // 3. At least 3 seconds have passed since WebRTC connected (grace period for initialization)\r\n      const gracePeriodMs = 15000\r\n      const timeSinceConnect = this.webrtcConnectedAt ? Date.now() - this.webrtcConnectedAt : Infinity\r\n      \r\n      if (this.state !== 'connecting' && this.webrtcConnected && timeSinceConnect > gracePeriodMs) {\r\n        const myPlayerId = this.isHost ? 'player1' : 'player2'\r\n        const otherPlayerId = this.isHost ? 'player2' : 'player1'\r\n        \r\n        if (data.players && data.players[otherPlayerId]) {\r\n          const otherPlayerConnected = data.players[otherPlayerId].connected\r\n          \r\n          // If other player was previously connected but is now disconnected, show error\r\n          if (this.otherPlayerWasConnected && !otherPlayerConnected) {\r\n            console.log('⚠️ Other player disconnected')\r\n            \r\n            // Clean up connections\r\n            webrtcService.destroy()\r\n            await roomService.disconnect()\r\n            if (this.isHost) {\r\n              await roomService.deleteRoom()\r\n            }\r\n            \r\n            // Reset multiplayer state\r\n            this.$store.dispatch('resetMultiplayer')\r\n            \r\n            // Return to lobby with error message\r\n            this.error = '接続が切断されました'\r\n            this.state = 'menu'\r\n            this.webrtcConnected = false\r\n            this.webrtcInitialized = false\r\n            this.currentRoomCode = null\r\n            this.isHost = false\r\n            this.otherPlayerWasConnected = false\r\n            this.webrtcConnectedAt = null\r\n            \r\n            // Also return to lobby mode if we're in game\r\n            if (this.$store.state.mode === 'play') {\r\n              this.$store.dispatch('mode', 'lobby')\r\n            }\r\n            \r\n            return\r\n          }\r\n          \r\n          // Update tracking of other player's connection state\r\n          if (otherPlayerConnected) {\r\n            this.otherPlayerWasConnected = true\r\n          }\r\n        } else if (this.otherPlayerWasConnected && data.players) {\r\n          // Other player disappeared from room data (disconnected and removed)\r\n          console.log('⚠️ Other player disconnected (removed from room)')\r\n          \r\n          // Clean up connections\r\n          webrtcService.destroy()\r\n          await roomService.disconnect()\r\n          if (this.isHost) {\r\n            await roomService.deleteRoom()\r\n          }\r\n          \r\n          // Reset multiplayer state\r\n          this.$store.dispatch('resetMultiplayer')\r\n          \r\n          // Return to lobby with error message\r\n          this.error = '接続が切断されました'\r\n          this.state = 'menu'\r\n          this.webrtcConnected = false\r\n          this.webrtcInitialized = false\r\n          this.currentRoomCode = null\r\n          this.isHost = false\r\n          this.otherPlayerWasConnected = false\r\n          this.webrtcConnectedAt = null\r\n          \r\n          // Also return to lobby mode if we're in game\r\n          if (this.$store.state.mode === 'play') {\r\n            this.$store.dispatch('mode', 'lobby')\r\n          }\r\n          \r\n          return\r\n        }\r\n      } else if (data.players) {\r\n        // During initial connection or before WebRTC is established, track connection state\r\n        const otherPlayerId = this.isHost ? 'player2' : 'player1'\r\n        if (data.players[otherPlayerId] && data.players[otherPlayerId].connected) {\r\n          this.otherPlayerWasConnected = true\r\n        }\r\n      }\r\n\r\n      // Check if both players are present and roles are assigned\r\n      if (\r\n        data.players.player1 &&\r\n        data.players.player2 &&\r\n        data.players.player1.role &&\r\n        data.players.player2.role &&\r\n        data.gameState.status === 'ready' &&\r\n        !this.webrtcInitialized\r\n      ) {\r\n        // Start WebRTC connection\r\n        this.webrtcInitialized = true\r\n        await this.initWebRTC(data)\r\n      }\r\n\r\n      // Update Vuex store with room data\r\n      this.$store.dispatch('updateMultiplayerRoom', data)\r\n    },\r\n    async initWebRTC (roomData) {\r\n      this.state = 'connecting'\r\n\r\n      // Store roomData and store reference for callbacks to persist after component destruction\r\n      this.currentRoomData = roomData\r\n      const store = this.$store\r\n\r\n      try {\r\n        // Short delay to ensure Firebase is ready\r\n        await new Promise(resolve => setTimeout(resolve, 500))\r\n\r\n        if (this.isHost) {\r\n          // Player 1 is the initiator\r\n          console.log('Initializing as host (initiator)')\r\n          webrtcService.initAsInitiator()\r\n        } else {\r\n          // Player 2 is the receiver\r\n          console.log('Initializing as guest (receiver)')\r\n          webrtcService.initAsReceiver()\r\n        }\r\n\r\n        // Handle outgoing signals with retry logic for slow connections\r\n        webrtcService.onSignal(async (signal) => {\r\n          console.log('Sending signal:', signal.type || 'candidate')\r\n\r\n          const sendWithRetry = async (fn, retries = 3) => {\r\n            for (let i = 0; i < retries; i++) {\r\n              try {\r\n                await fn()\r\n                return\r\n              } catch (err) {\r\n                console.error(`Error sending signal (attempt ${i + 1}/${retries}):`, err)\r\n                if (i < retries - 1) {\r\n                  await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)))\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n          try {\r\n            if (signal.type === 'offer') {\r\n              await sendWithRetry(() => roomService.setRTCOffer(signal))\r\n            } else if (signal.type === 'answer') {\r\n              await sendWithRetry(() => roomService.setRTCAnswer(signal))\r\n            } else {\r\n              await sendWithRetry(() => roomService.addICECandidate(signal))\r\n            }\r\n          } catch (err) {\r\n            console.error('Failed to send signal after retries:', err)\r\n          }\r\n        })\r\n\r\n        // Handle incoming signals from Firebase\r\n        // Process signals even after connection for reconnection scenarios\r\n        if (this.isHost) {\r\n          // Host waits for guest's answer\r\n          console.log('Host: Waiting for answer...')\r\n          roomService.roomRef.child('players/player2/rtcAnswer').on('value', (snapshot) => {\r\n            const answer = snapshot.val()\r\n            if (answer) {\r\n              console.log('Host: Received answer, signaling...')\r\n              try {\r\n                webrtcService.signal(answer)\r\n              } catch (err) {\r\n                console.error('Error processing answer:', err)\r\n              }\r\n            }\r\n          })\r\n\r\n          // Also listen for ICE candidates with batching for slow connections\r\n          let candidateBuffer = []\r\n          let candidateTimer = null\r\n          roomService.roomRef.child('players/player2/iceCandidates').on('child_added', (snapshot) => {\r\n            const candidate = snapshot.val()\r\n            if (candidate) {\r\n              console.log('Host: Received ICE candidate')\r\n              candidateBuffer.push(candidate)\r\n              \r\n              // Process candidates in batches to reduce overhead on slow devices\r\n              if (candidateTimer) clearTimeout(candidateTimer)\r\n              candidateTimer = setTimeout(() => {\r\n                candidateBuffer.forEach(c => {\r\n                  try {\r\n                    webrtcService.signal(c)\r\n                  } catch (err) {\r\n                    console.error('Error processing ICE candidate:', err)\r\n                  }\r\n                })\r\n                candidateBuffer = []\r\n              }, 100)\r\n            }\r\n          })\r\n        } else {\r\n          // Guest waits for host's offer\r\n          console.log('Guest: Waiting for offer...')\r\n          roomService.roomRef.child('players/player1/rtcOffer').on('value', (snapshot) => {\r\n            const offer = snapshot.val()\r\n            if (offer) {\r\n              console.log('Guest: Received offer, signaling...')\r\n              try {\r\n                webrtcService.signal(offer)\r\n              } catch (err) {\r\n                console.error('Error processing offer:', err)\r\n              }\r\n            }\r\n          })\r\n\r\n          // Also listen for ICE candidates with batching for slow connections\r\n          let candidateBuffer = []\r\n          let candidateTimer = null\r\n          roomService.roomRef.child('players/player1/iceCandidates').on('child_added', (snapshot) => {\r\n            const candidate = snapshot.val()\r\n            if (candidate) {\r\n              console.log('Guest: Received ICE candidate')\r\n              candidateBuffer.push(candidate)\r\n              \r\n              // Process candidates in batches to reduce overhead on slow devices\r\n              if (candidateTimer) clearTimeout(candidateTimer)\r\n              candidateTimer = setTimeout(() => {\r\n                candidateBuffer.forEach(c => {\r\n                  try {\r\n                    webrtcService.signal(c)\r\n                  } catch (err) {\r\n                    console.error('Error processing ICE candidate:', err)\r\n                  }\r\n                })\r\n                candidateBuffer = []\r\n              }, 100)\r\n            }\r\n          })\r\n        }\r\n\r\n        // Handle connection established\r\n        webrtcService.onConnected(() => {\r\n          console.log('✅ WebRTC connection established!')\r\n          this.webrtcConnected = true\r\n          this.webrtcConnectedAt = Date.now() // Record connection time\r\n          store.dispatch('setWebRTCConnected', true)\r\n          \r\n          // Mark other player as connected now that we have WebRTC connection\r\n          if (this.currentRoomData && this.currentRoomData.players) {\r\n            const otherPlayerId = this.isHost ? 'player2' : 'player1'\r\n            if (this.currentRoomData.players[otherPlayerId] && this.currentRoomData.players[otherPlayerId].connected) {\r\n              this.otherPlayerWasConnected = true\r\n            }\r\n          }\r\n\r\n          // Get my player info\r\n          const myPlayerId = this.isHost ? 'player1' : 'player2'\r\n          const myPlayerData = this.currentRoomData.players[myPlayerId]\r\n\r\n          // Determine which player has the 'player' role and set activePlayerCharacter\r\n          const player1Data = this.currentRoomData.players.player1\r\n          const player2Data = this.currentRoomData.players.player2\r\n          const activePlayerCharacter = player1Data.role === 'player' ? player1Data.character : player2Data.character\r\n\r\n          store.dispatch('setPlayerRole', myPlayerData.role)\r\n          store.commit('selectCharacter', myPlayerData.character)\r\n          store.commit('setMultiplayerInfo', {\r\n            ...store.state.multiplayer,\r\n            activePlayerCharacter\r\n          })\r\n          \r\n          // Only the player starts the level and picks candy house\r\n          if (myPlayerData.role === 'player') {\r\n            store.dispatch('startLevel', 0)\r\n            store.dispatch('mode', 'play')\r\n            \r\n            // Send initial game state to guide with candy house index\r\n            // Use a longer delay to ensure the guide's message handler is ready\r\n            setTimeout(() => {\r\n              const webrtcService = require('../services/webrtcService').default\r\n              console.log('📤 Player sending initialSync with candyHouseIndex:', store.state.candyHouseIndex)\r\n              console.log('📤 Full initialSync data:', {\r\n                type: 'initialSync',\r\n                level: 0,\r\n                candyHouseIndex: store.state.candyHouseIndex,\r\n                map: store.state.map ? 'map exists' : 'no map',\r\n                score: store.state.score,\r\n                facing: store.state.facing\r\n              })\r\n              webrtcService.sendGameState({\r\n                type: 'initialSync',\r\n                level: 0,\r\n                candyHouseIndex: store.state.candyHouseIndex,\r\n                map: store.state.map,\r\n                score: store.state.score,\r\n                facing: store.state.facing,\r\n                activePlayerCharacter: store.state.multiplayer.activePlayerCharacter\r\n              })\r\n            }, 500)\r\n          } else {\r\n            // Guide: Set mode to play immediately (map will load when initialSync arrives)\r\n            store.dispatch('mode', 'play')\r\n          }\r\n        })\r\n\r\n        // Handle incoming messages - store reference persists after component destruction\r\n        webrtcService.onMessage((message) => {\r\n          console.log('🎯 Lobby: Message callback triggered')\r\n          store.dispatch('handleMultiplayerMessage', message)\r\n        })\r\n\r\n        // Handle disconnection: do not immediately tear down; allow auto-reconnect within grace period\r\n        webrtcService.onDisconnected(() => {\r\n          this.webrtcConnected = false\r\n          store.dispatch('setWebRTCConnected', false)\r\n        })\r\n\r\n        // Fallback: Start game even if WebRTC fails (game state will use Firebase only)\r\n        // Longer timeout for slow connections and low-end devices\r\n        setTimeout(() => {\r\n          if (!this.webrtcConnected && this.state === 'connecting') {\r\n            console.log('⚠️ WebRTC timeout after 30s - starting without P2P')\r\n            const myPlayerId = this.isHost ? 'player1' : 'player2'\r\n            const myPlayerData = this.currentRoomData.players[myPlayerId]\r\n\r\n            // Determine which player has the 'player' role and set activePlayerCharacter\r\n            const player1Data = this.currentRoomData.players.player1\r\n            const player2Data = this.currentRoomData.players.player2\r\n            const activePlayerCharacter = player1Data.role === 'player' ? player1Data.character : player2Data.character\r\n\r\n            store.dispatch('setPlayerRole', myPlayerData.role)\r\n            store.commit('selectCharacter', myPlayerData.character)\r\n            store.commit('setMultiplayerInfo', {\r\n              ...store.state.multiplayer,\r\n              activePlayerCharacter\r\n            })\r\n            \r\n            // Only player starts level in fallback mode too\r\n            if (myPlayerData.role === 'player') {\r\n              store.dispatch('startLevel', 0)\r\n              store.dispatch('mode', 'play')\r\n            } else {\r\n              // Guide in fallback mode - just start with level 0 (no sync available)\r\n              store.dispatch('startLevel', 0)\r\n              store.dispatch('mode', 'play')\r\n            }\r\n          }\r\n        }, 30000) // 30 second timeout for slow connections\r\n      } catch (error) {\r\n        console.error('Error initializing WebRTC:', error)\r\n        this.error = 'Connection setup failed: ' + error.message\r\n      }\r\n    },\r\n    async startGame () {\r\n      if (!this.canStartGame) return\r\n\r\n      try {\r\n        // Assign roles and characters randomly\r\n        await roomService.assignRolesAndCharacters()\r\n      } catch (error) {\r\n        console.error('Error starting game:', error)\r\n        this.error = 'Failed to start game'\r\n      }\r\n    },\r\n    async leaveRoom () {\r\n      await roomService.disconnect()\r\n      if (this.isHost) {\r\n        await roomService.deleteRoom()\r\n      }\r\n      webrtcService.destroy()\r\n      this.$store.dispatch('resetMultiplayer')\r\n      this.backToMenu()\r\n    },\r\n    async handleDisconnection () {\r\n      // Clean up connections\r\n      webrtcService.destroy()\r\n      await roomService.disconnect()\r\n      if (this.isHost) {\r\n        await roomService.deleteRoom()\r\n      }\r\n\r\n      // Reset multiplayer state\r\n      this.$store.dispatch('resetMultiplayer')\r\n\r\n      // Return to lobby with error message\r\n      this.error = '接続が切断されました'\r\n      this.state = 'menu'\r\n      this.webrtcConnected = false\r\n      this.webrtcInitialized = false\r\n      this.currentRoomCode = null\r\n      this.isHost = false\r\n\r\n      // Also return to lobby mode if we're in game\r\n      if (this.$store.state.mode === 'play') {\r\n        this.$store.dispatch('mode', 'lobby')\r\n      }\r\n    }\r\n  },\r\n  beforeDestroy () {\r\n    // Clean up Firebase listeners\r\n    roomService.disconnect()\r\n\r\n    // Only destroy WebRTC if we're NOT connected or game hasn't started\r\n    // Keep WebRTC alive if connection succeeded and game is starting\r\n    if (!this.webrtcConnected) {\r\n      console.log('Lobby destroyed, cleaning up WebRTC (not connected)')\r\n      webrtcService.destroy()\r\n    } else {\r\n      console.log('Lobby destroyed, keeping WebRTC alive for game')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.lobby {\r\n  position: absolute;\r\n  z-index: 1;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .lobby-container {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 90%;\r\n    max-width: 25rem;\r\n    background-color: #382440;\r\n    border-radius: 1rem;\r\n    padding: 2rem;\r\n    box-sizing: border-box;\r\n\r\n    h1 {\r\n      margin: 0 0 1rem 0;\r\n      font-size: 2rem;\r\n      line-height: 2.5rem;\r\n      color: #ddd;\r\n    }\r\n\r\n    h2 {\r\n      margin: 0 0 1rem 0;\r\n      font-size: 1.5rem;\r\n      color: #ddd;\r\n    }\r\n\r\n    p {\r\n      margin: 0.5rem 0;\r\n      font-size: 1rem;\r\n      color: #ccc;\r\n    }\r\n\r\n    .info-text {\r\n      font-size: 1.1rem;\r\n      color: #ddd;\r\n      margin: 1rem 0;\r\n\r\n      strong {\r\n        color: #fa0;\r\n      }\r\n    }\r\n\r\n    .input-field {\r\n      width: 100%;\r\n      padding: 0.75rem;\r\n      margin: 0.5rem 0;\r\n      font-size: 1.25rem;\r\n      font-family: 'Underdog', sans-serif;\r\n      background-color: #40408a;\r\n      color: #ddd;\r\n      border: 2px solid #555;\r\n      border-radius: 0.5rem;\r\n      box-sizing: border-box;\r\n      text-align: center;\r\n\r\n      &::placeholder {\r\n        color: #999;\r\n      }\r\n\r\n      &:focus {\r\n        outline: none;\r\n        border-color: #fa0;\r\n      }\r\n    }\r\n\r\n    .control.options {\r\n      width: 100%;\r\n      height: 3rem;\r\n      line-height: 3rem;\r\n      font-size: 1.5rem;\r\n      margin: 0.5rem 0;\r\n\r\n      &:disabled {\r\n        opacity: 0.5;\r\n        cursor: not-allowed;\r\n      }\r\n\r\n      &.back-btn {\r\n        background-color: #666;\r\n        font-size: 1.25rem;\r\n      }\r\n    }\r\n\r\n    .error {\r\n      color: #ff6b6b;\r\n      font-size: 0.9rem;\r\n      margin-top: 0.5rem;\r\n    }\r\n\r\n    .room-code-display {\r\n      font-size: 3rem;\r\n      font-weight: bold;\r\n      color: #fa0;\r\n      margin: 1rem 0;\r\n      letter-spacing: 0.5rem;\r\n    }\r\n\r\n    .players-list {\r\n      margin: 1.5rem 0;\r\n\r\n      .player-item {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        padding: 0.75rem;\r\n        margin: 0.5rem 0;\r\n        background-color: #40408a;\r\n        border-radius: 0.5rem;\r\n        font-size: 1.25rem;\r\n\r\n        &.empty {\r\n          opacity: 0.5;\r\n        }\r\n\r\n        .status-connected {\r\n          color: #4caf50;\r\n          font-size: 1.5rem;\r\n        }\r\n      }\r\n    }\r\n\r\n    .spinner {\r\n      width: 3rem;\r\n      height: 3rem;\r\n      margin: 2rem auto;\r\n      border: 4px solid #555;\r\n      border-top: 4px solid #fa0;\r\n      border-radius: 50%;\r\n      animation: spin 1s linear infinite;\r\n    }\r\n  }\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lobby.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lobby.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Lobby.vue?vue&type=template&id=538904ea&scoped=true&\"\nimport script from \"./Lobby.vue?vue&type=script&lang=js&\"\nexport * from \"./Lobby.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Lobby.vue?vue&type=style&index=0&id=538904ea&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"538904ea\",\n  null\n  \n)\n\ncomponent.options.__file = \"Lobby.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.overlayActive)?_c('div',{staticClass:\"interaction-overlay\"},[_c('div',{staticClass:\"overlay-content\"},[_c('h1',{staticClass:\"overlay-message\"},[_vm._v(_vm._s(_vm.overlayMessage))]),_c('div',{ref:\"animationContainer\",staticClass:\"animation-container\"})])]):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div v-if=\"overlayActive\" class=\"interaction-overlay\">\n    <div class=\"overlay-content\">\n      <h1 class=\"overlay-message\">{{ overlayMessage }}</h1>\n      <div class=\"animation-container\" ref=\"animationContainer\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport lottie from 'lottie-web'\n\nexport default {\n  name: 'InteractionOverlay',\n  data () {\n    return {\n      animation: null\n    }\n  },\n  computed: {\n    ...mapGetters(['overlayActive', 'overlayType', 'overlayMessage'])\n  },\n  watch: {\n    overlayActive (newVal) {\n      if (newVal) {\n        this.$nextTick(() => {\n          this.loadAnimation()\n        })\n      } else {\n        this.cleanup()\n      }\n    }\n  },\n  methods: {\n    loadAnimation () {\n      if (!this.$refs.animationContainer) return\n\n      // Determine which animation to load\n      const animationPath = this.overlayType === 'success' \n        ? 'lottie/candy.json' \n        : 'lottie/homework.json'\n\n      // Load and play the Lottie animation\n      this.animation = lottie.loadAnimation({\n        container: this.$refs.animationContainer,\n        renderer: 'svg',\n        loop: true,\n        autoplay: true,\n        path: animationPath\n      })\n    },\n    cleanup () {\n      if (this.animation) {\n        this.animation.destroy()\n        this.animation = null\n      }\n    }\n  },\n  beforeDestroy () {\n    this.cleanup()\n  }\n}\n</script>\n\n<style scoped>\n.interaction-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.8);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.overlay-content {\n  text-align: center;\n  color: white;\n}\n\n.overlay-message {\n  font-size: 3rem;\n  margin-bottom: 2rem;\n  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);\n}\n\n.animation-container {\n  width: 300px;\n  height: 300px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 0 auto;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InteractionOverlay.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InteractionOverlay.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./InteractionOverlay.vue?vue&type=template&id=98180e24&scoped=true&\"\nimport script from \"./InteractionOverlay.vue?vue&type=script&lang=js&\"\nexport * from \"./InteractionOverlay.vue?vue&type=script&lang=js&\"\nimport style0 from \"./InteractionOverlay.vue?vue&type=style&index=0&id=98180e24&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"98180e24\",\n  null\n  \n)\n\ncomponent.options.__file = \"InteractionOverlay.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"directions-helper\"},[_vm._m(0),_c('div',{staticClass:\"helper-content\"},[_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'gostraight.png',\"alt\":\"Go straight\"}}),_vm._m(1)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'gostraightlittle.png',\"alt\":\"Go straight a little\"}}),_vm._m(2)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'turnright.png',\"alt\":\"Turn right\"}}),_vm._m(3)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'turnleft.png',\"alt\":\"Turn left\"}}),_vm._m(4)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'seeleft.png',\"alt\":\"See left\"}}),_vm._m(5)]),_c('div',{staticClass:\"direction-item\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.baseUrl + 'seeright.png',\"alt\":\"See right\"}}),_vm._m(6)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"helper-header\"},[_c('h3',[_vm._v(\"方向の伝え方\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_vm._v(\"Go straight for \"),_c('strong',[_vm._v(\"〇 block(s)\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_vm._v(\"Go straight for \"),_c('strong',[_vm._v(\"a little bit\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_c('strong',[_vm._v(\"Turn right\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_c('strong',[_vm._v(\"Turn left\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_vm._v(\"You can see it on your \"),_c('strong',[_vm._v(\"left\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"text\"},[_vm._v(\"You can see it on your \"),_c('strong',[_vm._v(\"right\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"directions-helper\">\r\n    <div class=\"helper-header\">\r\n      <h3>方向の伝え方</h3>\r\n    </div>\r\n    <div class=\"helper-content\">\r\n      <div class=\"direction-item\">\r\n        <img :src=\"baseUrl + 'gostraight.png'\" alt=\"Go straight\" class=\"icon\" />\r\n        <span class=\"text\">Go straight for <strong>〇 block(s)</strong></span>\r\n      </div>\r\n      <div class=\"direction-item\">\r\n        <img :src=\"baseUrl + 'gostraightlittle.png'\" alt=\"Go straight a little\" class=\"icon\" />\r\n        <span class=\"text\">Go straight for <strong>a little bit</strong></span>\r\n      </div>\r\n      <div class=\"direction-item\">\r\n        <img :src=\"baseUrl + 'turnright.png'\" alt=\"Turn right\" class=\"icon\" />\r\n        <span class=\"text\"><strong>Turn right</strong></span>\r\n      </div>\r\n      <div class=\"direction-item\">\r\n        <img :src=\"baseUrl + 'turnleft.png'\" alt=\"Turn left\" class=\"icon\" />\r\n        <span class=\"text\"><strong>Turn left</strong></span>\r\n      </div>\r\n      <div class=\"direction-item\">\r\n        <img :src=\"baseUrl + 'seeleft.png'\" alt=\"See left\" class=\"icon\" />\r\n        <span class=\"text\">You can see it on your <strong>left</strong></span>\r\n      </div>\r\n      <div class=\"direction-item\">\r\n        <img :src=\"baseUrl + 'seeright.png'\" alt=\"See right\" class=\"icon\" />\r\n        <span class=\"text\">You can see it on your <strong>right</strong></span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'DirectionsHelper',\r\n  computed: {\r\n    baseUrl () {\r\n      return process.env.BASE_URL\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.directions-helper {\r\n  position: fixed;\r\n  top: 50%;\r\n  left: 1rem;\r\n  right: 1rem;\r\n  transform: translateY(-50%);\r\n  max-width: 25rem;\r\n  background-color: rgba(56, 36, 64, 0.95);\r\n  border-radius: 1rem;\r\n  padding: 1rem;\r\n  z-index: 999;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\r\n\r\n  .helper-header {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    margin-bottom: 0.5rem;\r\n\r\n    h3 {\r\n      margin: 0;\r\n      font-size: 1.25rem;\r\n      color: #fa0;\r\n      font-family: 'Stick', sans-serif;\r\n      text-align: center;\r\n      width: 100%;\r\n    }\r\n\r\n  }\r\n\r\n  .helper-content {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 0.75rem;\r\n  }\r\n\r\n  .direction-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.75rem;\r\n    padding: 0.5rem;\r\n    background-color: rgba(64, 64, 138, 0.3);\r\n    border-radius: 0.5rem;\r\n    transition: background-color 0.2s;\r\n\r\n    &:hover {\r\n      background-color: rgba(64, 64, 138, 0.5);\r\n    }\r\n\r\n    .icon {\r\n      width: 2rem;\r\n      height: 2rem;\r\n      flex-shrink: 0;\r\n      object-fit: contain;\r\n    }\r\n\r\n    .text {\r\n      font-size: 1rem;\r\n      color: #ddd;\r\n      font-family: 'Underdog', sans-serif;\r\n      line-height: 1.4;\r\n\r\n      strong {\r\n        color: #fa0;\r\n        font-weight: normal;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .directions-helper {\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n    left: 0.5rem;\r\n    right: 0.5rem;\r\n    padding: 0.75rem;\r\n\r\n    .helper-header h3 {\r\n      font-size: 1rem;\r\n    }\r\n\r\n    .direction-item {\r\n      padding: 0.4rem;\r\n      gap: 0.5rem;\r\n\r\n      .icon {\r\n        width: 1.5rem;\r\n        height: 1.5rem;\r\n      }\r\n\r\n      .text {\r\n        font-size: 0.875rem;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DirectionsHelper.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DirectionsHelper.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DirectionsHelper.vue?vue&type=template&id=06aac514&scoped=true&\"\nimport script from \"./DirectionsHelper.vue?vue&type=script&lang=js&\"\nexport * from \"./DirectionsHelper.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DirectionsHelper.vue?vue&type=style&index=0&id=06aac514&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"06aac514\",\n  null\n  \n)\n\ncomponent.options.__file = \"DirectionsHelper.vue\"\nexport default component.exports","<template>\r\n  <div id=\"app\">\r\n    <GameThree />\r\n    <Lobby v-if=\"mode === 'lobby'\" />\r\n    <Controls v-if=\"mode === 'play'\" />\r\n    <LevelSelect v-if=\"mode === 'levelSelect'\" />\r\n    <LevelWin v-if=\"mode === 'levelWin'\" />\r\n    <CharacterSelect v-if=\"mode === 'characterSelect'\" />\r\n    <MapEditor v-if=\"mode === 'mapEditor'\" />\r\n    <InteractionOverlay />\r\n    \r\n    <!-- QR Code Button - Only visible on lobby/pause screens -->\r\n    <div v-if=\"showQRButton\" class=\"qr-code-button\" @click.stop=\"toggleQRCode\">\r\n      <img :src=\"baseUrl + 'qricon.png'\" alt=\"QR Code\" class=\"qr-icon\" />\r\n    </div>\r\n    \r\n    <!-- QR Code Modal -->\r\n    <div v-if=\"showQR\" class=\"qr-modal\" @click=\"toggleQRCode\">\r\n      <div class=\"qr-content\" @click.stop>\r\n        <div class=\"qr-placeholder\">\r\n          <img :src=\"baseUrl + 'qrcode.png'\" alt=\"QR Code\" />\r\n        </div>\r\n        <button class=\"close-qr\" @click=\"toggleQRCode\">Close</button>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- Directions Helper -->\r\n    <DirectionsHelper v-if=\"mode === 'lobby'\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport Controls from './components/Controls'\r\nimport LevelSelect from './components/LevelSelect'\r\nimport LevelWin from './components/LevelWin'\r\nimport GameThree from './components/GameThree'\r\nimport CharacterSelect from './components/CharacterSelect'\r\nimport MapEditor from './components/MapEditor'\r\nimport Lobby from './components/Lobby'\r\nimport InteractionOverlay from './components/InteractionOverlay'\r\nimport DirectionsHelper from './components/DirectionsHelper'\r\nimport roomService from './services/roomService'\r\n\r\nexport default {\r\n  name: 'app',\r\n  components: {\r\n    CharacterSelect,\r\n    Controls,\r\n    LevelSelect,\r\n    LevelWin,\r\n    GameThree,\r\n    MapEditor,\r\n    Lobby,\r\n    InteractionOverlay,\r\n    DirectionsHelper\r\n  },\r\n  data () {\r\n    return {\r\n      showQR: false\r\n    }\r\n  },\r\n  async mounted () {\r\n    this.$store.dispatch('loadLevels')\r\n    // Start periodic cleanup of old/stale rooms (runs every 10 minutes)\r\n    roomService.startPeriodicCleanup(10)\r\n  },\r\n  methods: {\r\n    toggleQRCode () {\r\n      this.showQR = !this.showQR\r\n    },\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'mode'\r\n    ]),\r\n    baseUrl () {\r\n      return process.env.BASE_URL\r\n    },\r\n    showQRButton () {\r\n      // Show QR code button only on lobby or pause (levelSelect) screens\r\n      return this.mode === 'lobby' || this.mode === 'levelSelect'\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\nhtml, body {\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\nbody {\r\n  background-color: #5d3758;\r\n}\r\n\r\nbody *,\r\nbody *:before,\r\nbody *:after {\r\n  box-sizing: border-box;\r\n}\r\n#app {\r\n  font-family: 'Underdog', sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n  text-align: center;\r\n  color: #ccc;\r\n  height: 100%;\r\n}\r\n\r\n.control {\r\n  display: inline-block;\r\n  margin: 0.5rem;\r\n  cursor: pointer;\r\n  position: relative;\r\n  text-align: center;\r\n  line-height: 3.5rem;\r\n  font-size: 3rem;\r\n  border-radius: 1rem;\r\n  background-color: #40408a;\r\n  color: #ddd;\r\n  width: 4rem;\r\n  height: 4rem;\r\n  -moz-appearance: none;\r\n  -webkit-appearance: none;\r\n  border: none;\r\n  outline: none;\r\n  font-family: 'Underdog', sans-serif;\r\n\r\n  &.active,\r\n  &:active {\r\n    background-color: #ddd;\r\n    color: #fa0;\r\n    outline: none;\r\n\r\n    svg {\r\n      path {\r\n        fill: #fa0;\r\n      }\r\n    }\r\n  }\r\n\r\n  svg {\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n\r\n    path {\r\n      fill: #ddd;\r\n    }\r\n  }\r\n\r\n  .control-icon {\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: contain;\r\n  }\r\n}\r\n\r\n.qr-code-button {\r\n  position: fixed;\r\n  bottom: 1rem;\r\n  left: 1rem;\r\n  width: 3rem;\r\n  height: 3rem;\r\n  background-color: #40408a;\r\n  border-radius: 0.5rem;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  z-index: 1000;\r\n  transition: background-color 0.2s;\r\n\r\n  .qr-icon {\r\n    width: 2rem;\r\n    height: 2rem;\r\n    object-fit: contain;\r\n  }\r\n\r\n  &:hover {\r\n    background-color: #5555aa;\r\n  }\r\n}\r\n\r\n.qr-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.7);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1001;\r\n\r\n  .qr-content {\r\n    background-color: #382440;\r\n    border-radius: 1rem;\r\n    padding: 2rem;\r\n    max-width: 20rem;\r\n    text-align: center;\r\n\r\n    .qr-placeholder {\r\n      background-color: white;\r\n      padding: 1rem;\r\n      border-radius: 0.5rem;\r\n      margin: 0 0 1rem 0;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n\r\n      img {\r\n        max-width: 100%;\r\n        height: auto;\r\n      }\r\n    }\r\n\r\n    .close-qr {\r\n      background-color: #40408a;\r\n      color: #ddd;\r\n      border: none;\r\n      padding: 0.75rem 2rem;\r\n      border-radius: 0.5rem;\r\n      font-family: 'Underdog', sans-serif;\r\n      font-size: 1rem;\r\n      cursor: pointer;\r\n      margin-top: 0;\r\n\r\n      &:hover {\r\n        background-color: #5555aa;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=00c69100&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"App.vue\"\nexport default component.exports","import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport { event } from 'vue-analytics'\r\n\r\nVue.use(Vuex)\r\n\r\nconst spliceSlice = (str, index, count, add) => {\r\n  return str.slice(0, index) + add + str.slice(index + count)\r\n}\r\n// Uppercase house tiles (walkable/interactive houses)\r\n// Include 'H' as a north-facing standalone house\r\nconst uppercaseHousesRegex = /[QWEDCXZAH]/gm\r\n\r\n// Rotation values matching GameThree.vue directionMap\r\nconst FACING = {\r\n  LEFT: 'left',\r\n  UP: 'up',\r\n  RIGHT: 'right',\r\n  DOWN: 'down'\r\n}\r\n\r\nconst turnLeft = (currentFacing) => {\r\n  const turnMap = {\r\n    [FACING.LEFT]: FACING.DOWN,\r\n    [FACING.DOWN]: FACING.RIGHT,\r\n    [FACING.RIGHT]: FACING.UP,\r\n    [FACING.UP]: FACING.LEFT\r\n  }\r\n  return turnMap[currentFacing]\r\n}\r\n\r\nconst turnRight = (currentFacing) => {\r\n  const turnMap = {\r\n    [FACING.LEFT]: FACING.UP,\r\n    [FACING.UP]: FACING.RIGHT,\r\n    [FACING.RIGHT]: FACING.DOWN,\r\n    [FACING.DOWN]: FACING.LEFT\r\n  }\r\n  return turnMap[currentFacing]\r\n}\r\n\r\n// Direction vectors for graph navigation\r\nconst DIR_VECS = {\r\n  up: { dx: 0, dy: -1 },\r\n  down: { dx: 0, dy: 1 },\r\n  left: { dx: -1, dy: 0 },\r\n  right: { dx: 1, dy: 0 }\r\n}\r\n\r\n// Pick the immediate forward neighbor index along the current facing axis\r\n// Chooses the closest neighbor in the facing direction, aligned to the axis\r\nfunction getForwardNeighborIdx (state, fromIdx, facing) {\r\n  const dirVec = DIR_VECS[facing]\r\n  const cur = state.pathNodes[fromIdx]\r\n  const neighbors = Array.from(state.pathAdjacency[fromIdx] || [])\r\n  let nextIdx = null\r\n  let bestDist = Infinity\r\n  neighbors.forEach((nIdx) => {\r\n    const n = state.pathNodes[nIdx]\r\n    const dx = n.x - cur.x\r\n    const dy = n.y - cur.y\r\n    if (dirVec.dx !== 0) {\r\n      if (dy === 0 && Math.sign(dx) === dirVec.dx) {\r\n        const d = Math.abs(dx)\r\n        if (d > 0 && d < bestDist) { bestDist = d; nextIdx = nIdx }\r\n      }\r\n    } else {\r\n      if (dx === 0 && Math.sign(dy) === dirVec.dy) {\r\n        const d = Math.abs(dy)\r\n        if (d > 0 && d < bestDist) { bestDist = d; nextIdx = nIdx }\r\n      }\r\n    }\r\n  })\r\n  return nextIdx\r\n}\r\n\r\n// Detect if a perpendicular branch is available at a node for the given facing\r\nfunction hasPerpendicularBranch (state, atIdx, facing) {\r\n  const dirVec = DIR_VECS[facing]\r\n  const cur = state.pathNodes[atIdx]\r\n  const neighbors = Array.from(state.pathAdjacency[atIdx] || [])\r\n  let hasBranch = false\r\n  neighbors.forEach((nIdx) => {\r\n    const n = state.pathNodes[nIdx]\r\n    const dx = n.x - cur.x\r\n    const dy = n.y - cur.y\r\n    // Opposite/back neighbor\r\n    const isBack = (dirVec.dx !== 0 && Math.sign(dx) === -dirVec.dx && dy === 0) || (dirVec.dy !== 0 && Math.sign(dy) === -dirVec.dy && dx === 0)\r\n    if (isBack) return\r\n    // Perpendicular neighbor if axis switches\r\n    if (dirVec.dx !== 0 && dx === 0 && dy !== 0) hasBranch = true\r\n    if (dirVec.dy !== 0 && dy === 0 && dx !== 0) hasBranch = true\r\n  })\r\n  return hasBranch\r\n}\r\n\r\n// Coordinate/Index helpers that correctly account for newlines between rows\r\n// width = xMax (number of columns), rowStride = width + 1 (includes newline)\r\nconst toIndex = (x, y, xMax) => {\r\n  const rowStride = xMax + 1\r\n  return 1 + (y * rowStride) + x\r\n}\r\nconst fromIndex = (index, xMax) => {\r\n  const rowStride = xMax + 1\r\n  const i = index - 1\r\n  const y = Math.floor(i / rowStride)\r\n  const x = i % rowStride\r\n  return { x, y }\r\n}\r\n\r\nconst getNextPosition = (x, y, xMax, yMax, direction) => {\r\n  let newX = x\r\n  let newY = y\r\n  if (direction === 'up') { newY = Math.max(y - 1, 0) }\r\n  if (direction === 'down') { newY = Math.min(y + 1, yMax) }\r\n  if (direction === 'left') { newX = Math.max(x - 1, 0) }\r\n  if (direction === 'right') { newX = Math.min(x + 1, xMax) }\r\n  return { x: newX, y: newY }\r\n}\r\n\r\nconst canMoveInDirection = (map, x, y, xMax, direction, roadTiles) => {\r\n  const yMax = (map.match(/\\n/g) || []).length - 1\r\n  const next = getNextPosition(x, y, xMax, yMax, direction)\r\n  if (next.x === x && next.y === y) return false // Hit boundary\r\n  const nextIndex = toIndex(next.x, next.y, xMax)\r\n  const charAtNext = map.charAt(nextIndex)\r\n  // Movement is allowed only onto road tiles or exit\r\n  return roadTiles.includes(charAtNext) || charAtNext === '!'\r\n}\r\n\r\nconst isJunction = (map, x, y, xMax, currentDirection, roadTiles) => {\r\n  // A junction is where we can turn (perpendicular directions are available)\r\n  const perpendicular = {\r\n    'up': ['left', 'right'],\r\n    'down': ['left', 'right'],\r\n    'left': ['up', 'down'],\r\n    'right': ['up', 'down']\r\n  }\r\n  const perpendicularDirs = perpendicular[currentDirection] || []\r\n  return perpendicularDirs.some(dir => canMoveInDirection(map, x, y, xMax, dir, roadTiles))\r\n}\r\n\r\nconst canCollectFromHouse = (houseChar, playerDirection) => {\r\n  // Map of which directions each house type faces\r\n  // Player can only collect candy if approaching from a direction the house faces\r\n  const houseFacingMap = {\r\n    'Q': ['up', 'left'], // North-West corner\r\n    'W': ['up'], // North side\r\n    'E': ['up', 'right'], // North-East corner\r\n    'D': ['right'], // East side\r\n    'C': ['down', 'right'], // South-East corner\r\n    'X': ['down'], // South side\r\n    'Z': ['down', 'left'], // South-West corner\r\n    'A': ['left'], // West side\r\n    'H': ['up'] // North-facing house\r\n  }\r\n\r\n  const houseFacings = houseFacingMap[houseChar] || []\r\n  return houseFacings.includes(playerDirection)\r\n}\r\n\r\n// Check if player is adjacent to a house they can interact with\r\n// A house is interactable when the player stands on the street tile that is in one of the\r\n// house's facing directions (house -> player direction). Additionally, require that the\r\n// player is looking toward the house (player -> house direction) to confirm intent.\r\nconst getAdjacentInteractableHouse = (map, x, y, xMax, playerFacing) => {\r\n  const yMax = (map.match(/\\n/g) || []).length - 1\r\n  const dirs = [\r\n    { name: 'up', dx: 0, dy: -1 },\r\n    { name: 'down', dx: 0, dy: 1 },\r\n    { name: 'left', dx: -1, dy: 0 },\r\n    { name: 'right', dx: 1, dy: 0 }\r\n  ]\r\n  const opposite = { up: 'down', down: 'up', left: 'right', right: 'left' }\r\n\r\n  for (const d of dirs) {\r\n    const nx = Math.min(Math.max(x + d.dx, 0), xMax)\r\n    const ny = Math.min(Math.max(y + d.dy, 0), yMax)\r\n    const nIndex = toIndex(nx, ny, xMax)\r\n    const nChar = map.charAt(nIndex)\r\n    if (nChar && nChar.match(uppercaseHousesRegex)) {\r\n      // Direction from house to player is the opposite of d\r\n      const houseToPlayer = opposite[d.name]\r\n      // Player must be on a tile that the house faces\r\n      const okByHouseFacing = canCollectFromHouse(nChar, houseToPlayer)\r\n      // And the player must be facing toward the house\r\n      const okByPlayerFacing = playerFacing === d.name\r\n      if (okByHouseFacing && okByPlayerFacing) {\r\n        return { houseChar: nChar, houseIndex: nIndex }\r\n      }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\nconst changeStateByDirection = (state, direction) => {\r\n  const mapLast = state.map\r\n  const xMax = mapLast.indexOf('\\n', 1) - 1\r\n  const yMax = (mapLast.match(/\\n/g) || []).length - 1\r\n  const gIndexLast = mapLast.indexOf('G', 1)\r\n  const { x: xLast, y: yLast } = fromIndex(gIndexLast, xMax)\r\n  let x = xLast\r\n  let y = yLast\r\n  if (direction === 'up') { y = Math.max(y - 1, 0) }\r\n  if (direction === 'down') { y = Math.min(y + 1, yMax) }\r\n  if (direction === 'left') { x = Math.max(x - 1, 0) }\r\n  if (direction === 'right') { x = Math.min(x + 1, xMax) }\r\n  const newIndex = toIndex(x, y, xMax)\r\n  let gIndex = gIndexLast\r\n  let moves = state.moves\r\n  let score = state.score\r\n  let map = mapLast\r\n  const charAtNewIndex = mapLast.charAt(newIndex)\r\n  if (state.roadTiles.includes(charAtNewIndex)) {\r\n    gIndex = newIndex\r\n    const lastCharAtSpace = state.levels[state.currentLevel].charAt(gIndexLast)\r\n    map = spliceSlice(map, gIndexLast, 1, lastCharAtSpace)\r\n    map = spliceSlice(map, gIndex, 1, 'G')\r\n  }\r\n  // Collect candy when adjacent to a house in the correct facing direction\r\n  if (state.charAtNewIndex && state.charAtNewIndex.match(uppercaseHousesRegex)) {\r\n    const houseChar = state.charAtNewIndex\r\n    const canCollect = canCollectFromHouse(houseChar, direction)\r\n    if (canCollect) {\r\n      score += 1\r\n      const houseIndex = newIndex\r\n      map = spliceSlice(map, houseIndex, 1, houseChar.toLocaleLowerCase())\r\n    }\r\n  }\r\n  if (\r\n    gIndex !== gIndexLast ||\r\n    score !== state.score\r\n  ) {\r\n    moves += 1\r\n  }\r\n  return {\r\n    charAtNewIndex,\r\n    gIndexLast,\r\n    newIndex,\r\n    yLast,\r\n    xLast,\r\n    x,\r\n    y,\r\n    moves,\r\n    score,\r\n    map\r\n  }\r\n}\r\nlet totalWinCount = 0\r\nexport default new Vuex.Store({\r\n  state: {\r\n    charAtNewIndex: null,\r\n    lastDirection: null,\r\n    facing: FACING.LEFT, // Ghost starts facing left\r\n    moves: 0,\r\n    score: 0,\r\n    levels: [],\r\n    levelMeta: [], // [{ nodes: [{x,y}], edges: [{from:{x,y}, to:{x,y}}] }]\r\n    pathNodes: [],\r\n    pathEdges: [],\r\n    pathAdjacency: {}, // nodeIdx -> Set<nodeIdx>\r\n    currentNodeIdx: null,\r\n    roadTiles: [],\r\n    mode: 'lobby',\r\n    modePrevious: 'lobby',\r\n    character: null,\r\n    currentLevel: null,\r\n    map: null,\r\n    candyHouseIndex: null, // Index of the single house that has candy\r\n    overlayActive: false,\r\n    overlayType: null, // 'success' | 'fail'\r\n    overlayMessage: null,\r\n    lastInteractedHouseIndex: null, // Track last house interacted with to prevent double-clicking\r\n    // Multiplayer state\r\n    multiplayer: {\r\n      isMultiplayer: false,\r\n      isHost: false,\r\n      playerId: null,\r\n      roomCode: null,\r\n      playerName: null,\r\n      playerRole: null, // 'player' or 'guide'\r\n      otherPlayerName: null,\r\n      otherPlayerRole: null,\r\n      webrtcConnected: false,\r\n      roomData: null,\r\n      activePlayerCharacter: null, // Character of whoever has 'player' role this round\r\n      otherPlayerWasConnected: false, // Track if other player was previously connected\r\n      webrtcConnectedAt: null // Track when WebRTC connected for grace period\r\n    }\r\n  },\r\n  getters: {\r\n    score: state => {\r\n      return state.score\r\n    },\r\n    moves: state => {\r\n      return state.moves\r\n    },\r\n    map: state => {\r\n      return state.map\r\n    },\r\n    mode: state => {\r\n      return state.mode\r\n    },\r\n    modePrevious: state => {\r\n      return state.modePrevious\r\n    },\r\n    character: state => {\r\n      return state.character\r\n    },\r\n    levels: state => {\r\n      return state.levels\r\n    },\r\n    levelMeta: state => state.levelMeta,\r\n    currentLevel: state => {\r\n      return state.currentLevel\r\n    },\r\n    candyHouseIndex: state => {\r\n      return state.candyHouseIndex\r\n    },\r\n    lastDirection: state => {\r\n      return state.lastDirection\r\n    },\r\n    facing: state => {\r\n      return state.facing\r\n    },\r\n    // Multiplayer getters\r\n    isMultiplayer: state => {\r\n      return state.multiplayer.isMultiplayer\r\n    },\r\n    isHost: state => {\r\n      return state.multiplayer.isHost\r\n    },\r\n    playerRole: state => {\r\n      return state.multiplayer.playerRole\r\n    },\r\n    isPlayer: state => {\r\n      return state.multiplayer.playerRole === 'player'\r\n    },\r\n    isGuide: state => {\r\n      return state.multiplayer.playerRole === 'guide'\r\n    },\r\n    webrtcConnected: state => {\r\n      return state.multiplayer.webrtcConnected\r\n    },\r\n    roomData: state => {\r\n      return state.multiplayer.roomData\r\n    },\r\n    playerId: state => {\r\n      return state.multiplayer.playerId\r\n    },\r\n    activePlayerCharacter: state => {\r\n      return state.multiplayer.activePlayerCharacter\r\n    },\r\n    overlayActive: state => state.overlayActive,\r\n    overlayType: state => state.overlayType,\r\n    overlayMessage: state => state.overlayMessage,\r\n    canTrickOrTreat: state => {\r\n      // Check if player is facing a house they can interact with\r\n      if (!state.map || state.overlayActive) return false\r\n      \r\n      const gIndex = state.map.indexOf('G', 1)\r\n      if (gIndex < 0) return false\r\n      \r\n      const xMax = state.map.indexOf('\\n', 1) - 1\r\n      const { x, y } = fromIndex(gIndex, xMax)\r\n      const house = getAdjacentInteractableHouse(state.map, x, y, xMax, state.facing)\r\n      \r\n      // Don't show button if no house or if it's the same house we just interacted with\r\n      if (!house) return false\r\n      if (house.houseIndex === state.lastInteractedHouseIndex) return false\r\n      \r\n      return true\r\n    }\r\n  },\r\n  mutations: {\r\n    setLevels (state, payload) {\r\n      state.roadTiles = payload.roadTiles\r\n      state.levels = payload.levels\r\n      state.levelMeta = payload.levelMeta || []\r\n    },\r\n    startLevel (state, payload) {\r\n      // payload can be a number (level index) or an object { level, candyHouseIndex, keepScore }\r\n      const levelIndex = typeof payload === 'object' ? payload.level : payload\r\n      const providedCandyIndex = typeof payload === 'object' ? payload.candyHouseIndex : null\r\n      const keepScore = typeof payload === 'object' ? payload.keepScore : false\r\n      \r\n      state.currentLevel = levelIndex\r\n      state.map = state.levels.length ? state.levels[state.currentLevel].replace('S', 'G') : null\r\n      \r\n      // Only reset score if not keeping it (for role switches, we keep the score)\r\n      if (!keepScore) {\r\n        state.score = 0\r\n      }\r\n      \r\n      state.moves = 0\r\n      state.facing = FACING.LEFT // Reset facing to left at start\r\n      state.lastInteractedHouseIndex = null // Reset interaction tracking\r\n\r\n      // Pick ONE random house to have candy\r\n      // In multiplayer, only pick if not provided (i.e., only the player/host picks)\r\n      if (state.map) {\r\n        if (providedCandyIndex !== null && providedCandyIndex !== undefined) {\r\n          // Use the provided candy house index (synced from other player)\r\n          state.candyHouseIndex = providedCandyIndex\r\n          console.log('🍬 Candy house synced from other player:', providedCandyIndex)\r\n        } else {\r\n          // Pick a random house\r\n          const houses = state.map.match(uppercaseHousesRegex)\r\n          if (houses && houses.length > 0) {\r\n            const randomHouseNum = Math.floor(Math.random() * houses.length)\r\n            // Find the index of the Nth house in the map\r\n            let houseCount = 0\r\n            for (let i = 0; i < state.map.length; i++) {\r\n              if (state.map[i].match(uppercaseHousesRegex)) {\r\n                if (houseCount === randomHouseNum) {\r\n                  // Store the STRING index (includes newlines) for rendering\r\n                  state.candyHouseIndex = i\r\n                  const xMax = state.map.indexOf('\\n', 1) - 1\r\n                  const { x, y } = fromIndex(i, xMax)\r\n                  console.log('🍬 Candy house selected:')\r\n                  console.log('  stringIndex:', i)\r\n                  console.log('  position:', { x, y })\r\n                  console.log('  char:', state.map[i])\r\n                  console.log('  houseNumber:', randomHouseNum, 'of', houses.length)\r\n                  break\r\n                }\r\n                houseCount++\r\n              }\r\n            }\r\n          } else {\r\n            state.candyHouseIndex = null\r\n          }\r\n        }\r\n      }\r\n\r\n      // Load path meta for this level (use levelIndex, not payload)\r\n      const meta = state.levelMeta[levelIndex] || { nodes: [], edges: [] }\r\n      state.pathNodes = Array.isArray(meta.nodes) ? meta.nodes : []\r\n      state.pathEdges = Array.isArray(meta.edges) ? meta.edges : []\r\n      // Build adjacency and index map\r\n      const coordToIndex = {}\r\n      state.pathNodes.forEach((n, i) => { coordToIndex[`${n.x},${n.y}`] = i })\r\n      const adj = {}\r\n      const addEdge = (a, b) => {\r\n        if (a === undefined || b === undefined) return\r\n        if (!adj[a]) adj[a] = new Set()\r\n        if (!adj[b]) adj[b] = new Set()\r\n        adj[a].add(b)\r\n        adj[b].add(a)\r\n      }\r\n      state.pathEdges.forEach(e => {\r\n        const a = coordToIndex[`${e.from.x},${e.from.y}`]\r\n        const b = coordToIndex[`${e.to.x},${e.to.y}`]\r\n        addEdge(a, b)\r\n      })\r\n      state.pathAdjacency = adj\r\n      // Find current node under G\r\n      if (state.map) {\r\n        const xMax = state.map.indexOf('\\n', 1) - 1\r\n        const gIndex = state.map.indexOf('G', 1)\r\n        if (gIndex > 0) {\r\n          const { x, y } = fromIndex(gIndex, xMax)\r\n          const nodeIdx = coordToIndex[`${x},${y}`]\r\n          state.currentNodeIdx = Number.isInteger(nodeIdx) ? nodeIdx : null\r\n          console.log('Level loaded. Spawn at:', x, y, 'Node index:', state.currentNodeIdx, 'Total nodes:', state.pathNodes.length, 'Total edges:', state.pathEdges.length)\r\n          if (state.currentNodeIdx === null) {\r\n            console.warn('⚠️ No node found at spawn point! Graph navigation will not work.')\r\n          }\r\n        } else {\r\n          state.currentNodeIdx = null\r\n        }\r\n      }\r\n    },\r\n    mode (state, payload) {\r\n      state.modePrevious = state.mode\r\n      state.mode = payload\r\n    },\r\n    selectCharacter (state, payload) {\r\n      state.character = payload\r\n    },\r\n    // Multiplayer mutations\r\n    setMultiplayerInfo (state, payload) {\r\n      state.multiplayer.isMultiplayer = payload.isMultiplayer\r\n      state.multiplayer.isHost = payload.isHost\r\n      state.multiplayer.playerId = payload.playerId\r\n      state.multiplayer.roomCode = payload.roomCode\r\n      state.multiplayer.playerName = payload.playerName\r\n      if (payload.activePlayerCharacter !== undefined) {\r\n        state.multiplayer.activePlayerCharacter = payload.activePlayerCharacter\r\n      }\r\n    },\r\n    setPlayerRole (state, role) {\r\n      state.multiplayer.playerRole = role\r\n    },\r\n    setWebRTCConnected (state, connected) {\r\n      state.multiplayer.webrtcConnected = connected\r\n      if (connected) {\r\n        state.multiplayer.webrtcConnectedAt = Date.now()\r\n      } else {\r\n        state.multiplayer.webrtcConnectedAt = null\r\n      }\r\n    },\r\n    setOtherPlayerConnected (state, connected) {\r\n      state.multiplayer.otherPlayerWasConnected = connected\r\n    },\r\n    updateMultiplayerRoom (state, roomData) {\r\n      state.multiplayer.roomData = roomData\r\n\r\n      // Update other player info\r\n      const otherPlayerId = state.multiplayer.playerId === 'player1' ? 'player2' : 'player1'\r\n      if (roomData.players && roomData.players[otherPlayerId]) {\r\n        state.multiplayer.otherPlayerName = roomData.players[otherPlayerId].name\r\n        state.multiplayer.otherPlayerRole = roomData.players[otherPlayerId].role\r\n      }\r\n    },\r\n    syncGameState (state, gameState) {\r\n      // Sync game state from other player (guide receives updates from player)\r\n      if (gameState.map !== undefined) state.map = gameState.map\r\n      if (gameState.score !== undefined) state.score = gameState.score\r\n      if (gameState.moves !== undefined) state.moves = gameState.moves\r\n      if (gameState.facing !== undefined) state.facing = gameState.facing\r\n      if (gameState.lastDirection !== undefined) state.lastDirection = gameState.lastDirection\r\n      if (gameState.charAtNewIndex !== undefined) state.charAtNewIndex = gameState.charAtNewIndex\r\n      if (gameState.candyHouseIndex !== undefined) {\r\n        console.log('🔄 Syncing candyHouseIndex:', gameState.candyHouseIndex, 'was:', state.candyHouseIndex)\r\n        state.candyHouseIndex = gameState.candyHouseIndex\r\n      }\r\n      if (gameState.activePlayerCharacter !== undefined) state.multiplayer.activePlayerCharacter = gameState.activePlayerCharacter\r\n    },\r\n    resetMultiplayer (state) {\r\n      state.multiplayer = {\r\n        isMultiplayer: false,\r\n        isHost: false,\r\n        playerId: null,\r\n        roomCode: null,\r\n        playerName: null,\r\n        playerRole: null,\r\n        otherPlayerName: null,\r\n        otherPlayerRole: null,\r\n        webrtcConnected: false,\r\n        roomData: null,\r\n        activePlayerCharacter: null,\r\n        otherPlayerWasConnected: false,\r\n        webrtcConnectedAt: null\r\n      }\r\n    },\r\n    setOverlay (state, payload) {\r\n      state.overlayActive = !!payload.active\r\n      state.overlayType = payload.type || null\r\n      state.overlayMessage = payload.message || null\r\n    },\r\n    move (state, payload) {\r\n      // Graph-based step: move from current node to adjacent node in the desired direction if available\r\n      if (state.overlayActive) return\r\n      const direction = payload\r\n      const xMax = state.map.indexOf('\\n', 1) - 1\r\n      if (!Number.isInteger(state.currentNodeIdx) || !state.pathNodes[state.currentNodeIdx]) {\r\n        // Fallback to old logic if graph not present\r\n        const newState = changeStateByDirection(state, direction)\r\n        state.lastDirection = direction\r\n        state.map = newState.map\r\n        state.score = newState.score\r\n        state.moves = newState.moves\r\n        state.charAtNewIndex = newState.charAtNewIndex\r\n      } else {\r\n        const cur = state.pathNodes[state.currentNodeIdx]\r\n        const neighbors = Array.from(state.pathAdjacency[state.currentNodeIdx] || [])\r\n        const dirVec = { up: { dx: 0, dy: -1 }, down: { dx: 0, dy: 1 }, left: { dx: -1, dy: 0 }, right: { dx: 1, dy: 0 } }[direction]\r\n        let nextIdx = null\r\n        let bestDist = Infinity\r\n        neighbors.forEach(nIdx => {\r\n          const n = state.pathNodes[nIdx]\r\n          const dx = n.x - cur.x\r\n          const dy = n.y - cur.y\r\n          if (dirVec.dx !== 0) {\r\n            if (dy === 0 && Math.sign(dx) === dirVec.dx) {\r\n              const d = Math.abs(dx)\r\n              if (d > 0 && d < bestDist) { bestDist = d; nextIdx = nIdx }\r\n            }\r\n          } else {\r\n            if (dx === 0 && Math.sign(dy) === dirVec.dy) {\r\n              const d = Math.abs(dy)\r\n              if (d > 0 && d < bestDist) { bestDist = d; nextIdx = nIdx }\r\n            }\r\n          }\r\n        })\r\n        if (nextIdx !== null) {\r\n          const newIndex = toIndex(state.pathNodes[nextIdx].x, state.pathNodes[nextIdx].y, xMax)\r\n          const gIndexLast = state.map.indexOf('G', 1)\r\n          const lastCharAtSpace = state.levels[state.currentLevel].charAt(gIndexLast)\r\n          const newMap = spliceSlice(spliceSlice(state.map, gIndexLast, 1, lastCharAtSpace), newIndex, 1, 'G')\r\n          state.map = newMap\r\n          // moves removed\r\n          state.lastDirection = direction\r\n          state.facing = direction\r\n          state.currentNodeIdx = nextIdx\r\n        } else {\r\n          // No neighbor in that direction; count attempt\r\n          state.moves += 1\r\n        }\r\n      }\r\n      // Broadcast to other player if multiplayer\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n        const webrtcService = require('./services/webrtcService').default\r\n        const updateData = {\r\n          map: state.map,\r\n          score: state.score,\r\n          facing: state.facing,\r\n          candyHouseIndex: state.candyHouseIndex,\r\n          activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n        }\r\n        console.log('Sending game state (move):', updateData)\r\n        webrtcService.sendGameState(updateData)\r\n      }\r\n    },\r\n    turnLeftMutation (state) {\r\n      if (state.overlayActive) return\r\n      state.facing = turnLeft(state.facing)\r\n      state.lastDirection = state.facing\r\n      state.moves += 1\r\n      // Reset last interacted house when turning\r\n      state.lastInteractedHouseIndex = null\r\n\r\n      // Broadcast to other player if multiplayer\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n        const webrtcService = require('./services/webrtcService').default\r\n        const updateData = {\r\n          facing: state.facing,\r\n          lastDirection: state.lastDirection,\r\n          map: state.map,\r\n          score: state.score,\r\n          candyHouseIndex: state.candyHouseIndex,\r\n          activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n        }\r\n        console.log('Sending game state (turn left):', updateData)\r\n        webrtcService.sendGameState(updateData)\r\n      }\r\n    },\r\n    turnRightMutation (state) {\r\n      if (state.overlayActive) return\r\n      state.facing = turnRight(state.facing)\r\n      state.lastDirection = state.facing\r\n      state.moves += 1\r\n      // Reset last interacted house when turning\r\n      state.lastInteractedHouseIndex = null\r\n\r\n      // Broadcast to other player if multiplayer\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n        const webrtcService = require('./services/webrtcService').default\r\n        const updateData = {\r\n          facing: state.facing,\r\n          lastDirection: state.lastDirection,\r\n          map: state.map,\r\n          score: state.score,\r\n          candyHouseIndex: state.candyHouseIndex,\r\n          activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n        }\r\n        console.log('Sending game state (turn right):', updateData)\r\n        webrtcService.sendGameState(updateData)\r\n      }\r\n    },\r\n    moveForward (state) {\r\n      if (state.overlayActive) return\r\n      // Go straight until junction (or both) node, walking only forward neighbors\r\n      if (Number.isInteger(state.currentNodeIdx) && state.pathNodes[state.currentNodeIdx]) {\r\n        const xMax = state.map.indexOf('\\n', 1) - 1\r\n        let curIdx = state.currentNodeIdx\r\n        let movedAny = false\r\n        while (true) {\r\n          const forwardIdx = getForwardNeighborIdx(state, curIdx, state.facing)\r\n          if (forwardIdx === null) break\r\n          const newIndex = toIndex(state.pathNodes[forwardIdx].x, state.pathNodes[forwardIdx].y, xMax)\r\n          const gIndexLast = state.map.indexOf('G', 1)\r\n          const lastCharAtSpace = state.levels[state.currentLevel].charAt(gIndexLast)\r\n          state.map = spliceSlice(spliceSlice(state.map, gIndexLast, 1, lastCharAtSpace), newIndex, 1, 'G')\r\n          state.moves += 1\r\n          movedAny = true\r\n          curIdx = forwardIdx\r\n          const nextNode = state.pathNodes[curIdx]\r\n          if (nextNode.type === 'junction' || nextNode.type === 'both') break\r\n          if (hasPerpendicularBranch(state, curIdx, state.facing)) break\r\n        }\r\n        state.currentNodeIdx = curIdx\r\n        if (!movedAny) state.moves += 1\r\n        if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n          const webrtcService = require('./services/webrtcService').default\r\n          webrtcService.sendGameState({\r\n            map: state.map,\r\n            score: state.score,\r\n            facing: state.facing,\r\n            candyHouseIndex: state.candyHouseIndex,\r\n            activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n          })\r\n        }\r\n        return\r\n      }\r\n      const mapLast = state.map\r\n      const xMax = mapLast.indexOf('\\n', 1) - 1\r\n      const gIndexLast = mapLast.indexOf('G', 1)\r\n      const yLast = Math.floor((gIndexLast - 1) / (xMax + 1))\r\n      const xLast = (gIndexLast - yLast) % xMax\r\n\r\n      let currentX = xLast\r\n      let currentY = yLast\r\n\r\n      // Keep moving forward until we hit a junction or can't move anymore\r\n      while (canMoveInDirection(state.map, currentX, currentY, xMax, state.facing, state.roadTiles)) {\r\n        // Move one step\r\n        const newState = changeStateByDirection(state, state.facing)\r\n        state.lastDirection = state.facing\r\n        state.map = newState.map\r\n        state.score = newState.score\r\n        state.moves = newState.moves\r\n        state.charAtNewIndex = newState.charAtNewIndex\r\n\r\n        // Update current position for next iteration\r\n        const newGIndex = state.map.indexOf('G', 1)\r\n        const { x: newX, y: newY } = fromIndex(newGIndex, xMax)\r\n\r\n        // Check if we've reached a junction\r\n        if (isJunction(state.map, newX, newY, xMax, state.facing, state.roadTiles)) {\r\n          break\r\n        }\r\n\r\n        currentX = newX\r\n        currentY = newY\r\n      }\r\n\r\n      // moves removed\r\n\r\n      // Broadcast to other player if multiplayer\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n        const webrtcService = require('./services/webrtcService').default\r\n        const updateData = {\r\n          map: state.map,\r\n          score: state.score,\r\n          facing: state.facing,\r\n          lastDirection: state.lastDirection,\r\n          charAtNewIndex: state.charAtNewIndex,\r\n          candyHouseIndex: state.candyHouseIndex,\r\n          activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n        }\r\n        console.log('Sending game state (move forward):', updateData)\r\n        webrtcService.sendGameState(updateData)\r\n      }\r\n    },\r\n    shortForward (state) {\r\n      // Go short until houseStop (or both) before first junction. If multiple houses before junction,\r\n      // prefer the one adjacent to the candy house.\r\n      if (state.overlayActive) return\r\n      if (Number.isInteger(state.currentNodeIdx) && state.pathNodes[state.currentNodeIdx]) {\r\n        const xMax = state.map.indexOf('\\n', 1) - 1\r\n        const candyIdx = state.candyHouseIndex\r\n        // Scan forward nodes until a junction (inclusive), collect house stops\r\n        let scanIdx = state.currentNodeIdx\r\n        let targetIdx = null\r\n        let firstHouseIdx = null\r\n        while (true) {\r\n          const forwardIdx = getForwardNeighborIdx(state, scanIdx, state.facing)\r\n          if (forwardIdx === null) break\r\n          const node = state.pathNodes[forwardIdx]\r\n          // Stop scanning at first junction (do not pass it)\r\n          if (node.type === 'junction') {\r\n            break\r\n          }\r\n          // Record first house\r\n          if ((node.type === 'houseStop' || node.type === 'both') && firstHouseIdx === null) {\r\n            firstHouseIdx = forwardIdx\r\n          }\r\n          // Check if this houseStop is adjacent to the candy house tile\r\n          if (node.type === 'houseStop' || node.type === 'both') {\r\n            const x = node.x\r\n            const y = node.y\r\n            const neighbors = [\r\n              { nx: x - 1, ny: y },\r\n              { nx: x + 1, ny: y },\r\n              { nx: x, ny: y - 1 },\r\n              { nx: x, ny: y + 1 }\r\n            ]\r\n            for (const { nx, ny } of neighbors) {\r\n              // Validate ny within [0, yMax] and nx within [0, xMax]\r\n              const yMax = (state.map.match(/\\n/g) || []).length - 1\r\n              if (nx >= 0 && nx <= xMax && ny >= 0 && ny <= yMax) {\r\n                const houseIndex = toIndex(nx, ny, xMax)\r\n                if (houseIndex === candyIdx) {\r\n                  targetIdx = forwardIdx\r\n                  break\r\n                }\r\n              }\r\n            }\r\n            if (targetIdx !== null) break\r\n          }\r\n          scanIdx = forwardIdx\r\n        }\r\n        // Choose candy target if found; else first house if any; else don't move\r\n        if (targetIdx === null) targetIdx = firstHouseIdx\r\n        if (targetIdx !== null) {\r\n          let curIdx = state.currentNodeIdx\r\n          let movedAny = false\r\n          while (curIdx !== targetIdx) {\r\n            const stepIdx = getForwardNeighborIdx(state, curIdx, state.facing)\r\n            if (stepIdx === null) break\r\n            const newIndex = toIndex(state.pathNodes[stepIdx].x, state.pathNodes[stepIdx].y, xMax)\r\n            const gIndexLast = state.map.indexOf('G', 1)\r\n            const lastCharAtSpace = state.levels[state.currentLevel].charAt(gIndexLast)\r\n            state.map = spliceSlice(spliceSlice(state.map, gIndexLast, 1, lastCharAtSpace), newIndex, 1, 'G')\r\n            state.moves += 1\r\n            movedAny = true\r\n            curIdx = stepIdx\r\n          }\r\n          state.currentNodeIdx = curIdx\r\n          if (!movedAny) { /* moves removed */ }\r\n        } else {\r\n          // No valid house before a junction – no-op\r\n        }\r\n        if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n          const webrtcService = require('./services/webrtcService').default\r\n          webrtcService.sendGameState({\r\n            map: state.map,\r\n            score: state.score,\r\n            facing: state.facing,\r\n            candyHouseIndex: state.candyHouseIndex,\r\n            activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n          })\r\n        }\r\n        return\r\n      }\r\n\r\n      // Fallback to old logic if graph not present\r\n      const mapLast = state.map\r\n      const xMax = mapLast.indexOf('\\n', 1) - 1\r\n      const yMax = (mapLast.match(/\\n/g) || []).length - 1\r\n      const gIndexLast = mapLast.indexOf('G', 1)\r\n      const yLast = Math.floor((gIndexLast - 1) / (xMax + 1))\r\n      const xLast = (gIndexLast - yLast) % xMax\r\n\r\n      let currentX = xLast\r\n      let currentY = yLast\r\n      let moved = false\r\n\r\n      // Helper to check if there's a house adjacent (left or right)\r\n      const hasAdjacentHouse = (x, y) => {\r\n        const leftOrRight = state.facing === 'up' || state.facing === 'down'\r\n          ? ['left', 'right']\r\n          : ['up', 'down']\r\n\r\n        for (const dir of leftOrRight) {\r\n          const next = getNextPosition(x, y, xMax, yMax, dir)\r\n          const nextIndex = toIndex(next.x, next.y, xMax)\r\n          const charAtNext = state.map.charAt(nextIndex)\r\n          if (charAtNext.match(uppercaseHousesRegex) || charAtNext.match(/[qwedcxzah]/i)) {\r\n            return true\r\n          }\r\n        }\r\n        return false\r\n      }\r\n\r\n      // Keep moving forward until we find a house adjacent or can't move\r\n      while (canMoveInDirection(state.map, currentX, currentY, xMax, state.facing, state.roadTiles)) {\r\n        // Move one step\r\n        const newState = changeStateByDirection(state, state.facing)\r\n        state.lastDirection = state.facing\r\n        state.map = newState.map\r\n        state.score = newState.score\r\n        state.moves = newState.moves\r\n        state.charAtNewIndex = newState.charAtNewIndex\r\n        moved = true\r\n\r\n        // Update current position\r\n        const newGIndex = state.map.indexOf('G', 1)\r\n        const { x: newX, y: newY } = fromIndex(newGIndex, xMax)\r\n\r\n        // Check if there's a house to our left or right\r\n        if (hasAdjacentHouse(newX, newY)) {\r\n          break\r\n        }\r\n\r\n        currentX = newX\r\n        currentY = newY\r\n      }\r\n\r\n      // If we didn't move at all, still count it as a move attempt\r\n      if (!moved) { /* moves removed */ }\r\n\r\n      // Broadcast to other player if multiplayer\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n        const webrtcService = require('./services/webrtcService').default\r\n        const updateData = {\r\n          map: state.map,\r\n          score: state.score,\r\n          facing: state.facing,\r\n          lastDirection: state.lastDirection,\r\n          charAtNewIndex: state.charAtNewIndex,\r\n          candyHouseIndex: state.candyHouseIndex,\r\n          activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n        }\r\n        console.log('Sending game state (short forward):', updateData)\r\n        webrtcService.sendGameState(updateData)\r\n      }\r\n    }\r\n  },\r\n  actions: {\r\n    async loadLevels ({ dispatch }) {\r\n      const result = await fetch('./levels.txt')\r\n      // Normalize Windows CRLF to LF to keep coordinate math correct\r\n      const levelText = (await result.text()).replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n')\r\n      let levelSplit = levelText.split('\\n\\n')\r\n      const roadTiles = [...levelSplit.shift()]\r\n      const levels = []\r\n      const levelMeta = []\r\n\r\n      levelSplit.forEach((block) => {\r\n        // Skip empty blocks\r\n        if (!block.trim()) return\r\n\r\n        // Check if this block starts with ---META--- (orphaned metadata)\r\n        if (block.trim().startsWith('---META---')) {\r\n          // This is metadata for the previous level\r\n          if (levels.length > 0) {\r\n            try {\r\n              const metaContent = block.split('---META---')[1].trim()\r\n              const parsed = JSON.parse(metaContent)\r\n              levelMeta[levelMeta.length - 1] = parsed\r\n            } catch (e) {\r\n              console.error('Failed to parse orphaned metadata:', e)\r\n            }\r\n          }\r\n          return\r\n        }\r\n\r\n        // Split block into map and metadata\r\n        const parts = block.split('\\n---META---\\n')\r\n        const mapPart = parts[0].trim()\r\n        const metaPart = parts[1]\r\n\r\n        // Only add non-empty maps\r\n        if (mapPart.trim()) {\r\n          // Ensure consistent single leading newline and trimmed map content\r\n          levels.push('\\n' + mapPart)\r\n\r\n          if (metaPart) {\r\n            try {\r\n              levelMeta.push(JSON.parse(metaPart))\r\n            } catch (e) {\r\n              console.error('Failed to parse metadata:', e)\r\n              levelMeta.push({ nodes: [], edges: [] })\r\n            }\r\n          } else {\r\n            levelMeta.push({ nodes: [], edges: [] })\r\n          }\r\n        }\r\n      })\r\n\r\n      console.log('📦 Loaded levels:', levels.length, 'levels with', levelMeta.length, 'metadata entries')\r\n      levelMeta.forEach((meta, i) => {\r\n        console.log(`Level ${i}: ${meta.nodes ? meta.nodes.length : 0} nodes, ${meta.edges ? meta.edges.length : 0} edges`)\r\n      })\r\n\r\n      dispatch(\r\n        'setLevels',\r\n        {\r\n          roadTiles,\r\n          levels,\r\n          levelMeta\r\n        }\r\n      )\r\n    },\r\n    setLevels ({ commit }, payload) {\r\n      commit('setLevels', payload)\r\n    },\r\n    setMultiplayerMode ({ commit }, isMultiplayer) {\r\n      if (!isMultiplayer) {\r\n        commit('resetMultiplayer')\r\n      }\r\n    },\r\n    selectCharacter ({ state, commit }, payload) {\r\n      commit('selectCharacter', payload)\r\n      // Only auto-start level in single player mode\r\n      if (!state.multiplayer.isMultiplayer) {\r\n        commit('startLevel', 0)\r\n        commit('mode', 'play')\r\n      }\r\n      event('interaction', 'selectCharacter', payload, null)\r\n    },\r\n    startLevel ({ state, commit }, payload) {\r\n      commit('startLevel', payload)\r\n      commit('mode', 'play')\r\n      event('interaction', 'startLevel', null, state.currentLevel)\r\n    },\r\n    mode ({ state, commit }, payload) {\r\n      commit('mode', payload)\r\n      event('interaction', 'mode', payload, null)\r\n    },\r\n    nextLevel ({ state, commit }) {\r\n      const nextLevel = (state.currentLevel + 1) % state.levels.length\r\n      commit('startLevel', nextLevel)\r\n      commit('mode', 'play')\r\n      event('interaction', 'nextLevel', null, state.currentLevel)\r\n    },\r\n    move ({ state, commit }, payload) {\r\n      // Only allow moves if player has control\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.playerRole !== 'player') {\r\n        return\r\n      }\r\n\r\n      commit('move', payload)\r\n      const win = !state.map.match(uppercaseHousesRegex)\r\n      const earlyExit = state.charAtNewIndex === '!'\r\n      if (win || earlyExit) {\r\n        totalWinCount += 1\r\n        event(\r\n          'interaction',\r\n          'win',\r\n          `currentLevel: ${state.currentLevel}, score: ${state.score}, moves: ${state.moves}`,\r\n          totalWinCount\r\n        )\r\n        event(\r\n          'interaction',\r\n          'winMap',\r\n          state.map,\r\n          win ? 1 : 0\r\n        )\r\n        setTimeout(\r\n          () => {\r\n            commit('mode', 'levelWin')\r\n\r\n            // In multiplayer, send win notification via WebRTC (no Firebase)\r\n            if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n              const webrtcService = require('./services/webrtcService').default\r\n              webrtcService.sendGameState({\r\n                type: 'levelWin',\r\n                map: state.map,\r\n                score: state.score,\r\n                facing: state.facing,\r\n                candyHouseIndex: state.candyHouseIndex,\r\n                activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n              })\r\n            }\r\n          },\r\n          200\r\n        )\r\n      }\r\n    },\r\n    turnLeftAction ({ state, commit }) {\r\n      // Only allow turns if player has control\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.playerRole !== 'player') {\r\n        return\r\n      }\r\n\r\n      commit('turnLeftMutation')\r\n      event('interaction', 'turnLeft', state.facing, null)\r\n    },\r\n    turnRightAction ({ state, commit }) {\r\n      // Only allow turns if player has control\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.playerRole !== 'player') {\r\n        return\r\n      }\r\n\r\n      commit('turnRightMutation')\r\n      event('interaction', 'turnRight', state.facing, null)\r\n    },\r\n    forward ({ state, commit }) {\r\n      // Only allow forward if player has control\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.playerRole !== 'player') {\r\n        return\r\n      }\r\n\r\n      commit('moveForward')\r\n      const win = !state.map.match(uppercaseHousesRegex)\r\n      const earlyExit = state.charAtNewIndex === '!'\r\n      if (win || earlyExit) {\r\n        totalWinCount += 1\r\n        event(\r\n          'interaction',\r\n          'win',\r\n          `currentLevel: ${state.currentLevel}, score: ${state.score}, moves: ${state.moves}`,\r\n          totalWinCount\r\n        )\r\n        event(\r\n          'interaction',\r\n          'winMap',\r\n          state.map,\r\n          win ? 1 : 0\r\n        )\r\n        setTimeout(\r\n          () => {\r\n            commit('mode', 'levelWin')\r\n\r\n            // In multiplayer, send win notification via WebRTC (no Firebase)\r\n            if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n              const webrtcService = require('./services/webrtcService').default\r\n              webrtcService.sendGameState({\r\n                type: 'levelWin',\r\n                map: state.map,\r\n                score: state.score,\r\n                facing: state.facing,\r\n                candyHouseIndex: state.candyHouseIndex,\r\n                activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n              })\r\n            }\r\n          },\r\n          200\r\n        )\r\n      }\r\n    },\r\n    shortForwardAction ({ state, commit }) {\r\n      // Only allow forward if player has control\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.playerRole !== 'player') {\r\n        return\r\n      }\r\n\r\n      commit('shortForward')\r\n\r\n      // Just move to the house, don't interact\r\n      // Interaction is now done via the Trick-Or-Treat button\r\n      \r\n      const win = !state.map.match(uppercaseHousesRegex)\r\n      const earlyExit = state.charAtNewIndex === '!'\r\n      if (win || earlyExit) {\r\n        totalWinCount += 1\r\n        event(\r\n          'interaction',\r\n          'win',\r\n          `currentLevel: ${state.currentLevel}, score: ${state.score}, moves: ${state.moves}`,\r\n          totalWinCount\r\n        )\r\n        event(\r\n          'interaction',\r\n          'winMap',\r\n          state.map,\r\n          win ? 1 : 0\r\n        )\r\n        setTimeout(\r\n          () => {\r\n            commit('mode', 'levelWin')\r\n\r\n            // In multiplayer, send win notification via WebRTC (no Firebase)\r\n            if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n              const webrtcService = require('./services/webrtcService').default\r\n              webrtcService.sendGameState({\r\n                type: 'levelWin',\r\n                map: state.map,\r\n                score: state.score,\r\n                facing: state.facing,\r\n                candyHouseIndex: state.candyHouseIndex,\r\n                activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n              })\r\n            }\r\n          },\r\n          200\r\n        )\r\n      }\r\n    },\r\n    testCustomMap ({ state, commit }, mapString) {\r\n      // Add custom map temporarily for testing\r\n      const customLevelIndex = state.levels.length\r\n      state.levels.push(mapString)\r\n      commit('startLevel', customLevelIndex)\r\n      commit('mode', 'play')\r\n      event('interaction', 'testCustomMap', null, null)\r\n    },\r\n    // Multiplayer actions\r\n    setMultiplayerInfo ({ commit }, payload) {\r\n      commit('setMultiplayerInfo', payload)\r\n    },\r\n    setPlayerRole ({ commit }, role) {\r\n      commit('setPlayerRole', role)\r\n    },\r\n    setWebRTCConnected ({ commit }, connected) {\r\n      commit('setWebRTCConnected', connected)\r\n    },\r\n    updateMultiplayerRoom ({ commit, state, dispatch }, roomData) {\r\n      commit('updateMultiplayerRoom', roomData)\r\n      \r\n      // Check for disconnection during gameplay\r\n      // Only check if we're in play mode AND we have a WebRTC connection established\r\n      // And only after a grace period (don't check immediately after connection)\r\n      if (state.multiplayer.isMultiplayer && state.mode === 'play' && state.multiplayer.webrtcConnected && roomData && roomData.players) {\r\n        const myPlayerId = state.multiplayer.playerId\r\n        const otherPlayerId = myPlayerId === 'player1' ? 'player2' : 'player1'\r\n        \r\n        const otherPlayer = roomData.players[otherPlayerId]\r\n        \r\n        // Track previous connection state\r\n        if (!state.multiplayer.otherPlayerWasConnected && otherPlayer && otherPlayer.connected) {\r\n          // Other player just connected, mark them as connected\r\n          commit('setOtherPlayerConnected', true)\r\n        }\r\n        \r\n        // Only check for disconnection if we're past the initial grace period\r\n        // Give at least 3 seconds after WebRTC connects before checking for disconnection\r\n        const gracePeriodMs = 3000\r\n        const timeSinceConnect = state.multiplayer.webrtcConnectedAt ? Date.now() - state.multiplayer.webrtcConnectedAt : Infinity\r\n        \r\n        // Check if other player disconnected:\r\n        // 1. They were previously connected\r\n        // 2. They are now disconnected (either not in room data, or connected: false)\r\n        // 3. Enough time has passed since connection\r\n        if (timeSinceConnect > gracePeriodMs && state.multiplayer.otherPlayerWasConnected) {\r\n          const isDisconnected = !otherPlayer || !otherPlayer.connected\r\n          \r\n          if (isDisconnected) {\r\n            console.log('⚠️ Other player disconnected during gameplay')\r\n            \r\n            // Import services for cleanup\r\n            const webrtcService = require('./services/webrtcService').default\r\n            const roomService = require('./services/roomService').default\r\n            \r\n            // Clean up connections\r\n            webrtcService.destroy()\r\n            roomService.disconnect().then(() => {\r\n              if (state.multiplayer.isHost) {\r\n                roomService.deleteRoom()\r\n              }\r\n            })\r\n            \r\n            // Reset multiplayer and return to lobby\r\n            dispatch('resetMultiplayer')\r\n            dispatch('mode', 'lobby')\r\n            \r\n            // Show error message\r\n            setTimeout(() => {\r\n              alert('接続が切断されました')\r\n            }, 100)\r\n          }\r\n        }\r\n      }\r\n    },\r\n    handleMultiplayerMessage ({ commit, state, dispatch }, message) {\r\n      console.log('📥 Received multiplayer message:', message.type, message.data)\r\n      \r\n      if (message.type === 'gameState') {\r\n        // Check if this is an initialSync message\r\n        if (message.data.type === 'initialSync') {\r\n          console.log('📥 Guide received initial sync with candyHouseIndex:', message.data.candyHouseIndex)\r\n          console.log('📥 Levels loaded:', state.levels.length, 'levels')\r\n          \r\n          // Guide receives initial game state from player\r\n          const level = message.data.level !== undefined ? message.data.level : 0\r\n          const candyHouseIndex = message.data.candyHouseIndex\r\n          \r\n          if (candyHouseIndex !== undefined) {\r\n            console.log('📥 Starting level', level, 'with candyHouseIndex:', candyHouseIndex)\r\n            commit('startLevel', { level, candyHouseIndex })\r\n          } else {\r\n            console.log('📥 Starting level', level, 'without candyHouseIndex')\r\n            commit('startLevel', level)\r\n          }\r\n          \r\n          // Sync other state\r\n          commit('syncGameState', message.data)\r\n          \r\n          // Now that guide has the map, switch to play mode\r\n          commit('mode', 'play')\r\n          console.log('📥 Guide map loaded:', state.map ? 'map exists' : 'no map', 'mode set to play')\r\n        } else if (message.data.type === 'roleSwitch') {\r\n          // Handle role switch - guide receives this from player\r\n          console.log('📥 Guide received roleSwitch, score in message:', message.data.score)\r\n          \r\n          // Close any active overlay\r\n          commit('setOverlay', { active: false, type: null, message: null })\r\n          \r\n          // Sync the score from the player BEFORE switching roles\r\n          if (message.data.score !== undefined) {\r\n            state.score = message.data.score\r\n            console.log('📥 Score synced to:', state.score)\r\n          }\r\n          \r\n          // Now call switchRolesAndContinue to become the player\r\n          dispatch('switchRolesAndContinue')\r\n        } else if (message.data.type === 'levelWin') {\r\n          console.log('Received level win notification:', message.data)\r\n          // Sync the final game state\r\n          commit('syncGameState', message.data)\r\n        } else if (message.data.type === 'houseInteraction') {\r\n          console.log('Received house interaction:', message.data)\r\n          \r\n          // Only the guide should handle this message (player already handled it locally)\r\n          if (state.multiplayer.playerRole !== 'guide') {\r\n            console.log('Ignoring houseInteraction - not guide role')\r\n            return\r\n          }\r\n          \r\n          // Sync game state\r\n          commit('syncGameState', message.data)\r\n\r\n          // Show overlay for guide\r\n          if (message.data.success) {\r\n            commit('setOverlay', {\r\n              active: true,\r\n              type: 'success',\r\n              message: 'Good Job! You got candy!'\r\n            })\r\n            // Don't close overlay here - wait for roleSwitch message\r\n            // The roleSwitch handler will close the overlay and start the new round\r\n          } else {\r\n            commit('setOverlay', {\r\n              active: true,\r\n              type: 'fail',\r\n              message: 'Oh no! You got homework!'\r\n            })\r\n            setTimeout(() => {\r\n              commit('setOverlay', { active: false, type: null, message: null })\r\n            }, 5000)\r\n          }\r\n        } else if (message.data.type === 'levelStart') {\r\n          console.log('📥 Guide received levelStart with candyHouseIndex:', message.data.candyHouseIndex, 'score:', message.data.score)\r\n          // New guide receives level info from new player\r\n          const level = message.data.level !== undefined ? message.data.level : state.currentLevel\r\n          const candyHouseIndex = message.data.candyHouseIndex\r\n          \r\n          // Sync score FIRST before starting level\r\n          if (message.data.score !== undefined) {\r\n            state.score = message.data.score\r\n            console.log('📥 Score synced to:', state.score)\r\n          }\r\n          \r\n          // Start level with candy house (keep score)\r\n          if (candyHouseIndex !== undefined) {\r\n            commit('startLevel', { level, candyHouseIndex, keepScore: true })\r\n          } else {\r\n            commit('startLevel', { level, keepScore: true })\r\n          }\r\n          \r\n          // Sync other state (map, facing, etc.)\r\n          commit('syncGameState', message.data)\r\n          console.log('📥 Final score after sync:', state.score)\r\n        } else {\r\n          // Regular game state update\r\n          console.log('Received game state update:', message.data)\r\n          commit('syncGameState', message.data)\r\n        }\r\n      }\r\n    },\r\n    resetMultiplayer ({ commit }) {\r\n      commit('resetMultiplayer')\r\n    },\r\n    async switchRolesAndContinue ({ state, commit }) {\r\n      console.log('🔄 switchRolesAndContinue called, current role:', state.multiplayer.playerRole)\r\n      \r\n      // Determine new roles\r\n      const currentRole = state.multiplayer.playerRole\r\n      const newRole = currentRole === 'player' ? 'guide' : 'player'\r\n      console.log('🔄 Switching from', currentRole, 'to', newRole)\r\n\r\n      // Determine new activePlayerCharacter\r\n      const currentChar = state.multiplayer.activePlayerCharacter\r\n      const newActiveChar = currentChar === 'ghost' ? 'alien' : 'ghost'\r\n\r\n      const nextLevel = (state.currentLevel + 1) % state.levels.length\r\n      \r\n      // If I'm currently the player, send roleSwitch BEFORE switching my role\r\n      if (currentRole === 'player') {\r\n        console.log('🔄 I was the player, sending roleSwitch to guide first, current score:', state.score)\r\n        \r\n        if (state.multiplayer.webrtcConnected) {\r\n          const webrtcService = require('./services/webrtcService').default\r\n          console.log('📤 Sending roleSwitch message to guide with score:', state.score)\r\n          webrtcService.sendGameState({\r\n            type: 'roleSwitch',\r\n            activePlayerCharacter: newActiveChar,\r\n            level: nextLevel,\r\n            score: state.score // Pass the current score to the guide\r\n          })\r\n        }\r\n        \r\n        // Now switch my role to guide\r\n        commit('setPlayerRole', newRole)\r\n        state.multiplayer.activePlayerCharacter = newActiveChar\r\n        console.log('🔄 I am now the guide, keeping score:', state.score)\r\n      } else {\r\n        // I'm currently the guide, becoming player\r\n        console.log('🔄 I was the guide, becoming player')\r\n        commit('setPlayerRole', newRole)\r\n        state.multiplayer.activePlayerCharacter = newActiveChar\r\n        \r\n        // Pick candy house and start level (keep score across rounds)\r\n        const scoreBeforeStart = state.score\r\n        console.log('🔄 Starting level', nextLevel, 'as new player, score before startLevel:', scoreBeforeStart)\r\n        commit('startLevel', { level: nextLevel, keepScore: true })\r\n        console.log('🔄 Score after startLevel:', state.score, '(should be', scoreBeforeStart, ')')\r\n        \r\n        // Send level info to new guide\r\n        if (state.multiplayer.webrtcConnected) {\r\n          const webrtcService = require('./services/webrtcService').default\r\n          console.log('📤 Sending levelStart with candyHouseIndex:', state.candyHouseIndex, 'score:', state.score)\r\n          webrtcService.sendGameState({\r\n            type: 'levelStart',\r\n            level: nextLevel,\r\n            candyHouseIndex: state.candyHouseIndex,\r\n            map: state.map,\r\n            score: state.score,\r\n            facing: state.facing,\r\n            activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n          })\r\n        }\r\n      }\r\n      \r\n      commit('mode', 'play')\r\n      console.log('🔄 switchRolesAndContinue complete, mode set to play')\r\n    },\r\n    trickOrTreat ({ dispatch }) {\r\n      // Trigger house interaction\r\n      dispatch('interactWithHouse')\r\n    },\r\n    async interactWithHouse ({ state, commit, dispatch }) {\r\n      console.log('🏠 interactWithHouse called')\r\n      // Only player can interact\r\n      if (state.multiplayer.isMultiplayer && state.multiplayer.playerRole !== 'player') {\r\n        console.log('🏠 Not player role, skipping interaction')\r\n        return\r\n      }\r\n\r\n      // Check if player is adjacent to an interactable house\r\n      const gIndex = state.map.indexOf('G', 1)\r\n      const xMax = state.map.indexOf('\\n', 1) - 1\r\n      const { x, y } = fromIndex(gIndex, xMax)\r\n      const house = getAdjacentInteractableHouse(state.map, x, y, xMax, state.facing)\r\n\r\n      console.log('🏠 House check result:', { house, candyHouseIndex: state.candyHouseIndex })\r\n\r\n      if (!house) {\r\n        console.log('🏠 No interactable house found')\r\n        return // No interactable house\r\n      }\r\n\r\n      // Mark this house as the last one we interacted with\r\n      state.lastInteractedHouseIndex = house.houseIndex\r\n\r\n      // Check if this is the candy house\r\n      // Both should be string indices that include newlines\r\n      const { x: houseX, y: houseY } = fromIndex(house.houseIndex, xMax)\r\n      const { x: candyX, y: candyY } = fromIndex(state.candyHouseIndex, xMax)\r\n      \r\n      const isCorrectHouse = house.houseIndex === state.candyHouseIndex\r\n      console.log('🏠 House comparison:')\r\n      console.log('  foundHouseIndex:', house.houseIndex, 'at position:', { x: houseX, y: houseY })\r\n      console.log('  candyHouseIndex:', state.candyHouseIndex, 'at position:', { x: candyX, y: candyY })\r\n      console.log('  isCorrectHouse:', isCorrectHouse)\r\n      console.log('  houseChar:', house.houseChar)\r\n      console.log('  mapAtFoundIndex:', state.map.charAt(house.houseIndex))\r\n      console.log('  mapAtCandyIndex:', state.map.charAt(state.candyHouseIndex))\r\n\r\n      if (isCorrectHouse) {\r\n        // SUCCESS! Got candy\r\n        commit('setOverlay', {\r\n          active: true,\r\n          type: 'success',\r\n          message: 'Good Job! You got candy!'\r\n        })\r\n\r\n        // Update score\r\n        state.score += 1\r\n\r\n        // Mark house as visited\r\n        const houseChar = house.houseChar\r\n        state.map = spliceSlice(state.map, house.houseIndex, 1, houseChar.toLowerCase())\r\n\r\n        // Broadcast success via WebRTC\r\n        if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n          const webrtcService = require('./services/webrtcService').default\r\n          webrtcService.sendGameState({\r\n            type: 'houseInteraction',\r\n            success: true,\r\n            map: state.map,\r\n            score: state.score,\r\n            candyHouseIndex: state.candyHouseIndex,\r\n            activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n          })\r\n        }\r\n\r\n        // After 5 seconds, switch roles and start new round\r\n        setTimeout(() => {\r\n          console.log('⏰ 5 seconds elapsed, closing overlay and switching roles')\r\n          commit('setOverlay', { active: false, type: null, message: null })\r\n          if (state.multiplayer.isMultiplayer) {\r\n            console.log('🔄 Calling switchRolesAndContinue')\r\n            dispatch('switchRolesAndContinue')\r\n          } else {\r\n            // Single player: just pick new candy house\r\n            const houses = state.map.match(uppercaseHousesRegex)\r\n            if (houses && houses.length > 0) {\r\n              const randomHouseNum = Math.floor(Math.random() * houses.length)\r\n              let houseCount = 0\r\n              for (let i = 0; i < state.map.length; i++) {\r\n                if (state.map[i].match(uppercaseHousesRegex)) {\r\n                  if (houseCount === randomHouseNum) {\r\n                    state.candyHouseIndex = i\r\n                    break\r\n                  }\r\n                  houseCount++\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }, 5000)\r\n      } else {\r\n        // FAIL! Wrong house\r\n        commit('setOverlay', {\r\n          active: true,\r\n          type: 'fail',\r\n          message: 'Oh no! You got homework!'\r\n        })\r\n\r\n        // Lose a point\r\n        state.score = Math.max(0, state.score - 1)\r\n\r\n        // Broadcast fail via WebRTC\r\n        if (state.multiplayer.isMultiplayer && state.multiplayer.webrtcConnected) {\r\n          const webrtcService = require('./services/webrtcService').default\r\n          webrtcService.sendGameState({\r\n            type: 'houseInteraction',\r\n            success: false,\r\n            map: state.map,\r\n            score: state.score,\r\n            candyHouseIndex: state.candyHouseIndex,\r\n            activePlayerCharacter: state.multiplayer.activePlayerCharacter\r\n          })\r\n        }\r\n\r\n        // After 5 seconds, close overlay and continue\r\n        setTimeout(() => {\r\n          commit('setOverlay', { active: false, type: null, message: null })\r\n        }, 5000)\r\n      }\r\n    }\r\n  }\r\n})\r\n","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport store from './store'\r\nimport VueAnalytics from 'vue-analytics'\r\n\r\nVue.use(VueAnalytics, {\r\n  id: process.env.VUE_APP_GA || 'nope',\r\n  autoTracking: {\r\n    exception: true\r\n  },\r\n  debug: {\r\n    sendHitTask: process.env.NODE_ENV === 'production'\r\n  }\r\n})\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\n  store,\r\n  render: h => h(App)\r\n}).$mount('#app')\r\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import firebase from 'firebase/app'\r\nimport 'firebase/database'\r\n\r\n// Firebase configuration\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyBvAY3gapbiSr2lOrBtge1SeKmHgtLoJ9Y',\r\n  authDomain: 'directions-game.firebaseapp.com',\r\n  databaseURL: 'https://directions-game-default-rtdb.asia-southeast1.firebasedatabase.app',\r\n  projectId: 'directions-game',\r\n  storageBucket: 'directions-game.firebasestorage.app',\r\n  messagingSenderId: '147265691150',\r\n  appId: '1:147265691150:web:bb58a53271fe7fe831a65f'\r\n}\r\n\r\n// Initialize Firebase (v8 syntax)\r\nif (!firebase.apps || !firebase.apps.length) {\r\n  firebase.initializeApp(firebaseConfig)\r\n}\r\n\r\nconst database = firebase.database()\r\n\r\nexport { firebase, database }\r\nexport default firebase\r\n","import { database } from './firebase'\n\nclass RoomService {\n  constructor () {\n    this.roomRef = null\n    this.playerId = null\n    this.roomCode = null\n    this.ROOM_MAX_AGE_MS = 60 * 60 * 1000 // 1 hour\n  }\n\n  // Generate a random 5-digit room code\n  generateRoomCode () {\n    return Math.floor(10000 + Math.random() * 90000).toString()\n  }\n\n  // Check if a room code already exists and is active\n  async isRoomCodeTaken (roomCode) {\n    const roomRef = database.ref(`rooms/${roomCode}`)\n    const snapshot = await roomRef.once('value')\n    if (!snapshot.exists()) {\n      return false\n    }\n\n    const roomData = snapshot.val()\n    const now = Date.now()\n    const roomAge = now - roomData.createdAt\n\n    // Room is considered \"taken\" if it exists and is less than 1 hour old\n    // and has at least one connected player\n    if (roomAge < this.ROOM_MAX_AGE_MS) {\n      const hasConnectedPlayer = (roomData.players && roomData.players.player1 && roomData.players.player1.connected) ||\n                                 (roomData.players && roomData.players.player2 && roomData.players.player2.connected)\n      return hasConnectedPlayer\n    }\n\n    // Room is old/stale, can be reused\n    return false\n  }\n\n  // Clean up old/stale rooms (only for known room codes)\n  // Note: We can't list all rooms due to Firebase permissions, so this only cleans up\n  // rooms the client knows about. For global cleanup, use Cloud Functions.\n  async cleanupOldRooms () {\n    // Since we can't read all rooms from /rooms (permission denied),\n    // we only clean up rooms we have direct references to.\n    // For production, set up a Cloud Function for global cleanup.\n    // This function is kept for future use when Cloud Functions are implemented.\n    return\n  }\n\n  // Create a new room\n  async createRoom (playerName = 'Player 1') {\n    // Clean up old rooms first (optional, can be done periodically)\n    // await this.cleanupOldRooms()\n\n    // Try up to 5 times to generate a unique room code\n    let roomCode = null\n    let attempts = 0\n    const maxAttempts = 5\n\n    while (!roomCode && attempts < maxAttempts) {\n      const candidateCode = this.generateRoomCode()\n      const isTaken = await this.isRoomCodeTaken(candidateCode)\n\n      if (!isTaken) {\n        roomCode = candidateCode\n      } else {\n        attempts++\n        // Small delay to avoid hammering the database\n        await new Promise(resolve => setTimeout(resolve, 100))\n      }\n    }\n\n    if (!roomCode) {\n      throw new Error('Failed to generate unique room code. Please try again.')\n    }\n\n    this.roomCode = roomCode\n    this.playerId = 'player1'\n\n    const roomData = {\n      roomCode,\n      createdAt: Date.now(),\n      players: {\n        player1: {\n          id: 'player1',\n          name: playerName,\n          connected: true,\n          role: null, // Will be assigned randomly when both players join\n          character: null,\n          rtcOffer: null,\n          rtcAnswer: null\n          // iceCandidates will be created on first push; avoid empty value to satisfy rules\n        }\n      },\n      gameState: {\n        status: 'waiting', // waiting, ready, playing, roundComplete\n        currentRound: 0,\n        player1Ready: false,\n        player2Ready: false\n      }\n    }\n\n    this.roomRef = database.ref(`rooms/${roomCode}`)\n    await this.roomRef.set(roomData)\n\n    // Presence: ensure connected flag reflects actual connection state and cleans up on abrupt disconnects\n    const infoConnectedRef = database.ref('.info/connected')\n    const myConnectedRef = this.roomRef.child('players/player1/connected')\n    const onDisconnectRef = this.roomRef.child('players/player1/connected').onDisconnect()\n    onDisconnectRef.set(false)\n    infoConnectedRef.on('value', (snap) => {\n      if (snap.val() === true) {\n        myConnectedRef.set(true)\n      }\n    })\n\n    return { roomCode, playerId: 'player1' }\n  }\n\n  // Join an existing room\n  async joinRoom (roomCode, playerName = 'Player 2') {\n    this.roomCode = roomCode\n    this.playerId = 'player2'\n    this.roomRef = database.ref(`rooms/${roomCode}`)\n\n    // Check if room exists\n    const snapshot = await this.roomRef.once('value')\n    if (!snapshot.exists()) {\n      throw new Error('Room not found')\n    }\n\n    const roomData = snapshot.val()\n    const now = Date.now()\n\n    // Check if room is too old (stale)\n    if (!roomData.createdAt) {\n      throw new Error('Invalid room data')\n    }\n\n    const roomAge = now - roomData.createdAt\n    if (roomAge > this.ROOM_MAX_AGE_MS) {\n      // Delete stale room and throw error\n      await this.roomRef.remove()\n      throw new Error('Room has expired. Please ask the host to create a new room.')\n    }\n\n    // Check if player1 exists and is connected\n    if (!roomData.players || !roomData.players.player1) {\n      throw new Error('Room is invalid - no host found')\n    }\n\n    if (!roomData.players.player1.connected) {\n      throw new Error('Host has disconnected. Please ask them to create a new room.')\n    }\n\n    // Check if room is full\n    if (roomData.players.player2) {\n      throw new Error('Room is full')\n    }\n\n    // Check if room is in a valid state for joining (should be waiting)\n    const gameStatus = roomData.gameState && roomData.gameState.status\n    if (gameStatus && gameStatus !== 'waiting') {\n      throw new Error('Game is already in progress. Please wait for the current game to finish.')\n    }\n\n    // Add player2 to the room\n    await this.roomRef.child('players/player2').set({\n      id: 'player2',\n      name: playerName,\n      connected: true,\n      role: null,\n      character: null,\n      rtcOffer: null,\n      rtcAnswer: null\n      // iceCandidates will be created on first push; avoid empty value to satisfy rules\n    })\n\n    // Presence for player2\n    const infoConnectedRef = database.ref('.info/connected')\n    const myConnectedRef = this.roomRef.child('players/player2/connected')\n    const onDisconnectRef = this.roomRef.child('players/player2/connected').onDisconnect()\n    onDisconnectRef.set(false)\n    infoConnectedRef.on('value', (snap) => {\n      if (snap.val() === true) {\n        myConnectedRef.set(true)\n      }\n    })\n\n    return { roomCode, playerId: 'player2' }\n  }\n\n  // Listen for room updates\n  onRoomUpdate (callback) {\n    if (!this.roomRef) return\n\n    this.roomRef.on('value', (snapshot) => {\n      const data = snapshot.val()\n      if (data) {\n        callback(data)\n      }\n    })\n  }\n\n  // Update player's WebRTC offer\n  async setRTCOffer (offer) {\n    if (!this.roomRef || !this.playerId) return\n    await this.roomRef.child(`players/${this.playerId}/rtcOffer`).set(offer)\n  }\n\n  // Update player's WebRTC answer\n  async setRTCAnswer (answer) {\n    if (!this.roomRef || !this.playerId) return\n    await this.roomRef.child(`players/${this.playerId}/rtcAnswer`).set(answer)\n  }\n\n  // Add ICE candidate\n  async addICECandidate (candidate) {\n    if (!this.roomRef || !this.playerId) return\n    const candidatesRef = this.roomRef.child(`players/${this.playerId}/iceCandidates`)\n    await candidatesRef.push(candidate)\n  }\n\n  // Update game state\n  async updateGameState (updates) {\n    if (!this.roomRef) return\n    await this.roomRef.child('gameState').update(updates)\n  }\n\n  // Assign roles and characters randomly\n  async assignRolesAndCharacters () {\n    if (!this.roomRef) return\n\n    const snapshot = await this.roomRef.once('value')\n    const roomData = snapshot.val()\n\n    // Check if both players are present\n    if (!roomData.players.player1 || !roomData.players.player2) {\n      return\n    }\n\n    // Randomly assign roles\n    const roles = Math.random() < 0.5 ? ['player', 'guide'] : ['guide', 'player']\n    const characters = Math.random() < 0.5 ? ['ghost', 'alien'] : ['alien', 'ghost']\n\n    await this.roomRef.child('players/player1').update({\n      role: roles[0],\n      character: characters[0]\n    })\n\n    await this.roomRef.child('players/player2').update({\n      role: roles[1],\n      character: characters[1]\n    })\n\n    await this.updateGameState({ status: 'ready' })\n  }\n\n  // Switch roles after round completion\n  async switchRoles () {\n    if (!this.roomRef) return\n\n    const snapshot = await this.roomRef.once('value')\n    const roomData = snapshot.val()\n\n    const player1Role = roomData.players.player1.role\n    const player2Role = roomData.players.player2.role\n\n    // Switch roles\n    await this.roomRef.child('players/player1/role').set(player2Role)\n    await this.roomRef.child('players/player2/role').set(player1Role)\n\n    // Increment round counter\n    const currentRound = roomData.gameState.currentRound || 0\n    await this.updateGameState({\n      currentRound: currentRound + 1,\n      status: 'playing',\n      player1Ready: false,\n      player2Ready: false\n    })\n  }\n\n  // Mark player as ready\n  async setPlayerReady () {\n    if (!this.roomRef || !this.playerId) return\n    await this.roomRef.child(`gameState/${this.playerId}Ready`).set(true)\n  }\n\n  // Disconnect and cleanup\n  async disconnect () {\n    if (this.roomRef && this.playerId) {\n      await this.roomRef.child(`players/${this.playerId}/connected`).set(false)\n      if (this.roomRef && typeof this.roomRef.off === 'function') {\n        this.roomRef.off()\n      }\n\n      // If player1 disconnects and player2 is not connected, delete the room\n      if (this.playerId === 'player1') {\n        const snapshot = await this.roomRef.once('value')\n        if (snapshot.exists()) {\n          const roomData = snapshot.val()\n          const player2Connected = roomData.players && roomData.players.player2 && roomData.players.player2.connected\n          if (!player2Connected) {\n            // No one is connected, delete the room\n            await this.roomRef.remove()\n          }\n        }\n      }\n    }\n    this.roomRef = null\n    this.playerId = null\n    this.roomCode = null\n  }\n\n  // Delete room (only for host)\n  async deleteRoom () {\n    if (this.roomRef && this.playerId === 'player1') {\n      await this.roomRef.remove()\n    }\n  }\n\n  // Periodic cleanup of old rooms (can be called on app start)\n  // Note: Disabled because we can't list all rooms without special permissions.\n  // For production, implement server-side cleanup via Cloud Functions.\n  async startPeriodicCleanup (intervalMinutes = 10) {\n    // Cleanup disabled - requires Cloud Functions for proper implementation\n    // Individual room cleanup still happens on disconnect\n  }\n}\n\nexport default new RoomService()\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GameThree.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GameThree.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LevelSelect.vue?vue&type=style&index=0&id=759747e6&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LevelSelect.vue?vue&type=style&index=0&id=759747e6&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lobby.vue?vue&type=style&index=0&id=538904ea&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lobby.vue?vue&type=style&index=0&id=538904ea&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CharacterSelect.vue?vue&type=style&index=0&id=cf5bdaa4&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CharacterSelect.vue?vue&type=style&index=0&id=cf5bdaa4&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DirectionsHelper.vue?vue&type=style&index=0&id=06aac514&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DirectionsHelper.vue?vue&type=style&index=0&id=06aac514&lang=scss&scoped=true&\""],"sourceRoot":""}